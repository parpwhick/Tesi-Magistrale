#LyX 2.0 created this file. For more info see http://www.lyx.org/
\lyxformat 413
\begin_document
\begin_header
\textclass book
\use_default_options true
\begin_modules
theorems-ams
eqs-within-sections
figs-within-sections
\end_modules
\maintain_unincluded_children false
\language italian
\language_package default
\inputencoding auto
\fontencoding global
\font_roman charter
\font_sans default
\font_typewriter default
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100

\graphics default
\default_output_format pdf2
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref true
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder false
\pdf_colorlinks false
\pdf_backref section
\pdf_pdfusetitle true
\papersize a4paper
\use_geometry true
\use_amsmath 1
\use_esint 1
\use_mhchem 1
\use_mathdots 1
\cite_engine basic
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 4cm
\topmargin 3cm
\rightmargin 4cm
\bottommargin 3cm
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
Sviluppi teorici e applicativi delle metriche entropiche di Rohlin
\end_layout

\begin_layout Author
Dawid Crivelli
\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Section
Introduzione
\end_layout

\begin_layout Standard
Lo scopo iniziale del lavoro era approfondire l'utilizzo delle misure entropiche
 di Rohlin su sequenze biologiche, come le catene di amminoacidi dei virus
 dell'influenza.
 Differente dalla solita misura che differenzia mutazioni nei simboli, la
 distanza di Rohlin lavora sulle partizioni ottenute dalle sequenze, permettendo
 di evidenziare strutture e differenze globali, con alto potere predittivo
 per quanto riguarda il riconoscimento dell'emergenza di nuovi ceppi virali
 a partire dalla distanza su un insieme di sequenze campionato nel tempo.
 
\end_layout

\begin_layout Standard
Abbiamo studiato variazioni nei tipi possibili di misura, utilizzando indicatori
 topologici indipendenti dalla lunghezza delle strutture individuate e permetten
do alla distanza di riconoscere strutture nonconnesse sulla sequenza dove
 prima era stato imposto un vincolo di vicinanza, per evitare che mutazioni
 puntuali nascondessero possibili conservazioni su un piano più astratto.
 Si è studiato come l'informazione fornita dalla sequenza viene filtrata
 dall'ignorare mutazioni su scale sempre più lunghe, o utilizzando alfabeti
 ridotti di amminoacidi.
 Tutto per svincolarsi da supposizioni ad hoc ed esplorare il panorama delle
 possibili misure, per verificare quali meglio mettono in evidenza la funzionali
tà biologica in gioco nel processo evolutivo, senza mai fare assunzioni
 richiedenti la conoscenza di caratteristiche biologiche non direttamente
 inferibili dalle sequenze considerate.
\end_layout

\begin_layout Standard
Per fare questo, si è generalizzato il criterio, rendendolo assolutamente
 arbitrario, con il quale sulle sequenze definiamo partizioni di simboli.
 Per migliorare la sensibilità delle metriche utilizzate, è risultato anche
 in questo caso cruciale definire un metodo di amplificazione delle distanze.
 Molto lavoro è stato svolto sulla implementazione di algoritmi ottimali
 per la semplificazione dei fattori che non influiscono sulla distanza,
 quando venivano a mancare semplificazioni particolari dovute alla struttura.
 Questo rende possibile definire lo studio delle distanze tra partizioni
 di qualunque forma e dimensione, generalizzando il problema allo studio
 di partizioni su reticoli anche con un elevato numero di siti (
\begin_inset Formula $\sim10^{6})$
\end_inset

 prima non attaccabile.
\end_layout

\begin_layout Standard
La caratteristica di riconoscere e differenziare solo strutture formate
 da più simboli, ne permette l'applicazione laddove i valori presi singolarmente
 non contengono informazione sulla fisica del sistema.
 Così accade in meccanica statistica, dove le simmetrie non permettono di
 associare peso al valore assunto dal singolo sito, la distanza di Rohlin
 si è rivelata importante nel catturare l'effettiva differenza tra realizzazioni
 dello stesso sistema.
 Nel caso di sistemi di Ising monodimensionali, generalizzato l'accoppiamento
 dal caso ferromagnetico al caso disordinato, ha permesso di definire e
 misurare una lunghezza di correlazione efficace in funzione della temperatura.
\end_layout

\begin_layout Chapter
Partizioni su insiemi 
\end_layout

\begin_layout Standard
Definiamo in questo capitolo alcuni concetti fondamentali: le partizioni
 su un insieme, il significato di entropia, lo spazio delle partizioni con
 le operazioni binarie associate e una distanza tra partizioni.
 Studiamo le proprietà di questa distanza e come amplificarla.
 Diamo infine qualche esempio sui possibili tipi di partizioni che si possono
 incontrare su un insieme discreto.
\end_layout

\begin_layout Section
Generalità
\end_layout

\begin_layout Standard
Introduciamo il formalismo e risultati generali per spazi di partizioni
 e metriche di Rohlin, seguendo l'approccio in [billingsley, casartelli-vivo].
 Sia 
\begin_inset Formula $(\mathrm{\mathbf{M}},\mathit{\mathcal{M}},\mu)$
\end_inset

 uno spazio di probabilità, ovvero un insieme 
\begin_inset Formula $\mathbb{\mathbf{M}}$
\end_inset

, una 
\begin_inset Formula $\sigma$
\end_inset

-algebra 
\begin_inset Formula $\mathcal{M}$
\end_inset

 di sottoinsiemi di 
\begin_inset Formula $\mathbb{\mathbf{M}}$
\end_inset

, una misura normalizzata 
\begin_inset Formula $\mu$
\end_inset

 su 
\begin_inset Formula $\mathcal{M}$
\end_inset

.
 Nei casi trattati 
\begin_inset Formula $\mathbb{\mathbf{M}}$
\end_inset

 può essere una sequenza di simboli, un reticolo bidimensionale, un grafo
 arbitrario.
\end_layout

\begin_layout Standard
Introducendo una relazione di equivalenza su
\begin_inset Formula $\mathbb{\mathbf{M}}$
\end_inset

, possiamo definire una particolare classe di sottoinsiemi.
 Una 
\emph on
partizione
\emph default
 di 
\begin_inset Formula $\mathbb{\mathbf{M}}$
\end_inset

 è una collezione finita 
\begin_inset Formula $\alpha\equiv(A_{1},A_{2},\dots,A_{N})$
\end_inset

 di sottoinsiemi disgiunti misurabili che ricoprono 
\begin_inset Formula $\mathbb{\mathbf{M}}$
\end_inset

, cioè 
\begin_inset Formula $A_{i}\cap A_{j}=\emptyset$
\end_inset

 se 
\begin_inset Formula $i\neq j$
\end_inset

 e 
\begin_inset Formula $\bigcup_{k}A_{k}=\mathbf{M}$
\end_inset

.
 Gli 
\begin_inset Formula $\{A_{k}\}$
\end_inset

 sono chiamati 
\emph on
atomi
\emph default
 di 
\begin_inset Formula $\alpha$
\end_inset

 e sono una rappresentano le classi di equivalenza degli elementi di 
\begin_inset Formula $\mathbb{\mathbf{M}}$
\end_inset

.
 L'insieme di tutte le partizioni misurabili è denotato con 
\begin_inset Formula $\mathcal{Z}\equiv\mathcal{Z}(\mathbf{M})$
\end_inset

.
 La partizione unitaria 
\begin_inset Formula $\nu$
\end_inset

 consiste del singolo atomo coincidente con 
\begin_inset Formula $\mathbb{\mathbf{M}}$
\end_inset

.
 È possibile introdurre un ordine parziale su 
\begin_inset Formula $\mathcal{Z}$
\end_inset

, con la relazione 
\begin_inset Formula $\alpha\leq\beta$
\end_inset

 quando 
\begin_inset Formula $\beta$
\end_inset

 è un raffinamento di 
\begin_inset Formula $\alpha$
\end_inset

: questo accade quando ogni atomo 
\begin_inset Formula $A_{k}$
\end_inset

 è esattamente composto da atomi di 
\begin_inset Formula $\beta$
\end_inset

, cioè 
\begin_inset Formula $A_{k}=\{\bigcup_{j}\ B_{j}\mid B_{j}\in\beta\}$
\end_inset

.
 In questo caso, si dice che 
\begin_inset Formula $\alpha$
\end_inset

 è un 
\emph on
fattore
\emph default
 di di 
\begin_inset Formula $\beta$
\end_inset

.
 La partizione banale 
\begin_inset Formula $\nu\leq\alpha,\;\forall\alpha$
\end_inset

.
\end_layout

\begin_layout Standard
I termini come 
\emph on
unità
\emph default
 e 
\emph on
fattore
\emph default
 dipendono dalla definizione di uno pseudo-prodotto commutativo ed associativo,
 la composizione 
\begin_inset Formula $\gamma=\alpha\vee\beta$
\end_inset

 (o anche 
\begin_inset Formula $\gamma=\alpha\beta$
\end_inset

 ove non vi sia ambiguità).
 Il 
\emph on
prodotto
\emph default
 è la partizione meno fine di tutte le partizioni con 
\begin_inset Formula $\gamma\geq\alpha$
\end_inset

 e 
\begin_inset Formula $\gamma\geq\beta$
\end_inset

, i cui atomi sono le intersezioni non vuote di tutti gli atomi di 
\begin_inset Formula $\alpha$
\end_inset

 e 
\begin_inset Formula $\beta$
\end_inset

.
 Chiaramente il prodotto con l'unità si comporta come l'identità del prodotto,
 con 
\begin_inset Formula $\alpha\nu=\alpha$
\end_inset

 per ogni 
\begin_inset Formula $\alpha$
\end_inset

, mentre 
\begin_inset Formula $\alpha\eta=\alpha$
\end_inset

 quando 
\begin_inset Formula $\eta\leq\alpha$
\end_inset

.
 Queste proprietà rendono il risultato della composizione una specie di
 
\begin_inset Quotes eld
\end_inset

minimo comune multiplo
\begin_inset Quotes erd
\end_inset

.
 Dalla definizione segue anche che 
\begin_inset Formula $\alpha\vee\alpha=\alpha$
\end_inset

, ovvero il prodotto è idempotente.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/semplice.png
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Esempio di prodotto e intersezione tra due partizioni
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
L'operazione complementare che implementa un 
\begin_inset Quotes eld
\end_inset

massimo comune divisore
\begin_inset Quotes erd
\end_inset

 nello spazio delle partizioni è l'
\emph on
intersezione
\emph default
 
\begin_inset Formula $\sigma=\alpha\wedge\beta$
\end_inset

, definita come la partizione più fine tale che 
\begin_inset Formula $\sigma\leq\alpha$
\end_inset

 e 
\begin_inset Formula $\sigma\leq\beta$
\end_inset

.
 In questo caso, 
\begin_inset Formula $\alpha\wedge\nu=\nu$
\end_inset

 per ogni 
\begin_inset Formula $\alpha$
\end_inset

, mentre 
\begin_inset Formula $\alpha\wedge\beta=\nu$
\end_inset

 implica che 
\begin_inset Formula $\alpha$
\end_inset

 e 
\begin_inset Formula $\beta$
\end_inset

 sono 
\emph on
relativamente primi
\emph default
, cioè non hanno un fattore comune.
 
\end_layout

\begin_layout Standard
Un altro modo di calcolare e visualizzare le operazioni è in termini di
 
\emph on
bordi interni
\emph default
 di atomi della partizione, come si vede in figura 
\begin_inset CommandInset ref
LatexCommand vref
reference "fig:Intersezione-e-prodotto-bordi"

\end_inset

.
 Il prodotto 
\begin_inset Formula $\alpha\vee\beta$
\end_inset

 corrisponde alla partizione avente come bordi l'unione dei bordi di 
\begin_inset Formula $\alpha$
\end_inset

 e 
\begin_inset Formula $\beta$
\end_inset

, mentre l'intersezione 
\begin_inset Formula $\alpha\wedge\beta$
\end_inset

 ha come bordi l'intersezione di quelli di 
\begin_inset Formula $\alpha$
\end_inset

 e 
\begin_inset Formula $\beta$
\end_inset

.
 Quando nell'intersezione i bordi non si chiudono, sono cancellati dal risultato
 e gli atomi raggruppati.
 Poichè la partizione banale non ha bordi tra atomi, si ricavano immediatamente
 le sue proprietà nel prodotto e nell'intersezione.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/prodotto_bordi.png
	width 70col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Intersezione e prodotto come operazioni sui bordi.
 Le partizioni 
\begin_inset Formula $\alpha$
\end_inset

 e 
\begin_inset Formula $\beta$
\end_inset

 hanno bordi tratteggiati, con fase complementare, che danno l'impressione
 di linea continua quando sovrapposti.
 È evidente in questo modo il tratto di bordi in comune.
 Gli atomi sono stati numerati per rendere evidente la differenza tra le
 due operazioni.
\begin_inset CommandInset label
LatexCommand label
name "fig:Intersezione-e-prodotto-bordi"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Una partizione può rappresentare un esperimento probabilistico con risultati
 disgiunti 
\begin_inset Formula $A_{1},\dots,A_{N}$
\end_inset

, dove l'evento 
\emph on
atomico
\emph default
 
\begin_inset Formula $A_{k}$
\end_inset

 ha probabilità 
\begin_inset Formula $\mu(A_{k})$
\end_inset

.
 Un 
\emph on
fattore
\emph default
 è quindi un sottoesperimento dell'esperimento più fine, che raggruppa diversi
 risultati come equivalenti: ad esempio, 
\begin_inset Quotes eld
\end_inset

pari o dispari
\begin_inset Quotes erd
\end_inset

 è un sottoesperimento con due atomi, dell'esperimento 
\begin_inset Formula $\{1,2,3,4,5,6\}$
\end_inset

 del lancio di un dado.
\end_layout

\begin_layout Standard
Sullo spazio 
\begin_inset Formula $\mathcal{Z}$
\end_inset

 possiamo definire dei funzionali 
\emph on
entropia
\emph default
 
\begin_inset Formula $H:\mathcal{Z}\rightarrow\mathbb{R^{\mathbf{+}}}$
\end_inset

, definiti su ogni partizione.
 In particolare l'
\emph on
entropia di Shannon
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
H_{S}(\alpha)=-\sum_{i=1}^{n}\mu(A_{i})\ln\mu(A_{i})
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
L'entropia di Shannon è una misura dell'informazione media ottenuta dall'esperim
ento.
 Si vede immediatamente che la partizione banale 
\begin_inset Formula $\nu$
\end_inset

, non codificando alcuna informazione ha entropia nulla in entrambi i casi.
 Se 
\begin_inset Formula $\beta=(B_{1},\dots,B_{n})$
\end_inset

 è un'altra partizione, l'entropia condizionata di 
\begin_inset Formula $\alpha$
\end_inset

 rispetto a 
\begin_inset Formula $\beta$
\end_inset

 è
\begin_inset Formula 
\begin{equation}
H_{S}(\alpha|\beta)=-\sum_{i=1}^{n}\sum_{k=1}^{m}\mu(A_{i}\cap B_{k})\ln\frac{\mu(A_{i}\cap B_{k})}{\mu(B_{k})}=H_{S}(\alpha\vee\beta)-H_{S}(\beta)\label{eq:entropia_condizionata}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
dove si prende per convenzione che 
\begin_inset Formula $x\ln x=0$
\end_inset

 se 
\begin_inset Formula $x=0$
\end_inset

.
 L'entropia condizionata è l'informazione media residua ottenuta da 
\begin_inset Formula $\alpha$
\end_inset

 quando il risultato per 
\begin_inset Formula $\beta$
\end_inset

 è noto.
 Si noti che l'entropia di Shannon dipende solo dalla distribuzione delle
 misure degli atomi, non dalla loro natura o 
\begin_inset Quotes eld
\end_inset

forma
\begin_inset Quotes erd
\end_inset

, che potrebbe non avere significato in spazi astratti.
 Le mutue relazioni tra atomi (e possibilmente le loro forme) al contrario
 influenzano direttamente l'entropia condizionale.
 
\end_layout

\begin_layout Standard
Definiamo una metrica sullo spazio delle partizioni 
\begin_inset Formula $\mathcal{Z}(\mathbf{M})$
\end_inset

 tramite la distanza di Rohlin 
\begin_inset Formula $d_{\mathrm{R}}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
d_{\mathrm{R}}=H(\alpha|\beta)+H(\beta|\alpha)
\]

\end_inset


\end_layout

\begin_layout Standard
che misura la complessiva non-similarità tra le partizioni 
\begin_inset Formula $\alpha$
\end_inset

 e 
\begin_inset Formula $\beta$
\end_inset

.
 È possibile dare una definizione alternativa di questa distanza, sfruttando
 la seconda scrittura della probabilità condizionale, riscrivendo 
\begin_inset Formula $d_{\mathrm{R}}$
\end_inset

 come
\begin_inset Formula 
\begin{equation}
d_{\mathrm{R}}=2H(\alpha\vee\beta)-H(\alpha)-H(\beta)\label{eq:distanza_rohlin}
\end{equation}

\end_inset

La simmetria 
\begin_inset Formula $d_{\mathrm{R}}(\alpha,\beta)=d_{\mathrm{R}}(\beta,\alpha)$
\end_inset

, la positività e la condizione 
\begin_inset Formula $d_{\mathrm{R}}(\alpha,\alpha)=0$
\end_inset

 sono manifeste, mentre la disuguaglianza triangolare è soddisfatta se 
\begin_inset Formula $H$
\end_inset

 soddisfa alle condizioni di un funzionale entropia.
 
\end_layout

\begin_layout Standard
Se 
\begin_inset Formula $\mathbf{M}$
\end_inset

 è finito, una 
\emph on
configurazione
\emph default
 o 
\emph on
stato
\emph default
 
\begin_inset Formula $\mathbf{a}$
\end_inset

 su 
\begin_inset Formula $\mathbf{M}$
\end_inset

 è una funzione che assegna ad ogni punto 
\begin_inset Formula $x_{i}\in\mathbf{M}$
\end_inset

 un valore 
\begin_inset Formula $a_{i}=f(x_{i})$
\end_inset

 nell'alfabeto 
\begin_inset Formula $\mathbb{K}$
\end_inset

.
 Tutte le possibili configurazioni formano uno spazio 
\begin_inset Formula $\mathcal{C}\equiv\mathcal{C}(\mathbf{M})$
\end_inset

.
 Su 
\begin_inset Formula $\mathcal{C}$
\end_inset

 la distanza di Hamming è definita come
\begin_inset Formula 
\[
d_{\mathrm{H}}(\mathbf{a,b})=\mathcal{N}\sum_{i}\rho(a_{i},b_{i})
\]

\end_inset

 dove 
\begin_inset Formula $\rho(a_{i},b_{i})$
\end_inset

 è una distanza su 
\begin_inset Formula $\mathbb{K}$
\end_inset

 e 
\begin_inset Formula $\mathcal{N}$
\end_inset

 una possibile costante di rinormalizzazione, che noi porremo uguale a 1.
 Da notare come questa misura operi tra elementi diversi dalla misura di
 Rohlin, pur partendo sempre da 
\begin_inset Formula $\mathbb{\mathbf{M}}$
\end_inset

.
\end_layout

\begin_layout Subsection*
Entropia topologica
\end_layout

\begin_layout Standard
Oltre all'entropia di Shannon, definita tramite la misura 
\begin_inset Formula $\mu$
\end_inset

, è possibile una definizione alternativa che non ve ne fa ricorso.
 Per questo motivo, è chiamata 
\emph on
entropia topologica.
 
\emph default

\begin_inset Note Note
status open

\begin_layout Plain Layout
Lebesgue Number Lemma, Munkres, teorema di copertura spazi compatti, http://math
blather.blogspot.it/2011/07/lebesgue-number-lemma-and-corollary.html
\end_layout

\end_inset

 Dato uno spazio compatto, come 
\begin_inset Formula $\mathbf{M}$
\end_inset

 che stiamo considerando, esiste sempre un ricoprimento finito tramite insiemi
 aperti.
 In particolare, 
\begin_inset Formula $\exists\delta\in\mathbb{N}^{+}$
\end_inset

 numero minimo di aperti con cui generare tale ricoprimento.
 La partizione di uno spazio è ricoprimento 
\emph on
minimale
\emph default

\begin_inset Foot
status open

\begin_layout Plain Layout
Nulla vieta di avere altri ricoprimenti perfettamente ridondanti, ma sempre
 con un numero finito di aperti
\end_layout

\end_inset

, motivo per cui il numero di atomi della partizione satura la disuguaglianza
 del teorema, 
\begin_inset Formula $\delta=n$
\end_inset

.
 Una volta stabilito l'esistenza di 
\begin_inset Formula $\delta$
\end_inset

 e avendone calcolato il risultato, poniamo l'entropia topologica pari al
 logaritmo naturale di 
\begin_inset Formula $\delta$
\end_inset

 
\begin_inset Formula 
\begin{equation}
H_{T}(\alpha)=\ln(\delta)=\ln(n)
\end{equation}

\end_inset

 
\end_layout

\begin_layout Standard
Nei casi in cui non vi sia una naturale metrica sullo spazio 
\begin_inset Formula $\mathbf{M}$
\end_inset

, la definizione topologica può essere utile per cercare una misura più
 intrinseca dell'informazione contenuta nella partizione.
 Tuttavia, non esiste una definizione di entropia condizionale per 
\begin_inset Formula $H_{T}$
\end_inset

 e per definire la distanza di Rohlin utilizziamo la sua definizione in
 termini di prodotto tra partizioni.
\end_layout

\begin_layout Standard
Si vede come 
\begin_inset Formula $H_{T}$
\end_inset

 è un buon funzionale entropia, infatti se 
\begin_inset Formula $\alpha<\beta$
\end_inset

, allora 
\begin_inset Formula $H_{T}(\alpha)<H_{T}(\beta)$
\end_inset

, in quanto una partizione strettamente più fine ha banalmente un numero
 maggiore di atomi.
 Da questa condizione si ha che per il prodotto 
\begin_inset Formula 
\[
\alpha\vee\beta\geq\alpha\implies H_{T}(\alpha\vee\beta)\geq H_{T}(\alpha)
\]

\end_inset

 per 
\begin_inset Formula $\alpha,\beta$
\end_inset

 generici e la distanza di Rohlin risulta definita positiva.
\end_layout

\begin_layout Section
Riduzione
\end_layout

\begin_layout Standard
L'essenziale dissimiliratà tra due partizioni potrebbe essere confusa ed
 indebolita dalla presenza di un fattore comune ampio, come ad esempio accade
 se gli atomi della partizione hanno lunghezza media molto breve, nel qual
 caso la maggioranza dei confini risulta essere la stessa.
 Si cerca quindi di eliminare fattori comuni il più possibile, con una 
\emph on
riduzione
\emph default
 che ci si aspetta aumenti la distanza relativa.
 Tuttavia questa operazione, analoga alla riduzione in minimi termini per
 frazioni, non è unicamente definita, in quanto le partizioni, a differenza
 degli interi, non ammettono una univoca fattorizzazione in fattori primi.
 Il ruolo dei fattori primi (ovvero fattori irriducibili) è giocato dalle
 sottopartizioni 
\emph on
dicotomiche,
\emph default
 che sono tuttavia ancora estremamente ridondanti (
\begin_inset Formula $2^{n-1}-1$
\end_inset

 per partizioni con 
\begin_inset Formula $n$
\end_inset

 atomi).
\end_layout

\begin_layout Standard
A partire dalla partizione 
\begin_inset Formula $\alpha\equiv(A_{1},\dots,A_{n})$
\end_inset

, definiamo quindi una famiglia ristretta 
\begin_inset Formula $\mathbf{E}(\alpha)$
\end_inset

 di 
\emph on
fattori dicotomici elementari 
\emph default

\begin_inset Formula $\tilde{\alpha}_{1},\tilde{\alpha}_{2},\dots,\tilde{\alpha}_{n}$
\end_inset

 con le seguenti caratteristiche:
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\mathbf{E}(\alpha)$
\end_inset

 deve essere ben definita per ogni 
\begin_inset Formula $\alpha\in\mathcal{Z}$
\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula $\mathbf{E}(\alpha)$
\end_inset

 non deve contenere più di 
\begin_inset Formula $n$
\end_inset

 (il numero di atomi in 
\begin_inset Formula $\alpha$
\end_inset

) fattori elementari
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\vee_{k=1}^{n}\tilde{a}_{k}=\alpha$
\end_inset


\end_layout

\begin_layout Standard
Una scelta universale coniste nel prendere come fattori dicotomici 
\begin_inset Formula $\tilde{\alpha}_{k}\equiv(A_{k},A_{k}^{c})$
\end_inset

 le partizioni formate dai singoli atomi e dai loro complementi in 
\begin_inset Formula $\mathbf{M}$
\end_inset

.
 Fattori di questo tipo sono chiamati 
\emph on
universali semplici
\emph default
.
\end_layout

\begin_layout Standard
Una volta che per due partizioni 
\begin_inset Formula $\alpha$
\end_inset

 e 
\begin_inset Formula $\beta$
\end_inset

 le famiglie di fattori dicotomici 
\begin_inset Formula $\mathbf{E}(\alpha)$
\end_inset

 e 
\begin_inset Formula $\mathbf{E}(\beta)$
\end_inset

 sono state definite, abbiamo diversi possibili processi di riduzione.
\end_layout

\begin_layout Definition
Riduzione tramite fattore comune
\end_layout

\begin_layout Enumerate
Si definisce il massimo fattore comune 
\begin_inset Formula $\sigma=\alpha\wedge\beta$
\end_inset


\end_layout

\begin_layout Enumerate
Si tralasciano da 
\begin_inset Formula $\mathbf{E}(\alpha)$
\end_inset

 e 
\begin_inset Formula $\mathbf{E}(\beta)$
\end_inset

 i fattori che non sono relativamenti primi con 
\begin_inset Formula $\sigma,$
\end_inset

 e indichiamo i fattori rimanenti come 
\begin_inset Formula $\hat{\alpha}_{k}$
\end_inset

 e 
\begin_inset Formula $\hat{\beta}_{k}$
\end_inset

 rispettivamente.
 Questo vuol dire che 
\begin_inset Formula $\hat{\alpha}_{k}\wedge\sigma=\hat{\beta}_{j}\wedge\sigma=\nu$
\end_inset

.
\end_layout

\begin_layout Definition
Riduzione con eliminazione atomi in comune
\end_layout

\begin_layout Enumerate
Si tralasciano da 
\begin_inset Formula $\mathbf{E}(\alpha)$
\end_inset

 e 
\begin_inset Formula $\mathbf{E}(\beta)$
\end_inset

 i fattori che compaiono in entrambe le partizioni.
 Se indichiamo i fattori rimanenti come 
\begin_inset Formula $\hat{\alpha}_{k}$
\end_inset

 e 
\begin_inset Formula $\hat{\beta}_{k}$
\end_inset

 rispettivamente, questo vuol dire che 
\begin_inset Formula $\forall\hat{\alpha}_{k},\;\nexists\beta_{j}\in\beta|\hat{\alpha}_{k}=\beta_{j}$
\end_inset

 e viceversa.
\end_layout

\begin_layout Definition
Riduzione con eliminazione fattori simili
\end_layout

\begin_layout Enumerate
Si tralasciano da 
\begin_inset Formula $\mathbf{E}(\alpha)$
\end_inset

 e 
\begin_inset Formula $\mathbf{E}(\beta)$
\end_inset

 i fattori che hanno un corrispondente 
\begin_inset Quotes eld
\end_inset

simile
\begin_inset Quotes erd
\end_inset

 nell'altra partizione.
 Questo vuol dire che scartiamo da 
\begin_inset Formula $\hat{\alpha}$
\end_inset

 il fattore
\begin_inset Formula 
\[
\alpha_{k}\text{ se }\exists\ \beta_{j}\in\beta,\;\text{tale che }\mu(\alpha_{k}\bigtriangleup\beta_{j})\leq\epsilon
\]

\end_inset

 e viceversa da 
\begin_inset Formula $\hat{\beta}$
\end_inset

 il fattore 
\begin_inset Formula 
\[
\beta_{k}\text{ se }\exists\ \alpha_{j}\in\alpha,\;\text{tale che }\mu(\beta_{k}\bigtriangleup\alpha_{j})\leq\epsilon
\]

\end_inset

Il simbolo 
\begin_inset Formula $\alpha_{k}\bigtriangleup\beta_{j}$
\end_inset

 indica la differenza simmetrica tra i due atomi, ovvero i siti che appartengono
 ad un atomo ma non all'altro.
\end_layout

\begin_layout Standard
Alla fine, per tutti i tipi di riduzione, definiamo le partizioni ridotte
 come 
\begin_inset Formula $\hat{\alpha}=\vee_{k}\hat{\alpha}_{k}$
\end_inset

 e 
\begin_inset Formula $\hat{\beta}=\vee_{k}\hat{\beta}_{k}$
\end_inset

, ovvero il prodotto dei fattori dicotomici 
\begin_inset Quotes eld
\end_inset

sopravvissuti
\begin_inset Quotes erd
\end_inset

.
 Nel capitolo sugli algoritmi presenteremo metodi ottimali per il calcolo
 dei fattori dicotomici per ogni criterio presentato, che presentano una
 notevole complessità se eseguiti nel modo naïve.
\end_layout

\begin_layout Standard
Per il resto della sezione concentreremo la nostra attenzione sulla riduzione
 tramite fattore comune massimo.
 Si motiva la scelta del confronto con il fattore comune poichè vi sono
 casi in cui le partizioni non hanno atomi in comune, ma ciononostante si
 ha che 
\begin_inset Formula $\sigma\neq\nu$
\end_inset

.
 Questo accade, per esempio, quando 
\begin_inset Formula $\alpha<\beta$
\end_inset

 strettamente e non vi sono fattori comuni elementari.
 In questo caso allora 
\begin_inset Formula $\sigma=\alpha$
\end_inset

 e 
\begin_inset Formula $\hat{\alpha}=\nu$
\end_inset

 con questo metodo di riduzione, mentre 
\begin_inset Formula $\hat{\alpha}=\alpha$
\end_inset

 tralasciando i fattori comuni.
 Può capitare inoltre che anche se le partizioni sono già ridotte, non sono
 prime tra di loro.
 In particolare, 
\begin_inset Formula $H(\sigma)$
\end_inset

 è una misura di similarità tra le partizioni.
 
\end_layout

\begin_layout Subsection
Amplificazione
\end_layout

\begin_layout Standard
Il processo di riduzione porta alla definizione di partizioni con complessità
 possibilmente inferiore, ovvero 
\begin_inset Formula $H(\hat{\alpha})\leq H(\alpha)$
\end_inset

.
 Questo va nel verso opposto quando si considera l'effetto sulla distanza,
 che invece aumenta.
\end_layout

\begin_layout Standard
Il rapporto di 
\emph on
amplificazione
\emph default
 R misura quanto la riduzione ha messo in risalto la differenza tra partizioni.
 Ne dimostriamo la caratteristica fondamentale: 
\begin_inset Formula 
\[
\mathrm{R=\frac{d_{R}(\hat{\alpha},\hat{\beta})}{d_{\mathrm{R}}(\alpha,\beta)}}\geq1
\]

\end_inset


\end_layout

\begin_layout Proposition*
\begin_inset Formula $d_{\mathrm{R}}(\hat{\alpha},\hat{\beta})\geq d_{\mathrm{R}}(\alpha,\beta)$
\end_inset


\end_layout

\begin_layout Proof
Ricordando che 
\begin_inset Formula $\sigma=\alpha\wedge\beta$
\end_inset

 possiamo scrivere 
\begin_inset Formula $\alpha=\sigma\hat{\alpha}$
\end_inset

 e 
\begin_inset Formula $\beta=\sigma\hat{\beta}$
\end_inset

: infatti 
\begin_inset Formula $\sigma$
\end_inset

 contiene tutti i fattori tralasciati durante la riduzione.
 Utilizzando ora l'idempotenza del prodotto, 
\begin_inset Formula $\sigma=\sigma\sigma$
\end_inset

, possiamo riscrivere la tesi utilizzando l'equazione 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:distanza_rohlin"

\end_inset

 
\begin_inset Formula 
\[
2\, H(\sigma\hat{\alpha}\hat{\beta})-H(\sigma\hat{\alpha})-H(\sigma\hat{\beta})\leq2\, H(\hat{\alpha}\hat{\beta})-H(\hat{\alpha})-H(\hat{\beta})
\]

\end_inset

scambiando l'ordine dei termini si ottiene
\begin_inset Formula 
\[
2\, H(\sigma\hat{\alpha}\hat{\beta})-2\, H(\hat{\alpha}\hat{\beta})\leq H(\sigma\hat{\alpha})-H(\hat{\alpha})+H(\sigma\hat{\beta})-H(\hat{\beta})
\]

\end_inset

e sfruttando la formula 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:entropia_condizionata"

\end_inset

 per l'entropia condizionata, la tesi si riduce a
\begin_inset Formula 
\[
2\, H(\sigma|\hat{\alpha}\hat{\beta})\leq H(\sigma|\hat{\alpha})+H(\sigma|\hat{\beta})
\]

\end_inset

ma questo è chiaramente vero, in quanto
\begin_inset Formula 
\[
H(\sigma|\hat{\alpha}\hat{\beta})\leq H(\sigma|\hat{\alpha})\quad\text{e\quad}H(\sigma|\hat{\alpha}\hat{\beta})\leq H(\sigma|\hat{\beta})
\]

\end_inset

per le proprietà dell'entropia, poichè il termine condizionante è sicuramente
 maggiore, ovvero 
\begin_inset Formula 
\[
\hat{\alpha}\hat{\beta}\geq\hat{\alpha}\;\text{e}\;\hat{\alpha}\hat{\beta}\geq\hat{\beta}
\]

\end_inset


\end_layout

\begin_layout Standard
Da notare che la dimostrazione vale per la distanza di Rohlin definita sia
 tramite 
\begin_inset Formula $H_{S}$
\end_inset

 che 
\begin_inset Formula $H_{T}$
\end_inset

.
\end_layout

\begin_layout Standard
Risulta importante la scelta della famiglia di fattori dicotomici 
\begin_inset Formula $\mathbf{E}(\alpha)$
\end_inset

, che è dettata dalla topologia e geometria dello spazio delle configurazioni.
 La scelta della famiglia di fattori dicotomici universali semplici è sempre
 possibile, poichè la determinazione di 
\begin_inset Formula $A_{k}^{c}$
\end_inset

 a partire da 
\begin_inset Formula $A_{k}$
\end_inset

 è un'operazione ben definita in qualunque spazio topologico.
 Prendere come fattori elementari la parte interna di contorni di cluster
 ad esempio, richiede un concetto di orientabilità e la possibilità di definire
 contorni, ovvero insiemi con codimensione 1 su varietà -- mentre vorremmo
 estendere l'analisi anche a grafi generici, privi di strutture geometriche
 predefinite.
 Già nel caso lineare è possibile prendere fattori dicotomici diversi e
 algoritmicamente più performanti, a patto di restringere lo studio alle
 partizioni con atomi formati da cluster connessi.
\end_layout

\begin_layout Section
Possibili tipi di partizionamento
\end_layout

\begin_layout Standard
L'applicabilità dei metodi discussi è assolutamente generica, estendibile
 a qualunque spazio di probabilità finito si voglia considerare, vediamo
 dunque di dare esempi dei possibili spazi 
\begin_inset Formula $\mathbf{M}$
\end_inset

 su cui abbiamo lavorato, con i relativi fattori dicotomici e consequenze
 computazionali.
\end_layout

\begin_layout Standard
Essendo lo studio svolto su calcolatore, lo spazio 
\begin_inset Formula $\mathbf{M}$
\end_inset

 e la sua 
\begin_inset Formula $\sigma-$
\end_inset

algebra sono finiti e discreti.
 I siti appartenenti ad 
\begin_inset Formula $\mathbf{M}$
\end_inset

 possono essere sempre numerati ordinati in modo opportuno 
\begin_inset Formula $x_{i},\, i\in\{1,\dots,L\}$
\end_inset

, dove 
\begin_inset Formula $L$
\end_inset

 è il numero totale di siti, che si tratti di un reticolo o di un grafo.
 Poichè la partizione induce una relazione di equivalenza sull'insieme 
\begin_inset Formula $\mathbf{M}$
\end_inset

, indichiamo che due siti sono equivivalenti se appartengono allo stesso
 atomo
\begin_inset Formula 
\[
i\sim j\iff\exists A_{k}\;\textrm{tale che}\; i\in A_{k},\; j\in A_{k}
\]

\end_inset


\end_layout

\begin_layout Standard
Per partizionare i siti in atomi disguinti, richiediamo che la 
\emph on
configurazione
\emph default
 (o 
\emph on
stato
\emph default
) 
\begin_inset Formula $\mathcal{C}$
\end_inset

, associ ad ogni sito una lettera dell'alfabeto 
\begin_inset Formula $\mathbb{K}$
\end_inset

, considerato finito,
\begin_inset Formula $|\mathbb{K}|<\infty$
\end_inset

.
 Il simbolo associato al sito 
\begin_inset Formula $i$
\end_inset

-esimo, non essendovi ambiguità, sarà d'ora in poi indicato con 
\begin_inset Formula $f(i)$
\end_inset

.
 Se lo stato del sistema è descritto con variabili continue (o vi è un numero
 enorme di possibili lettere nell'alfabeto, si pensi ad una variabile a
 64 bit rappresentante un numero reale), si può sempre ridurre l'alfabeto
 ad un insieme 
\begin_inset Formula $\{k_{j}\}$
\end_inset

 discretizzando i valori della configurazione con il criterio: 
\begin_inset Formula 
\[
f(i):=\bar{k}\quad\text{tale che}\quad|f(i-\bar{k})|=\min_{k_{j}\in\mathbb{K}}|f(i)-k_{j}|
\]

\end_inset

oppure mettendo nello stesso atomo siti vicini che hanno valori distanti
 meno di 
\emph on

\begin_inset Formula $\epsilon$
\end_inset


\emph default
: 
\begin_inset Formula 
\[
i\sim j\iff|f(i)-f(j)|\leq\epsilon
\]

\end_inset


\end_layout

\begin_layout Subsection
Sequenze lineari connesse
\end_layout

\begin_layout Standard
Consideriamo sequenze lunghe 
\begin_inset Formula $L$
\end_inset

, provenienti da due casi:
\end_layout

\begin_layout Itemize
Problemi di meccanica statistica, in cui la configurazione è una variabile
 aleatoria, generata algoritmicamente da una catena di Markov in base al
 modello di Ising monodimensionale, nel qual caso l'alfabeto corrisponde
 a 
\begin_inset Formula $\{-1,+1\}$
\end_inset

.
 
\end_layout

\begin_layout Itemize
Sequenze di origine biologica, in particolare sequenze di amminoacidi (proteine)
, in cui 
\begin_inset Formula $|\mathbb{K}|=22$
\end_inset

.
 
\end_layout

\begin_layout Standard
Lo studio delle sequenze è solitamente svolto con la distanza di Hamming
 
\begin_inset Formula $d_{H}$
\end_inset

 che tuttavia è molto sensibile a variazioni puntuali dei valori in 
\begin_inset Formula $\mathcal{C}$
\end_inset

.
 I siti che compongono la sequenze non si influenzano, una variazione su
 un sito può solo variare di 
\begin_inset Formula $\{-1,0,+1\}$
\end_inset

 la distanza totale.
\end_layout

\begin_layout Standard
Ad ogni configurazione possiamo associare una partizione in 
\begin_inset Formula $\mathcal{Z}$
\end_inset

, in cui gli atomi sono formati dai cluster, cioè sottoinsiemi connessi
 di 
\begin_inset Formula $\mathbf{M}$
\end_inset

 a valori omogenei in 
\begin_inset Formula $\mathbb{K}$
\end_inset

.
 Questo stabilisce una mappa 
\begin_inset Formula $\Phi:\mathcal{C}\rightarrow\mathcal{Z}$
\end_inset

 da ogni configurazione ad una partizione corrispondente, rendendo possibile
 il confronto tra 
\begin_inset Formula $d_{\mathrm{H}}(\mathbf{a,b})$
\end_inset

 in 
\begin_inset Formula $\mathcal{C}$
\end_inset

 e 
\begin_inset Formula $d_{\mathrm{R}}(\alpha,\beta)$
\end_inset

 in 
\begin_inset Formula $\mathcal{Z}$
\end_inset

, dove 
\begin_inset Formula $\alpha=\Phi(\mathbf{a})$
\end_inset

 e 
\begin_inset Formula $\beta=\Phi(\mathbf{b})$
\end_inset

.
 La relazione è chiaramente del tipo molti-a-uno, infatti assegnando ad
 un segmento di lettere omogeneo in 
\begin_inset Formula $\mathcal{C}$
\end_inset

 un diverso simbolo, non cambia la partizione corrispondente.
 In simboli, esprimiamo la relazione come
\begin_inset Formula 
\[
i\sim j\iff j=i+1,\; f(i)=f(j)
\]

\end_inset


\end_layout

\begin_layout Standard
È evidente quindi che variazioni locali, ad esempio il cambiamento di un
 singolo simbolo, possono non modificare affatto la partizione
\begin_inset Formula 
\[
\{\dots,T,T,C,A,A,\dots\}\overset{\Phi}{\equiv}\{\dots,T,T,M,A,A,\dots\}
\]

\end_inset

che presenta sì una perdita di informazione, ma permette quindi anche di
 filtrare molto 
\begin_inset Quotes eld
\end_inset

rumore
\begin_inset Quotes erd
\end_inset

 e si è dimostrata una ottima scelta nel caso biologico e una necessità
 nello studio di sequenze di Ising -- la hamiltoniana del sistema non distingue
 i valori associati ai singoli siti, ma solo differenze tra siti vicini.
 La suddivisione in partizioni si comporta nello stesso modo, estraendo
 quindi solo informazioni fisicamente rilevanti.
 
\end_layout

\begin_layout Example*
Supponiamo di aver partizionato una stringa come {A,A,A,B,B,C,C,D,D,D} o
 
\begin_inset Formula $\{+,+,+,-,-,+,+,-,-,-\}$
\end_inset

,
\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset Formula $\{+1,+1,+1,-1,-1,+1,+1,-1,-1,-1\}$
\end_inset


\end_layout

\end_inset

 aventi la stessa partizione 
\begin_inset Formula 
\[
\alpha=\{(1,2,3),(4,5),(6,7),(8,9,10)\}
\]

\end_inset

il calcolo esplicito dell'entropia è il seguente:
\end_layout

\begin_layout Example*
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{align*} 
\end_layout

\begin_layout Plain Layout

A_{1}= & (1,2,3)&
\backslash
mu(A_1)=
\backslash
frac{3}{10}
\backslash

\backslash
 
\end_layout

\begin_layout Plain Layout

A_{2}= & (4,5)&
\backslash
mu(A_2)=
\backslash
frac{2}{10}
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

A_{3}= & (6,7)&
\backslash
mu(A_3)=
\backslash
frac{2}{10}
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

A_{4}= & (8,9,10)&
\backslash
mu(A_4)=
\backslash
frac{3}{10}
\end_layout

\begin_layout Plain Layout


\backslash
end{align*}
\end_layout

\end_inset

Ora, 
\begin_inset Formula $H_{\mathrm{S}}(\alpha)=-2\:(0.3)\ln(0.3)-2\,(0.2)\ln(0.2)\simeq1.36$
\end_inset

, mentre 
\begin_inset Formula $H_{\mathrm{T}}(\alpha)=\ln(4)\simeq1.38$
\end_inset

.
 Come si vede i valori sono abbastanza simili.
\end_layout

\begin_layout Subsubsection*
Fattori dicotomici nel caso lineare connesso
\end_layout

\begin_layout Standard
Per una partizione 
\begin_inset Formula $\alpha\equiv(A_{1},\dots,A_{n})$
\end_inset

, definiamo i fattori dicotomici 
\begin_inset Formula $\tilde{\alpha}_{1},\tilde{\alpha}_{2},\dots,\tilde{\alpha}_{n}\in\mathbf{E}(\alpha)$
\end_inset

 nel modo seguente:
\begin_inset Formula 
\[
\tilde{\alpha}_{k}=\left\{ \bigcup_{j=1}^{k}A_{j},\bigcup_{j=k+1}^{n}A_{j}\right\} 
\]

\end_inset


\end_layout

\begin_layout Standard
dove ricordiamo che 
\begin_inset Formula $n$
\end_inset

 è il numero di atomi.
 In termini di siti quindi, il fattore dicotomico 
\begin_inset Formula $k$
\end_inset

-esimo corrisponde alla partizione con tutti i siti corrispondenti ai primi
 
\begin_inset Formula $k$
\end_inset

 atomi presi insieme, ed il complementare corrispondente ai siti a partire
 dall'atomo 
\begin_inset Formula $(k+1)$
\end_inset

-esimo fino ad 
\begin_inset Formula $L$
\end_inset

, come mostrato in figura 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Fattori-dicotomici-lineari"

\end_inset

.
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/riduzione_lineare3.png
	width 7cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Fattori dicotomici lineari
\begin_inset CommandInset label
LatexCommand label
name "fig:Fattori-dicotomici-lineari"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Con questa particolare scelta, resa possibile dalla topologia connessa e
 ordinata, poichè abbiamo l'ordine ereditato da 
\begin_inset Formula $\mathbb{N}$
\end_inset

, il processo di riduzione è estremamente semplificato ed efficiente.
 Partendo da una partizione 
\begin_inset Formula $\alpha$
\end_inset

, la partizione ridotta 
\begin_inset Formula $\hat{\alpha}$
\end_inset

 è quella in cui sono stati rimossi i bordi in comune tra 
\begin_inset Formula $\alpha$
\end_inset

 e 
\begin_inset Formula $\sigma$
\end_inset

, come si vede in figura 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Riduzione-lineare"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/riduzione_lineare2.png
	width 7cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Riduzione nel caso di sequenze lineari.
 La riga spessa indica la separazione tra atomi.
 Si nota come i bordi della partizione comune siano quelli comuni sia ad
 
\begin_inset Formula $\alpha$
\end_inset

 che a 
\begin_inset Formula $\beta$
\end_inset

, mentre nelle partizioni ridotte non compaiono più i bordi esistenti anche
 in 
\begin_inset Formula $\sigma$
\end_inset

 
\begin_inset CommandInset label
LatexCommand label
name "fig:Riduzione-lineare"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Sequenze non connesse
\end_layout

\begin_layout Standard
Lo studio delle sequenze biologiche, in cui vi è una notevole frammentazione,
 dovuta alla bassa probabilità di avere molti simboli consecutivi uguali,
 ha motivato la ricerca di diversi criteri di partizionamento.
 Il più semplice è considerare come appartenenti allo stesso atomo siti
 con lo stesso simbolo, non adiacenti ma con la possibilità di saltare al
 massimo 
\begin_inset Formula $n_{s}$
\end_inset

 siti in avanti 
\begin_inset Formula 
\[
i\sim j\iff|j-i|\leq n_{s},\; f(i)=f(j)
\]

\end_inset


\end_layout

\begin_layout Standard
In questo caso, la topologia nello spazio 
\begin_inset Formula $\mathcal{Z}$
\end_inset

 non è più connessa, per cui l'utilizzo dei fattori dicomici lineari non
 è possibile.
 Un'alternativa è quella di prendere per l'atomo 
\begin_inset Formula $A_{k}=\{n_{k_{1}},n_{k_{2}},\dots,n_{k_{n}}\}$
\end_inset

 una partizione dicotomica costituita da tutti i siti tra il primo e l'ultimo
 appartenente a 
\begin_inset Formula $A_{k}$
\end_inset

 e dal complementare, sconnesso, 
\begin_inset Formula $A_{k}^{c}$
\end_inset


\begin_inset Formula 
\[
\hat{\alpha}_{k}=\left\{ \bigcup_{i=n_{k_{1}}}^{n_{k_{n}}}n_{i},\left(\bigcup_{i<n_{k_{1}}}n_{i}\right)\bigcup\left(\bigcup_{i>n_{k_{n}}}n_{i}\right)\right\} 
\]

\end_inset

Dati gli scarsi vantaggi di questo approccio, si è scelto tuttavia anche
 in questo caso di utilizzare i 
\emph on
fattori universali semplici.
 
\emph default
Una volta venuta a meno la connessione degli atomi, questo tipo di partizionamen
to presenta le complessità e caratteristiche di un criterio arbitrario su
 grafo generico -- si veda il prossimo paragrafo per le illustrazioni delle
 operazioni tra partizioni di questo tipo.
\end_layout

\begin_layout Subsection
Sequenze su reticoli multidimensionali e grafi
\end_layout

\begin_layout Standard
In questo caso, si considera le partizioni in cui fanno parte dello stesso
 atomo siti con lo stesso simbolo, ma con il vincolo che devono essere 
\emph on
primi vicini 
\emph default
sul reticolo
\begin_inset Formula 
\[
i\sim j\iff d(i,j)=1,\; f(i)=f(j)
\]

\end_inset


\end_layout

\begin_layout Standard
dove la distanza indica il numero di passi sul reticolo.
 Possiamo tuttavia generalizzare arbitrariamente la condizione di vicinanza,
 per includere secondi vicini, siti con lo stesso simbolo arbitrariamente
 posti, ecc.
 
\end_layout

\begin_layout Standard
Illustriamo le possibili operazioni con un reticolo bidimensionale, che
 tuttavia generalizza immediatamente al grafo arbitrario.
 In particolare numeriamo anche in questo caso i siti, cosa necessaria per
 mappare nella memoria di un computer la configurazione.
 La mappatura in memoria (figura 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Ordinamento-reticolo"

\end_inset

) comporta necessariamente la disposizione di siti 
\begin_inset Quotes eld
\end_inset

vicini
\begin_inset Quotes erd
\end_inset

 sul reticolo su posizioni in cui non risultano più contigue in memoria
\begin_inset Foot
status open

\begin_layout Plain Layout
Ricordiamo la convenzione 
\begin_inset Quotes eld
\end_inset

per colonne
\begin_inset Quotes erd
\end_inset

 di rappresentazione di una matrice bidimensionale nella maggior parte dei
 linguaggi di programmazione, a partire dal Fortran in poi
\end_layout

\end_inset

.
 Nel caso della figura la partizione corrispondente è 
\begin_inset Formula 
\[
A=\{(1,4,5,6,8,9),(2,4),(7)\}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/ordinamento_reticolo.png
	width 4cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Mappa in memoria di un reticolo bidimensionale.
 In grigio e bianco sono evidenziati i valori dalla configurazione, mentre
 i numeri nell'angolo rappresentano l'ordine dei siti.
\begin_inset CommandInset label
LatexCommand label
name "fig:Ordinamento-reticolo"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
evidentemente non-connessa.
 In questo caso i fattori dicotomici anche risultano sconnessi, come nell'esempi
o di un reticolo 3x3 in figura 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Fattori-dicotomici-generici"

\end_inset

, in cui si è preso come atomi i siti con lo stesso valore indipendentemente
 dalla loro posizione.
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/fattori_dicotomici_quadrato.png
	width 80col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Partizione con 4 atomi e i 4 fattori dicotomici universali semplici corrisponden
ti.
 I numeri indicano l'etichetta corrispondente ad ogni atomo, scelto arbitrariame
nte.
\begin_inset CommandInset label
LatexCommand label
name "fig:Fattori-dicotomici-generici"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Nel caso in cui gli atomi sconnessi il prodotto tra partizioni rimane banale
 da implementare mentre l'intersezione è estremamente complicata -- un'implement
azione ottimale è data nel capitolo sugli algoritmi.
\end_layout

\begin_layout Subsection
Grafi arbitrari
\end_layout

\begin_layout Standard
L'insieme dei siti in questo caso è sempre ordinabile con 
\begin_inset Formula $i\in\{1,\dots,L\}$
\end_inset

.
 Definiamo la 
\emph on
matrice di adiacenza
\emph default
 
\begin_inset Formula $A_{ij}$
\end_inset

 
\begin_inset Formula 
\[
A_{ij}=\begin{cases}
1 & \text{se i siti sono connessi}\\
0 & \text{altrimenti}
\end{cases}
\]

\end_inset

che ci permette di dare la relazione di equivalenza come 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
i\sim j\iff A(i,j)=1,\; f(i)=f(j)
\]

\end_inset


\end_layout

\begin_layout Standard
In questo modo ci si slega completamente da qualunque nozione di vicinanza
 geometrica.
 In linea di principio, è possibile rimuovere anche la condizione 
\begin_inset Formula $f(i)=f(j)$
\end_inset

, e lasciare alla matrice di adiacenza l'implementazione della relazione
 di equivalenza.
 Non vi sono condizioni da porre su 
\begin_inset Formula $A_{ij}$
\end_inset

, qualunque scelta è accettabile e va a modificare il partizionamento, senza
 che questo risulti mai incoerente.
\end_layout

\begin_layout Chapter
Algoritmi
\end_layout

\begin_layout Standard
Dopo aver visto i possibili tipi di partizione, mostriamo come calcolare
 qualunque quantità richiesta in modo ottimale.
 Definiamo prima le operazioni limitate a partizioni con atomi connessi,
 sia per la loro minore complessità, sia perché nel caso generico si sfrutta
 la riduzione al caso più semplice già trattato.
\begin_inset Note Note
status open

\begin_layout Plain Layout
Prendiamo come convenzione quella del C/C++/Python, iniziando gli array
 all'elemento 0.
\end_layout

\end_inset


\end_layout

\begin_layout Section
Partizioni connesse 
\end_layout

\begin_layout Standard
Nel caso monodimensionale è sufficiente identificare il 
\emph on
bordo sinistro
\emph default
 di ogni atomo, per ricostruire completamente la partizione.
 Partendo da una sequenza in un array (o segmento unidimensionale finito)
\family typewriter
 S[i]
\family default
 lungo 
\begin_inset Formula $L$
\end_inset

, definiamo l'array binario della partizione 
\family typewriter
B[i], 
\family default
lungo 
\begin_inset Formula $L$
\end_inset

, con indici che vanno da 
\family typewriter
0
\family default
 a 
\family typewriter
L-1
\family default

\begin_inset Formula 
\[
\mathtt{B[i]}=\begin{cases}
1 & \text{ il sito \mathtt{i}\text{ identifica un nuovo atomo}}\\
0 & \text{ altrimenti}
\end{cases}
\]

\end_inset

algoritmicamente si procede in due step:
\end_layout

\begin_layout Enumerate
il primo sito sicuramente inizia un atomo, quindi 
\family typewriter
B[0]=1;
\end_layout

\begin_layout Enumerate
iterando su 
\family typewriter
i, 
\family default
poniamo
\family typewriter
 B[i]= (S[i] != S[i-1]); 
\family default
infatti un nuovo atomo corrisponde ad un valore della sequenza 
\emph on
diverso
\emph default
 dal precedente
\end_layout

\begin_layout Standard
Ogni partizione espressa in termini binari ha sempre 1 come primo elemento.
\end_layout

\begin_layout Standard
Facendo un esempio, ad una stringa possiamo semplicemente far corrispondere
 l'array binario corrispondente
\end_layout

\begin_layout Standard
\align center

\family typewriter
S=AAAABBBAAAACCCDDDD
\begin_inset Newline newline
\end_inset

B=100010010001001000
\end_layout

\begin_layout Standard
Avendo un array che indica esattamente dove si trovano i bordi dei vari
 atomi, le operazioni di intersezione e prodotto sono immediate.
 Il prodotto corrisponde alla partizione che contiene i bordi di
\emph on
 
\emph default
entrambe le partizioni (OR binario); l'intersezione ha un bordo quando compare
 contemporaneamente nelle due partizioni (AND binario); il prodotto ridotto
 contiene invece ogni bordo di una e una sola delle partizioni (XOR binario)
 -- se il bordo appartiene ad entrambe, appartiene al fattore comune, che
 è stato ridotto.
\end_layout

\begin_layout Standard
In tabella 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:op-binarie"

\end_inset

 sono mostrate tutte le sequenze generabili a partire da due partizioni
 binarie 
\family typewriter
A
\series bold
 
\family default
\series default
e
\family typewriter
 B, 
\family default
con le rispettive entropie, che adesso mostriamo come calcolare.
\end_layout

\begin_layout Standard
\align center
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="5">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Vettore
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Risultato
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Codice C
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $H_{S}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $H_{T}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\alpha$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
10
\color red
11
\color inherit
000
\color red
11
\color inherit
00
\color red
11
\color inherit
0
\color red
11
\color inherit
0
\color red
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
A[]={1,0,1,1,...};
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.16
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.30
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\beta$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
1000
\color blue
1
\color inherit
00
\color blue
1
\color inherit
00
\color blue
11
\color inherit
00
\color blue
1
\color inherit
000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
B[]={1,0,0,0,...};
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.73
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.79
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\sigma=\alpha\wedge\beta$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
1000000
\color green
1
\color inherit
000
\color green
1
\color inherit
00
\color green
1
\color inherit
000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
C[i]=A[i] & B[i];
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.33
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.39
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\alpha\vee\beta$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
10
\color red
11
\color blue
1
\color inherit
00
\color blue
1
\color red
1
\color inherit
0
\color blue
11
\color red
1
\color inherit
0
\color blue
1
\color red
1
\color inherit
0
\color red
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
P[i]=A[i] | B[i];
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.40
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.49
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\hat{\alpha}\vee\hat{\beta}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
10
\color red
11
\color blue
1
\color inherit
00
\color green
0
\color red
1
\color inherit
0
\color blue
1
\color green
0
\color red
1
\color inherit
0
\color green
0
\color red
1
\color inherit
0
\color red
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
Prid[i]=A[i] ^ B[i];
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.09
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.19
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\hat{\alpha}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
10
\color red
11
\color inherit
000
\color green
0
\color red
1
\color inherit
00
\color green
0
\color red
1
\color inherit
0
\color green
0
\color red
1
\color inherit
0
\color red
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
Arid[i]=A[i] ^ C[i];
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.80
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.94
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\hat{\beta}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
1000
\color blue
1
\color inherit
00
\color green
0
\color inherit
00
\color blue
1
\color green
0
\color inherit
00
\color green
0
\color inherit
000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
Brid[i]=B[i] ^ C[i];
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.06
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.09
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Rappresentazione delle operazioni a partire da partizioni binarie.
 In rosso gli elementi riconducibili a partizioni di 
\begin_inset Formula $\alpha$
\end_inset

, in blu quelli dovuti a 
\begin_inset Formula $\beta$
\end_inset

, in verde gli elementi di 
\begin_inset Formula $\sigma$
\end_inset

.
 Nel prodotto si vede l'effetto sovrapposto di blu e rosso.
 Nelle partizioni ridotte in verde sono stati evidenziati gli zeri dovuti
 alla riduzione, ovvero in corrispondenza agli atomi (1 verdi) di 
\begin_inset Formula $\sigma$
\end_inset

.
\begin_inset CommandInset label
LatexCommand label
name "tab:op-binarie"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Entropia di una partizione binaria
\end_layout

\begin_layout Standard
Il calcolo più semplice è quello dell'entropia topologica, 
\begin_inset Formula $H_{T}$
\end_inset

.
 Avendo un vettore che indica esattamente l'inizio di ogni atomo, basta
 contare il numero di 1 presenti nel vettore e farne il logaritmo
\family typewriter

\begin_inset Foot
status open

\begin_layout Plain Layout
in Matlab è immediato:
\family typewriter
 Htop = log(sum(B));
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
Per l'entropia di Shannon 
\begin_inset Formula $H_{S}$
\end_inset

 la cosa è leggermente più complicata
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
In codice Matlab, si definisce prima 
\family typewriter
H=@(a) -sum(a.*log(a))/sum(a) +log(sum(a));
\begin_inset Newline newline
\end_inset


\family default
Avendo il vettore binario A, l'entropia cercata è: 
\family typewriter
H(diff(find([A,1])));
\end_layout

\end_inset

:
\end_layout

\begin_layout Enumerate
si trovano tutte le posizioni 
\begin_inset Formula $i_{k}$
\end_inset

 degli 1 nel vettore dato
\end_layout

\begin_layout Enumerate
si fa la differenza degli interi cosi trovati, 
\begin_inset Formula $\mu_{k}=i_{k}-i_{k-1}$
\end_inset


\end_layout

\begin_layout Enumerate
l'insieme 
\begin_inset Formula $\{\mu_{k}\}$
\end_inset

 rappresenta le lunghezze degli atomi, ovvero gli intervalli tra 1 e l'ultimo
 0 (se esiste) dello stesso atomo
\end_layout

\begin_layout Standard
Per l'ultimo atomo ci vuole un trattamento speciale, 
\begin_inset Formula $\mu_{end}=\mathrm{L}-i_{end}$
\end_inset

, ovvero si calcola la differenza tra la lunghezza della sequenza e l'ultimo
 1 nel vettore.
 Il calcolo dell'entropia del vettore 
\begin_inset Formula $\{\mu_{m}\}=\{\mu_{k}\}\cup\mu_{end}$
\end_inset

 è molto semplice:
\begin_inset Formula 
\[
L=\sum_{m}\mu_{m}
\]

\end_inset


\begin_inset Formula 
\[
H=-\frac{\sum_{m}\mu_{m}\ln\mu_{m}}{L}+\ln L
\]

\end_inset


\end_layout

\begin_layout Standard
la formula utilizzata permette di non dover dividere ogni 
\begin_inset Formula $\mu_{k}$
\end_inset

 per 
\begin_inset Formula $L$
\end_inset

, e di eseguire un'unica divisione alla fine.
 L'utilizzo delle misure non\SpecialChar \-
normalizzate degli atomi consente anche di poter
 precalcolare tutti i logaritmi necessari, in quanto 
\begin_inset Formula $0\leq\mu_{k}\leq L$
\end_inset

 -- consente ciò di velocizzare l'esecuzione del programma del 600%.
\end_layout

\begin_layout Standard
L'algoritmo presenta complessità 
\begin_inset Formula $\mathcal{O}(L)$
\end_inset

 in quanto si scorre l'array completo, anche se una volta sola: chiaramente
 non si può far di meglio.
\end_layout

\begin_layout Subsection*
Distanza di Rohlin
\end_layout

\begin_layout Standard
Una volta che si è in grado di fare il prodotto, la riduzione e il calcolo
 dell'entropia, si può immediatamente calcolare la distanza di Rohlin.
 Per questo motivo è necessario calcolare anche le partizioni ridotte, che
 sono superflue per il calcolo del prodotto ridotto, ma nella distanza entrano
 in gioco le entropie dei fattori.
\end_layout

\begin_layout Standard
La tabella 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:distanze-binarie"

\end_inset

 calcola, sfruttando solamente i numeri calcolati nell'esempio precedente,
 le 4 possibili distanze date le due partizioni binarie.
\end_layout

\begin_layout Standard
\align center
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Distanza
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Formula
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Valore
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
R
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Nonridotta, Shannon
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\lang english
\begin_inset Formula $2H_{S}(\alpha\vee\beta)-H_{S}(\alpha)-H_{S}(\beta)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.93
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ridotta, Shannon
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\lang english
\begin_inset Formula $2\, H_{S}(\hat{\alpha}\hat{\beta})-H_{S}(\hat{\alpha})-H_{S}(\hat{\beta})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.33
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.46
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Nonridotta, topologica
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2H_{T}(\alpha\vee\beta)-H_{T}(\alpha)-H_{T}(\beta)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.87
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ridotta, topologica
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\lang english
\begin_inset Formula $2\, H_{T}(\hat{\alpha}\hat{\beta})-H_{T}(\hat{\alpha})-H_{T}(\hat{\beta})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.35
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.53
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Tutte le possibili distanze ricavate a partire dalla tabella 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:op-binarie"

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "tab:distanze-binarie"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Partizionamento generico
\end_layout

\begin_layout Standard
Nel caso generico non basta indicare l'inizio di ogni atomo, poichè questi
 possono avere forma (e buchi) di ogni tipo.
 È necessario etichettare ogni sito con un numero naturale, indicando con
 
\begin_inset Formula $\lambda_{\alpha}(i)$
\end_inset

 l'etichetta corrispondente al sito 
\begin_inset Formula $i$
\end_inset

-esimo nella partizione 
\begin_inset Formula $\alpha$
\end_inset

.
 Ogni etichetta identifica l'atomo di appartenenza:
\begin_inset Formula 
\[
i\sim j\iff\lambda(i)=\lambda(j)
\]

\end_inset


\end_layout

\begin_layout Standard
Non si possono fare ipotesi sulla posizione relativa dei siti nè sulle etichette
, che formano un vettore di lunghezza 
\begin_inset Formula $L$
\end_inset

.
 
\end_layout

\begin_layout Subsection
Struttura dei vicini
\end_layout

\begin_layout Standard
Il metodo per partizionare una configurazione generica sullo spazio 
\begin_inset Formula $\mathbb{\mathbf{M}}$
\end_inset

 consiste nel raccogliere tutta l'informazione in una matrice dei primi
 vicini 
\family typewriter
NNB
\family default
, concettualmente la versione 
\emph on
sparse
\emph default
 della matrice di adiacenza, per poi usare un algoritmo generale clustering.
\end_layout

\begin_layout Standard
In linea di principio, il numero dei vicini per sito non è costante ---
 associamo un vettore di lunghezza variabile sito per sito, a seconda della
 geometria e configurazione.
 Per reticoli regolari chiaramente possiamo fissare il numero massimo dei
 vicini, per ottimizzare il codice, indicando eventualmente con un simbolo
 convenzionale la fine del vettore (ad es.
 ci si ferma quando si trova -1).
 A seconda dell'input, possiamo distinguere vari casi:
\end_layout

\begin_layout Itemize
abbiamo in partenza la configurazione completa 
\begin_inset Formula $\mathcal{C}$
\end_inset

 su un reticolo regolare, consideriamo come collegati al sito 
\begin_inset Formula $i$
\end_inset

-simo tutti i siti 
\begin_inset Formula $j$
\end_inset

 aventi lo stesso simbolo tali che:
\begin_inset Formula 
\[
d(i,j)=1,\; f(i)=f(j)
\]

\end_inset

e li aggiungiamo al vettore 
\family typewriter
NNB[i][k++]=j, 
\family default
dove 
\begin_inset Formula $i$
\end_inset

 indica la colonna, 
\begin_inset Formula $k$
\end_inset

 cresce con il numero di 
\begin_inset Formula $j$
\end_inset

 trovati.
 A questo caso appartiene ad esempio lo studio delle distanze tra reticoli
 con configurazioni di Ising: si considerano solo i primi vicini aventi
 lo stesso spin
\end_layout

\begin_layout Itemize
nel caso delle partizioni con salto, aggiungiamo a 
\family typewriter
NNB
\family default
 solo il primo sito distante meno di 
\begin_inset Formula $n_{s}$
\end_inset

 avente lo stesso simbolo, non serve collegare i più lontani (saranno già
 vicini del precedente)
\end_layout

\begin_layout Itemize
non guardiamo affatto le configurazioni, e i vicini sono dati interamente
 dalla matrice di adiacenza: 
\family typewriter
NNB[i]=nonzero(A[i])
\end_layout

\begin_layout Itemize
associamo insieme tutti i simboli presenti sul grafo, utilizzando una variante
 del sort descritto a pagina 
\begin_inset CommandInset ref
LatexCommand pageref
reference "sub:sort_entropy"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/griglia_simboli.png
	width 70text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Reticolo semplice con 
\begin_inset Formula $|\mathbb{K}|=2$
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:Reticolo-semplice-quadrato"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Scorriamo poi tutto lo spazio 
\begin_inset Formula $\mathbb{\mathbf{M}}$
\end_inset

 raggruppando i siti a partire dall'elenco dei loro vicini, qualunque esso
 sia, e ottieniamo una partizione.
 I reticoli regolari di dimensione 
\begin_inset Formula $d$
\end_inset

 sono generati da 
\begin_inset Formula $d$
\end_inset

 vettori ad entrate intere: per controllare tutti i possibili collegamenti
 tra siti vicini è quindi sufficiente esaminarne 
\begin_inset Formula $d$
\end_inset

 opportunamente presi, invece del numero di coordinazione 
\begin_inset Formula $z=2d$
\end_inset

.
\end_layout

\begin_layout Standard
Facciamo l'esempio del reticolo bidimensionale ai primi vicini, come si
 vede in figura 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Reticolo-semplice-quadrato"

\end_inset

.
 Scorrendo il reticolo in modo ordinato, dall'alto verso il basso, da sinistra
 verso destra, ovvero secondo la naturale disposizione dei siti in memoria,
 si vede che per allargare progressivamente (a macchia d'olio) le partizioni,
 è conveniente considerare i siti vicini già visitati.
 Per il sito 
\begin_inset Formula $i$
\end_inset

-esimo si guarda quindi il vicino in alto (
\emph on
nearest neighbour up
\emph default
, nnu) e quello a sinistra (
\emph on
nearest neighbour left
\emph default
, nnl).
 In figura 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Griglia-bond"

\end_inset

 sono disegnate le linee che collegano ciascun sito con il corrispettivo
 
\family typewriter
nnl
\family default
 e 
\family typewriter
nnu
\family default
 -- si vedono tutti i possibili collegamenti, considerare ad esempio i vicini
 in basso e a destra non farebbe che ritracciare quanto già esaminato.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/griglia_bond.png
	width 70text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Collegamento dei siti con stesso simbolo, solo tramite vicino up e vicino
 left, essendo sufficienti a completare tutti i collegamenti (condizioni
 al contorno nonperiodiche).
\begin_inset CommandInset label
LatexCommand label
name "fig:Griglia-bond"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Problem*
Qual è la struttura ottimale (minima) di vicini per riottenere la partizione
 data?
\end_layout

\begin_layout Problem*
Basta unire uno-per-uno i siti all'interno di ogni atomo.
 Ovvero ogni sito ha un solo vicino, il sito che lo precede facente parte
 dello stesso atomo (o se stesso, se è il primo o unico).
 Questo è chiaramente sufficiente per ottenere di nuovo la partizione, si
 può scrivere come un vettore lungo 
\begin_inset Formula $L$
\end_inset

, indipendentemente dalla geometria del sistema e dal numero effettivo di
 vicini: è un modo estramamente comodo ed efficiente di catturare le informazion
i a partire da 
\family typewriter
NNB
\family default
, necessarie per la riduzione, ma che possono occupare molto spazio in memoria.
\end_layout

\begin_layout Subsection
Partizionamento
\end_layout

\begin_layout Standard
Una volta completato l'elenco essenziale dei vicini, si procede al partizionamen
to.
 L'algoritmo è noto in letteratura come algoritmo di Hoshen-Kopelmann
\begin_inset Note Note
status open

\begin_layout Plain Layout
bibliografia
\end_layout

\end_inset

, di cui utilizziamo la versione ottimizzata da Mark Newman
\begin_inset Note Note
status open

\begin_layout Plain Layout
biografia
\end_layout

\end_inset

.
 Il problema trattato di clustering è equivalente a bond-percolation, colorazion
e di grafo generico, ecc.
 
\end_layout

\begin_layout Standard
Per il procedimento si crea un array 
\family typewriter
labels[]
\family default
, lungo 
\begin_inset Formula $L$
\end_inset

, che alla fine dell'algoritmo è codificato nel seguente modo:
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000

\family typewriter
labels[i]<0 i
\family default
 è la 
\emph on
root
\emph default
 o 
\emph on
radice 
\emph default
del suo cluster, e 
\family typewriter
-labels[i]
\family default
 rappresenta la dimensione del cluster -- ovvero quanti siti vi appartengono
 in totale
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000

\family typewriter
labels[i]>0 
\family default
il sito punta ad un altro cluster, con 
\emph on
root 
\emph default
alla posizione 
\family typewriter
labels[i]
\end_layout

\begin_layout Standard
L'array è un insieme di radici e di puntatori ad altri siti -- rappresenta
 cioè un albero, con collegamenti da ogni foglia (sito), alla radice corrisponde
nte, che contiene il numero di siti che le appartengono.
 Per sapere a che cluster appartiene un qualunque sito, definisco la funzione
 
\family typewriter
findroot:
\begin_inset listings
lstparams "basicstyle={\small},language={C++}"
inline false
status open

\begin_layout Plain Layout

int findroot(int i,int labels[]) {   
\end_layout

\begin_layout Plain Layout

	if (labels[i]<0) return i;   
\end_layout

\begin_layout Plain Layout

	return labels[i] = findroot(labels[i],labels); 
\end_layout

\begin_layout Plain Layout

} 
\end_layout

\end_inset


\family default
definita ricorsivamente sull'albero.
 Se il sito ha un label negativo, allora è radice.
 Altrimenti, risalgo al sito a cui punta e reitero il procedimento.
 Ad ogni passo si esegue la 
\emph on
path compression
\emph default
: ogni sito su cui si passa è aggiornato per puntare direttamente alla radice
 -- in questo modo la volta successiva il percorso non deve essere ricostruito.
\end_layout

\begin_layout Standard
L'algoritmo è il seguente:
\end_layout

\begin_layout Enumerate
ad ogni sito si associa l'atomo banale, formato dal sito stesso, 
\family typewriter
labels[i]=-1
\family default
.
 In questo modo da subito ad ogni sito corrisponde un cluster, che verrà
 eventualmente allargato unendolo con i suoi vicini.
 
\end_layout

\begin_layout Enumerate
per ogni sito 
\family typewriter
i
\family default
, in ordine crescente, si controlla (fino ad esaurimento) il vettore 
\family typewriter
NNB[i].
\end_layout

\begin_deeper
\begin_layout Enumerate
cerco il cluster di appartenenza, 
\family typewriter
ri=findroot(i,labels)
\end_layout

\begin_layout Enumerate
per ogni vicino 
\family typewriter
j
\family default
, identifico a sua volta il cluster, 
\family typewriter
rj=findroot(j,labels)
\end_layout

\begin_layout Enumerate
se la radice è la stessa, ovvero appartengono già allo stesso cluster, non
 si fa nulla
\end_layout

\begin_layout Enumerate
se le radici sono diverse, si uniscono i cluster.
 C`è sicuramente un cluster più grosso (o uguale) e uno più piccolo, rispettivam
ente di radice 
\family typewriter
rmax 
\family default
e rmin.
 Per fare il numero minimo di cambiamenti, si aggiunge alla radice il numero
 di siti accorpati 
\begin_inset listings
lstparams "basicstyle={\small\ttfamily},language=C"
inline false
status open

\begin_layout Plain Layout

labels[rmax] -= labels[rmin]
\end_layout

\end_inset

 e si trasforma 
\family typewriter
rmin
\family default
 in una foglia del cluster più grosso:
\begin_inset listings
lstparams "basicstyle={\small\ttfamily},language=C"
inline false
status open

\begin_layout Plain Layout

labels[rmin] = rmax
\end_layout

\end_inset

 La volta successiva che si cerca la root dei siti che appartenevano al
 cluster più piccolo, si risalirà fino alla nuova radice --- il cluster
 è stato effettivamente assimilato, semplicemente cambiando il valore di
 un puntatore.
\end_layout

\end_deeper
\begin_layout Enumerate
alla fine tutti i siti sono stati controllati, 
\family typewriter
r=findroot(i, labels)
\family default
 punta alla radice di appartenenza, lo spazio è partizionato, l'intero 
\family typewriter
r 
\family default
identifica in maniera univoca le classi di equivalenza.
 
\end_layout

\begin_layout Standard
L'algoritmo è ottimale, con runtime 
\begin_inset Formula $\mathcal{O}(L\ln L)$
\end_inset

 e senza bisogno di memoria aggiuntiva.
 Il fattore logaritmico è dovuto alla fase di unione dei cluster, che in
 generale richiede 
\begin_inset Formula $\mathcal{O}(\ln L)$
\end_inset

 passi per sito per trovare la radice di appartenenza.
\end_layout

\begin_layout Subsection
Relabeling
\end_layout

\begin_layout Standard
Una volta che si ha il vettore 
\family typewriter
labels[]
\family default
, si può utilizzare le informazioni ivi contenute.
 Si costruisce un vettore di atomi, definendo per ciascuno una struttura
 che contiene informazioni quali le dimensioni, dove inizia, dove finisce,
 il 
\emph on
hash
\emph default
 corrispondente.
\end_layout

\begin_layout Standard
Per avere il numero degli atomi e inizializzare il vettore corrispondente
 basta contare quanti siti hanno 
\family typewriter
labels[i]<0
\family default
.
 Contemporaneamente possiamo associare ad ogni atomo le sue dimensioni,
 
\family typewriter
-labels[i]
\family default
, il suo sito di inizio 
\family typewriter
i
\family default
, e l'ultimo sito trovato, temporaneamente 
\family typewriter
i
\family default
.
 Ogni elemento del vettore labels punta ad un sito (o indica lo stesso come
 radice) per cui è contenuto nell'intervallo 
\begin_inset Formula $[0,\dots,L]$
\end_inset

 ed è possibile tenere conto di ogni atomo che si incontra scorrendo tutti
 i siti e utilizzare questo contatore come nuova etichetta: non più la radice,
 ma il numero dell'atomo corrispondente in 
\begin_inset Formula $[0,\dots,n]$
\end_inset

.
 
\end_layout

\begin_layout Standard
Avendo un elenco di atomi contente le dimensioni di ciascuno, si calcola
 l'entropia della partizione in modo diretto, sommando le dimensioni dei
 vari atomi moltiplicate per il loro logaritmo e normalizzando.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/organizzazione_siti.png
	width 8cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Per ogni sito è stato indicato l'atomo di appartenenza, sotto l'indice,
 sopra il valore del vettore che punta al sito precedente appartenente allo
 stesso atomo.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Generiamo inoltre il vettore ottimale dei vicini: 
\family typewriter
previous[]
\family default
.
 Per ogni sito 
\family typewriter
i
\family default
, conosciamo infatti l'atomo di appartenenza e il precedente sito trovato
 appartenente allo stesso atomo: 
\family typewriter
previous[i]
\family default
 conterrà proprio questo dato.
 Aggiorniamo poi il puntatore all'ultimo sito trovato con 
\family typewriter
i
\family default
 stesso.
 Andando a leggere il vettore 
\family typewriter
previous[]
\family default
 in modo ordinato, abbiamo una lista ordinata, che ad ogni intero associa
 un numero strettamente minore o uguale (se il sito non ha un precedente).
 
\end_layout

\begin_layout Subsection
Hashing
\end_layout

\begin_layout Standard
Definiamo un 
\emph on
hash
\emph default

\begin_inset Foot
status open

\begin_layout Plain Layout
etimologicamente, 
\emph on
to hash
\emph default
 vuol dire maciullare, sparpagliare
\end_layout

\end_inset

 come un modo univoco di associare ad ogni atomo un elemento dello spazio
 delle stringhe a 64bit --- il numero degli atomi è sicuramente molto inferiore
 a 
\begin_inset Formula $2^{64}$
\end_inset

 per cui con un buon algoritmo è improbabile che due atomi diversi ottengano
 lo stesso identificativo.
 
\end_layout

\begin_layout Standard
La conoscenza di un atomo corrisponde alla lista di siti che lo compongono,
 tuttavia sarebbe oneroso tenere da parte un'altra volta questa lista, ordinata
 stavolta per atomo, oppure andarla a ricostruire ogni volta.
 Per controllare l'uguaglianza tra due atomi di due diverse partizioni,
 bisognerebbe fare un confronto sito per sito.
 Se ogni atomo diverso è distinguibile solo con il confronto di un intero
 (operazione atomica), il confronto tra due atomi è immediato e 
\begin_inset Formula $\mathcal{O}(1)$
\end_inset

 in tempo, indipendentemente dalle dimensioni dell'atomo.
\end_layout

\begin_layout Standard
La chiave sta nel trovare un buon algoritmo di hashing, che sparpagli i
 bit di informazione contenuti dall'atomo in maniera uniforme nello spazio
 delle stringhe binarie a 64bit, in modo che a input diverso corrisponda
 
\emph on
sempre
\emph default
 (a meno di una probabilità idealmente prossima a 
\begin_inset Formula $2^{-64}$
\end_inset

) un identificativo diverso.
 L'algoritmo utilizzato in questo caso è l'estremamente semplice 
\emph on
hash DJB
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
dal nome dell'ideatore, D.
 J.
 Bernstein
\end_layout

\end_inset

, 
\emph default
dopo un confronto con alcuni altri algoritmi risultati dare molte collisioni,
 ovvero capitava che triple di interi diverse dessero risultati uguali.
\end_layout

\begin_layout Standard
Gli atomi sono equivalenti ad array di interi, per cui l'algoritmo prende
 un array di lunghezza arbitraria di interi a 32bit e restituisce un intero
 a 64bit, partendo da un valore costante iniziale, fissato empiricamente
 a 5381.
 L'aggiunta di un intero 
\family typewriter
value
\family default
 alla variabile 
\family typewriter
hash
\family default
 avviene nel modo sequente:
\begin_inset listings
lstparams "basicstyle={\small\ttfamily},language=C"
inline false
status open

\begin_layout Plain Layout

void DJBHash_step(u_int64_t &hash, u_int32_t value) {
\end_layout

\begin_layout Plain Layout

    hash = (hash << 5) + hash + (0xff000000 & value);
\end_layout

\begin_layout Plain Layout

    hash = (hash << 5) + hash + (0x00ff0000 & value);
\end_layout

\begin_layout Plain Layout

    hash = (hash << 5) + hash + (0x0000ff00 & value);
\end_layout

\begin_layout Plain Layout

    hash = (hash << 5) + hash + (0x000000ff & value);
\end_layout

\begin_layout Plain Layout

}
\end_layout

\end_inset

ovvero la variabile a 32bit che codifica il valore del sito viene spezzata
 in 4 pezzi da 1 byte ciascuno; ogni byte viene sommato al hash, mentre
 questo viene rimischiato tramite uno shift e una somma del valore precedente.
 Senza spezzettare i 4 byte il rimescolamento dei bit risulta insufficiente
 e il hash perde di unicità.
\end_layout

\begin_layout Standard
Il hash viene calcolato intanto che si scorre l'array dei labels e si costruisce
 il vettore 
\family typewriter
previous
\family default
.
 Per ogni sito 
\family typewriter
i
\family default
 recuperiamo l'indice dell'atomo corrispondente 
\family typewriter
labels[i]
\family default
, che contiene una variabile preposta all'immagazzinamento del hash, al
 quale aggiungiamo il valore di 
\family typewriter
i
\family default
 di volta in volta.
\end_layout

\begin_layout Section
Operazioni tra partizioni generiche
\end_layout

\begin_layout Subsection
Prodotto
\end_layout

\begin_layout Standard
Dovendo ragionare sui label assegnati ai siti, cerchiamo un modo di labellare
 in modo univoco i siti nella partizione prodotto.
 Dalla definizione si ottiene che un sito 
\begin_inset Formula $i$
\end_inset

 appartiene all'atomo 
\begin_inset Formula $(\alpha\vee\beta)_{jk}\text{ se appartiene a }\alpha_{j}\cap\beta_{k}$
\end_inset

, ovvero se ha label 
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $j$
\end_inset


\begin_inset Quotes erd
\end_inset

 nella partizione 
\begin_inset Formula $\alpha$
\end_inset

 e label 
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $k$
\end_inset


\begin_inset Quotes erd
\end_inset

 nella partizione 
\begin_inset Formula $\beta$
\end_inset

.
\end_layout

\begin_layout Standard
Il prodotto deve mantenere la topologia, quindi prendendo due siti 
\begin_inset Quotes eld
\end_inset

vicini
\begin_inset Quotes erd
\end_inset

, ovvero appartenti allo stesso atomo in entrambe le partizioni, devono
 rimanere nello stesso atomo del prodotto
\begin_inset Formula 
\[
m,n\in\alpha_{j}\;\text{e}\; m,n\in\beta_{k}\text{ \implies}m,n\in(\alpha\vee\beta)_{jk}
\]

\end_inset

ma i siti 
\begin_inset Formula $m,n$
\end_inset

 hanno label 
\begin_inset Formula $\lambda_{\alpha}(m)=\lambda_{\alpha}(n)=j$
\end_inset

 e 
\begin_inset Formula $\lambda_{\beta}(m)=\lambda_{\beta}(n)=k$
\end_inset

 rispettivamente per le due partizioni --- devono avere lo stesso label
 nel prodotto, che può dipendere solo dal label degli atomi di partenza.
 L'unica scelta possibile è assegnare label 
\begin_inset Formula $(j,k)$
\end_inset

 (o equivalente) ad ogni sito del prodotto, ovvero la coppia (ordinata)
 dei label di partenza.
 Una volta eseguito l'assegnamento, gli atomi sono riconosciuti cercando
 label dello stesso valore.
 Tutto il procedimento è illustrato in figura 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:prodotto-generico"

\end_inset

.
\end_layout

\begin_layout Standard
Se i label sono rappresentati da interi a 32bit, la coppia può essere rappresent
ata da un intero a 64bit, avente nei primi 32bit il valore del primo label,
 e negli ultimi quello del secondo: in questo modo tutte le operazioni sono
 atomiche su un moderno processore.
\end_layout

\begin_layout Standard
Ricapitolando: al sito 
\begin_inset Formula $i$
\end_inset

-esimo, partendo da 
\begin_inset Formula $\lambda_{\alpha}(i)=j$
\end_inset

 e 
\begin_inset Formula $\lambda_{\beta}(i)=k$
\end_inset

, si assegna nel prodotto 
\begin_inset Formula $\lambda_{\alpha\vee\beta}(i)=(j,k)$
\end_inset

:
\end_layout

\begin_layout Standard
\align center

\family typewriter
prod[i] = alpha[i] << 32 | beta[i];
\family default

\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/prodotto_partizioni.png
	width 80col%

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
Calcolo di un prodotto tra partizioni.
 a)partizioni di partenza; b)partizione prodotto; c)lunghezze degli atomi
 ordinati del prodotto,al fine di calcolare l'entropia
\begin_inset CommandInset label
LatexCommand label
name "fig:prodotto-generico"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
come si vede dalla formula esplicita, 
\begin_inset Formula $(j,k)\neq(k,j)$
\end_inset

 in quanto gli indici identificano atomi appartenenti a partizioni diverse,
 con siti in genere diversi -- se al posto del OR binario si volesse usare
 un'altra operazione, ne va cercata una asimmetrica nei due indici, per
 non unire atomi distinti.
 Ad esempio una partizione con labels {1,2} è equivalente a {2,1} (sempre
 due atomi distinti); il prodotto è ancora una partizione con due atomi,
 ma le etichette del prodotto sono: {(1,2),(2,1)} -- devono essere chiaramente
 diverse.
\begin_inset Note Note
status open

\begin_layout Plain Layout
e` meglio un'immagine?
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Anche in questo caso il prodotto comporta un numero di operazioni sito-per-sito,
 con complessità 
\begin_inset Formula $\mathcal{O}(\mathrm{L})$
\end_inset

.
\end_layout

\begin_layout Subsection
Entropia
\begin_inset CommandInset label
LatexCommand label
name "sub:sort_entropy"

\end_inset


\end_layout

\begin_layout Standard
Per calcolare il numero di siti di un atomo, ovvero corrispondente ad ogni
 etichetta univoca, bisogna innanzitutto scorrere l'elenco per cercare tutte
 le etichette e ogni volta che se ne trova una non precedentemente catalogata,
 scorrere l'intero array in avanti e contare quante volte appare.
 Questa è chiaramente un'operazione con complessità
\begin_inset Formula 
\[
\sum_{i=1}^{L}(L-i)=\mathcal{O}(L^{2})
\]

\end_inset


\end_layout

\begin_layout Standard
Ma si può fare meglio.
 Infatti non è necessario scorrere N volte l'intero elenco dei labels.
 Si può riordinare questo elenco tramite un'operazione di 
\emph on
sort
\emph default

\begin_inset Foot
status open

\begin_layout Plain Layout
Nello specifico ci affidiamo al 
\emph on
quicksort
\emph default
 delle librerie glibc
\end_layout

\end_inset

.
 L'andamento asintotico è noto in letteratura 
\begin_inset Note Note
status open

\begin_layout Plain Layout
bibliografia!!!
\end_layout

\end_inset

 essere 
\begin_inset Formula $\mathcal{O}(L\log_{2}L)$
\end_inset

 nel numero di siti, con una costante di proporzionalità dipendente dall'algorit
mo, ma non particolarmente onerosa.
\end_layout

\begin_layout Standard
Ordinando l'elenco delle etichette (non importa neanche se in ordine crescente
 o decrescente) si ottiene un array in cui sicuramente tutti gli elementi
 uguali sono consecutivi -- si procede a questo punto al calcolo dell'entropia
 come se si trattasse di una sequenza unidimensionale.
\end_layout

\begin_layout Standard
L'altro metodo, computazionalmente più semplice, 
\begin_inset Formula $\mathcal{O}(L)$
\end_inset

 sia in runtime che in memoria, che consiste nel numerare temporaneamente
 tutti i label trovati in ordine crescente e rietichettarli con la successione
 
\begin_inset Formula $\{1,2,\dots\}$
\end_inset

 non è gestibile, in quanto i label possono essere distribuiti in modo 
\begin_inset Quotes eld
\end_inset

sparso
\begin_inset Quotes erd
\end_inset

 nello spazio delle coppie 
\begin_inset Formula $(j,k)$
\end_inset

.
 In generale vi possono essere al massimo 
\begin_inset Formula $L$
\end_inset

 atomi nel prodotto, ma 
\begin_inset Formula $L\times L$
\end_inset

 coppie, quindi sicuramente non tutte sono realizzate.
 La complessità dell'organizzarle in qualche altro modo, ad esempio in un
 albero binario bilanciato o un hash -- tutte superano in fretta la semplicità
 del 
\emph on
sort
\emph default
 e anche nel caso migliore hanno lo stesso andamento asintotico.
 In pratica l'andamento è polinomialmente peggiore, per motivi di mal gestione
 della cache L1 e L2 del processore, in quanto sia gli alberi che i hash
 risultano nonlocali, mentre un sort sposta gli elementi in modo ordinato
 e accede alla memoria in modo più lineare.
\end_layout

\end_body
\end_document
