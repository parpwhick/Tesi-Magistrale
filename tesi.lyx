#LyX 2.0 created this file. For more info see http://www.lyx.org/
\lyxformat 413
\begin_document
\begin_header
\textclass book
\begin_preamble
%\usepackage[charter]{mathdesign}
%\usepackage{fourier}
\usepackage[utopia]{mathdesign}
%\usepackage[varg]{mathdesign}
%\usepackage{fouriernc}
%\usepackage[varg]{txfonts} % ok!
%\usepackage{mathtime}

\usepackage{placeins}
\DeclareMathOperator{\vol}{vol}
\DeclareMathOperator{\cut}{cut}
\DeclareMathOperator{\ncut}{ncut}
\end_preamble
\use_default_options true
\begin_modules
theorems-ams
eqs-within-sections
figs-within-sections
\end_modules
\maintain_unincluded_children false
\language italian
\language_package default
\inputencoding auto
\fontencoding global
\font_roman charter
\font_sans default
\font_typewriter default
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100

\graphics default
\default_output_format pdf2
\output_sync 0
\bibtex_command bibtex
\index_command default
\paperfontsize 11
\spacing single
\use_hyperref true
\pdf_title "Sviluppi teorici e applicativi delle metriche entropiche di Rohlin"
\pdf_author "Dawid Crivelli"
\pdf_keywords "entropia, clustering, metriche, partizionamento"
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder false
\pdf_colorlinks false
\pdf_backref section
\pdf_pdfusetitle true
\papersize a4paper
\use_geometry true
\use_amsmath 1
\use_esint 0
\use_mhchem 1
\use_mathdots 1
\cite_engine natbib_numerical
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 3cm
\topmargin 3cm
\rightmargin 3cm
\bottommargin 3cm
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 2
\paperpagestyle headings
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
\align center
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
thispagestyle{empty}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align center

\size huge
Università degli studi di Parma
\end_layout

\begin_layout Standard
\align center

\size larger
Facoltà di Scienze Naturali, Fisiche e Matematiche
\end_layout

\begin_layout Standard
\align center

\size largest
Corso di Laurea in Fisica Teorica
\begin_inset VSpace 1.2cm
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../vecchia-tesi/images/sigillo.png
	width 4cm

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace 1cm
\end_inset


\end_layout

\begin_layout Standard
\align center

\size giant
Sviluppi teorici e applicativi delle metriche entropiche di Rohlin
\end_layout

\begin_layout Standard
\begin_inset VSpace 3cm
\end_inset


\end_layout

\begin_layout Standard

\size larger
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "50text%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\align left

\size larger
Relatore:
\begin_inset Newline newline
\end_inset

prof.
 Mario Casartelli
\end_layout

\begin_layout Plain Layout
\align left
\begin_inset VSpace medskip
\end_inset


\end_layout

\begin_layout Plain Layout
\align left

\size larger
Correlatore:
\begin_inset Newline newline
\end_inset

prof.ssa Raffaella Burioni
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\size larger
\begin_inset VSpace 1cm
\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "40text%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\align center

\size larger
Tesi presentata da:
\begin_inset Newline newline
\end_inset

Dawid Crivelli Wieslaw
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset VSpace vfill
\end_inset


\size larger

\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
\align center

\size larger
Sessione Laurea 26 aprile 2012
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align center

\size larger
Anno Accademico 2010-2011
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
null
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage cleardoublepage
\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage cleardoublepage
\end_inset


\end_layout

\begin_layout Chapter*
Introduzione
\end_layout

\begin_layout Standard
In questa tesi ci siamo occupati della metrica di Rohlin sotto diversi aspetti
 formali e algoritmici, per una migliore comprensione del suo significato
 e della sua adattabilità allo studio di situazioni complesse, quali ad
 esempio l'evoluzione di sequenze geniche o la caratterizzazione di sistemi
 disordinati in meccanica statistica.
 Lo scopo iniziale del lavoro era approfondire l'utilizzo delle misure entropich
e di Rohlin su sequenze biologiche, corrispondenti alla sequenza di amminoacidi
 della proteina HA dei virus dell'influenza.
 Differente dalla solita distanza che differenzia mutazioni puntuali nei
 simboli, la distanza di Rohlin lavora nello spazio delle partizioni sulle
 sequenze, permettendo di evidenziare strutture e differenze globali, con
 alto potere predittivo per quanto riguarda il riconoscimento dell'emergenza
 di nuovi ceppi virali a partire dalla distanza su un insieme di sequenze
 campionato nel tempo.
 
\end_layout

\begin_layout Standard
La metrica entropica misura la distanza tra le partizioni costruite a partire
 dai simboli sulle sequenze.
 La scelta più semplice, che ha dimostrato ottime proprietà, corrisponde
 a prendere partizioni formate da segmenti omogenei di simboli.
 Abbiamo inoltre esteso il criterio di partizionamento rendendolo del tutto
 generale.
 Per migliorare la sensibilità delle metriche utilizzate, è risultato anche
 in questo caso cruciale definire un metodo di amplificazione delle distanze,
 detto 
\emph on
riduzione
\emph default
, su cui abbiamo concentrato i nostri sforzi al fine di ottenere un'implementazi
one ottimale.
 La riduzione consiste nella semplificazione dei fattori che non influiscono
 sulla distanza: si calcola l'intersezione tra le due partizioni e si ricostruis
ce la partizione evitando di includere i fattori che risultano comuni.
 
\end_layout

\begin_layout Standard
Abbiamo sperimentato anche la definizione di diversi processi di riduzione,
 sempre perfettamente generali, utilizzabili su partizioni non aventi una
 geometria predefinita sottostante: ad esempio usando un criterio meno sensibile
 a variazioni sui singoli siti, tralasciando direttamente fattori anche
 nel caso in cui non sono comuni, ma differiscono in misura meno di una
 soglia 
\begin_inset Formula $\epsilon$
\end_inset

.
 Per fare ciò si è dovuto definire operazioni binarie tra partizioni usando
 algoritmi di 
\emph on
clustering
\emph default
 e 
\emph on
sorting
\emph default
, per potere rimuovere anche i limiti sull'insieme dei simboli ammesso nelle
 sequenze.
 Questo rende possibile definire lo studio delle distanze tra partizioni
 di qualunque forma e dimensione, generalizzando il problema allo studio
 di partizioni su reticoli anche con un elevato numero di siti (
\begin_inset Formula $N\sim10^{6})$
\end_inset

 prima non attaccabile, esibendo un andamento asintotico 
\begin_inset Formula $\mathcal{O}(N\ln N)$
\end_inset

 per singola operazione.
 
\end_layout

\begin_layout Standard
Nel caso di sequenze biologiche abbiamo studiato variazioni nei possibili
 tipi di distanza.
 La complessità nelle sequenze è solitamente misurata con l'entropia metrica
 di Shannon, che dipende dalla lunghezza dei segmenti individuati.
 Non essendoci un criterio fondamentale per pesare le lunghezze, abbiamo
 sperimentato anche l'utilizzo dell'entropia topologica, definita solo in
 base al numero di atomi in cui è stata partizionata la sequenza.
 Abbiamo inoltre verificato cosa accade quando si formano partizioni nonconnesse
, per evitare che mutazioni puntuali nascondano possibili invarianze su
 un piano più astratto, permettendo quindi di collegare amminoacidi uguali
 anche saltando un numero massimo predefinito di simboli diversi.
 Si è studiato come l'informazione fornita dalla sequenza viene filtrata
 dall'ignorare mutazioni su scale sempre più lunghe o utilizzando alfabeti
 ridotti di amminoacidi.
 Tutto per svincolarsi da supposizioni ad hoc ed esplorare il panorama delle
 possibili misure, per verificare quali meglio mettono in evidenza la funzionali
tà biologica in gioco nel processo evolutivo, senza mai fare assunzioni
 richiedenti la conoscenza di caratteristiche biologiche non direttamente
 inferibili dalle sequenze considerate.
 Si è anche analizzato diversi algoritmi per raggruppare sequenze simili,
 notando che l'emergenza dei 
\emph on
cluster
\emph default
 di notevole interesse biologico evidenziati grazie alla distanza di Rohlin
 non dipende dal metodo scelto.
 Lo studio di tutte le distanze ha selezionato il miglior tipo di distanza,
 in cui la 
\emph on
riduzione
\emph default
 ha un ruolo fondamentale, mentre un'eccessiva aggregazione di siti e mutazioni
 maschera l'essenziale funzione del drift genetico.
\end_layout

\begin_layout Standard
Per sistemi di Ising in assenza di campo magnetico, l'energia del sistema
 è invariante per inversione degli spin e le grandezze fisiche rilevanti
 sono le differenze tra spin vicini, opportunamente rappresentate dai bordi
 delle partizioni formate da cluster connessi di spin omogenei.
 La distanza di Rohlin con questo partizionamento cattura solo l'effettiva
 differenza tra realizzazioni dello stesso sistema rispecchiando la simmetria
 dell'hamiltoniana.
 Anche generalizzando l'accoppiamento al caso disordinato, la distanza media
 al crescere della lunghezza delle sequenze ha permesso di definire e misurare
 una lunghezza di correlazione efficace in funzione della temperatura.
 Lo studio è stato esteso a un sistema bidimensionale di Ising in diversi
 istanti temporali, sia all'equilibrio che in fase transiente o stazionaria
 a partire da una configurazione casuale, per verificare la adattabilità
 del metodo a modelli disordinati più generali del reticolo monodimensionale.
\end_layout

\begin_layout Chapter
Partizioni su insiemi
\end_layout

\begin_layout Standard
Definiamo in questo capitolo alcuni concetti fondamentali: le partizioni
 su un insieme, il significato di entropia, lo spazio delle partizioni con
 le operazioni binarie associate e una distanza tra partizioni.
 Studiamo le proprietà di questa distanza e come amplificarla.
 Diamo infine qualche esempio sui possibili tipi di partizioni che si possono
 incontrare su un insieme discreto.
\end_layout

\begin_layout Section
Generalità
\end_layout

\begin_layout Standard
Introduciamo il formalismo e risultati generali per spazi di partizioni
 e metriche di Rohlin, seguendo l'approccio in 
\begin_inset CommandInset citation
LatexCommand citep
key "billingsley1965ergodic,Vivo2010"

\end_inset

.
 Sia 
\begin_inset Formula $(\mathrm{\mathbf{M}},\mathit{\mathcal{M}},\mu)$
\end_inset

 uno spazio di probabilità, ovvero un insieme 
\begin_inset Formula $\mathbb{\mathbf{M}}$
\end_inset

, una 
\begin_inset Formula $\sigma$
\end_inset

-algebra 
\begin_inset Formula $\mathcal{M}$
\end_inset

 di sottoinsiemi di 
\begin_inset Formula $\mathbb{\mathbf{M}}$
\end_inset

, una misura normalizzata 
\begin_inset Formula $\mu$
\end_inset

 su 
\begin_inset Formula $\mathcal{M}$
\end_inset

.
 Nei casi trattati 
\begin_inset Formula $\mathbb{\mathbf{M}}$
\end_inset

 può essere una sequenza di simboli, un reticolo bidimensionale, un grafo
 arbitrario.
\end_layout

\begin_layout Standard
Introducendo una relazione di equivalenza su 
\begin_inset Formula $\mathbb{\mathbf{M}}$
\end_inset

, possiamo definire una particolare classe di sottoinsiemi.
 Una 
\emph on
partizione
\emph default
 di 
\begin_inset Formula $\mathbb{\mathbf{M}}$
\end_inset

 è una collezione finita 
\begin_inset Formula $\alpha\equiv(A_{1},A_{2},\dots,A_{N})$
\end_inset

 di sottoinsiemi disgiunti misurabili che ricoprono 
\begin_inset Formula $\mathbb{\mathbf{M}}$
\end_inset

, cioè 
\begin_inset Formula $A_{i}\cap A_{j}=\emptyset$
\end_inset

 se 
\begin_inset Formula $i\neq j$
\end_inset

 e 
\begin_inset Formula $\bigcup_{k}A_{k}=\mathbf{M}$
\end_inset

.
 Gli 
\begin_inset Formula $\{A_{k}\}$
\end_inset

 sono chiamati 
\emph on
atomi
\emph default
 di 
\begin_inset Formula $\alpha$
\end_inset

 e sono una rappresentano le classi di equivalenza degli elementi di 
\begin_inset Formula $\mathbb{\mathbf{M}}$
\end_inset

.
 L'insieme di tutte le partizioni misurabili è denotato con 
\begin_inset Formula $\mathcal{Z}\equiv\mathcal{Z}(\mathbf{M})$
\end_inset

.
 La partizione unitaria 
\begin_inset Formula $\nu$
\end_inset

 consiste del singolo atomo coincidente con 
\begin_inset Formula $\mathbb{\mathbf{M}}$
\end_inset

.
 È possibile introdurre un ordine parziale su 
\begin_inset Formula $\mathcal{Z}$
\end_inset

, con la relazione 
\begin_inset Formula $\alpha\leq\beta$
\end_inset

 quando 
\begin_inset Formula $\beta$
\end_inset

 è un raffinamento di 
\begin_inset Formula $\alpha$
\end_inset

: questo accade quando ogni atomo 
\begin_inset Formula $A_{k}$
\end_inset

 è esattamente composto da atomi di 
\begin_inset Formula $\beta$
\end_inset

, cioè 
\begin_inset Formula $A_{k}=\left\{ \bigcup_{j}\ B_{j}\mid B_{j}\in\beta\right\} $
\end_inset

.
 In questo caso, si dice che 
\begin_inset Formula $\alpha$
\end_inset

 è un 
\emph on
fattore
\emph default
 di di 
\begin_inset Formula $\beta$
\end_inset

.
 La partizione banale 
\begin_inset Formula $\nu\leq\alpha,\;\forall\alpha$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset VSpace medskip
\end_inset


\end_layout

\begin_layout Standard
I termini come 
\emph on
unità
\emph default
 e 
\emph on
fattore
\emph default
 dipendono dalla definizione di uno pseudo-prodotto commutativo ed associativo,
 la composizione 
\begin_inset Formula $\gamma=\alpha\vee\beta$
\end_inset

 (o anche 
\begin_inset Formula $\gamma=\alpha\beta$
\end_inset

 ove non vi sia ambiguità).
 Il 
\emph on
prodotto
\emph default
 è la partizione meno fine di tutte le partizioni con 
\begin_inset Formula $\gamma\geq\alpha$
\end_inset

 e 
\begin_inset Formula $\gamma\geq\beta$
\end_inset

, i cui atomi sono le intersezioni non vuote di tutti gli atomi di 
\begin_inset Formula $\alpha$
\end_inset

 e 
\begin_inset Formula $\beta$
\end_inset

.
 Chiaramente il prodotto con l'unità si comporta come l'identità del prodotto,
 con 
\begin_inset Formula $\alpha\nu=\alpha$
\end_inset

 per ogni 
\begin_inset Formula $\alpha$
\end_inset

, mentre 
\begin_inset Formula $\alpha\eta=\alpha$
\end_inset

 quando 
\begin_inset Formula $\eta\leq\alpha$
\end_inset

.
 Queste proprietà rendono il risultato della composizione una specie di
 
\begin_inset Quotes eld
\end_inset

minimo comune multiplo
\begin_inset Quotes erd
\end_inset

.
 Dalla definizione segue anche che 
\begin_inset Formula $\alpha\vee\alpha=\alpha$
\end_inset

, ovvero il prodotto è idempotente.
\end_layout

\begin_layout Standard
\begin_inset VSpace medskip
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/semplice.png
	lyxscale 20
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Esempio di prodotto e intersezione tra due partizioni
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
L'operazione complementare che implementa un 
\begin_inset Quotes eld
\end_inset

massimo comune divisore
\begin_inset Quotes erd
\end_inset

 nello spazio delle partizioni è l'
\emph on
intersezione
\emph default
 
\begin_inset Formula $\sigma=\alpha\wedge\beta$
\end_inset

, definita come la partizione più fine tale che 
\begin_inset Formula $\sigma\leq\alpha$
\end_inset

 e 
\begin_inset Formula $\sigma\leq\beta$
\end_inset

.
 In questo caso, 
\begin_inset Formula $\alpha\wedge\nu=\nu$
\end_inset

 per ogni 
\begin_inset Formula $\alpha$
\end_inset

, mentre 
\begin_inset Formula $\alpha\wedge\beta=\nu$
\end_inset

 implica che 
\begin_inset Formula $\alpha$
\end_inset

 e 
\begin_inset Formula $\beta$
\end_inset

 sono 
\emph on
relativamente primi
\emph default
, cioè non hanno un fattore comune.
 
\end_layout

\begin_layout Standard
\begin_inset VSpace medskip
\end_inset


\end_layout

\begin_layout Standard
Un altro modo di calcolare e visualizzare le operazioni è in termini di
 
\emph on
bordi interni
\emph default
 di atomi della partizione, come si vede in figura 
\begin_inset CommandInset ref
LatexCommand vref
reference "fig:Intersezione-e-prodotto-bordi"

\end_inset

.
 Il prodotto 
\begin_inset Formula $\alpha\vee\beta$
\end_inset

 corrisponde alla partizione avente come bordi l'unione dei bordi di 
\begin_inset Formula $\alpha$
\end_inset

 e 
\begin_inset Formula $\beta$
\end_inset

, mentre l'intersezione 
\begin_inset Formula $\alpha\wedge\beta$
\end_inset

 ha come bordi l'intersezione di quelli di 
\begin_inset Formula $\alpha$
\end_inset

 e 
\begin_inset Formula $\beta$
\end_inset

.
 Quando nell'intersezione i bordi non si chiudono, sono cancellati dal risultato
 e gli atomi raggruppati.
 Poiché la partizione banale non ha bordi tra atomi, si ricavano immediatamente
 le sue proprietà nel prodotto e nell'intersezione.
 
\end_layout

\begin_layout Standard
\begin_inset VSpace medskip
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/prodotto_bordi.png
	width 70col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Intersezione e prodotto come operazioni sui bordi.
 Le partizioni 
\begin_inset Formula $\alpha$
\end_inset

 e 
\begin_inset Formula $\beta$
\end_inset

 hanno bordi tratteggiati, con fase complementare, che danno l'impressione
 di linea continua quando sovrapposti.
 È evidente in questo modo il tratto di bordi in comune.
 Gli atomi sono stati numerati per rendere evidente la differenza tra le
 due operazioni.
\begin_inset CommandInset label
LatexCommand label
name "fig:Intersezione-e-prodotto-bordi"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Una partizione può rappresentare un esperimento probabilistico con risultati
 disgiunti 
\begin_inset Formula $A_{1},\dots,A_{N}$
\end_inset

, dove l'evento 
\emph on
atomico
\emph default
 
\begin_inset Formula $A_{k}$
\end_inset

 ha probabilità 
\begin_inset Formula $\mu(A_{k})$
\end_inset

.
 Un 
\emph on
fattore
\emph default
 è quindi un sottoesperimento dell'esperimento più fine, che raggruppa diversi
 risultati come equivalenti: ad esempio, 
\begin_inset Quotes eld
\end_inset

pari o dispari
\begin_inset Quotes erd
\end_inset

 è un sottoesperimento con due atomi, dell'esperimento 
\begin_inset Formula $\{1,2,3,4,5,6\}$
\end_inset

 del lancio di un dado.
\end_layout

\begin_layout Standard
\begin_inset VSpace medskip
\end_inset


\end_layout

\begin_layout Standard
Sullo spazio 
\begin_inset Formula $\mathcal{Z}$
\end_inset

 possiamo definire dei funzionali 
\emph on
entropia
\emph default
 
\begin_inset Formula $H:\mathcal{Z}\rightarrow\mathbb{R^{\mathbf{+}}}$
\end_inset

, definiti su ogni partizione.
 In particolare l'
\emph on
entropia di Shannon
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
H_{S}(\alpha)=-\sum_{i=1}^{n}\mu(A_{i})\ln\mu(A_{i})
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
L'entropia di Shannon è una misura dell'informazione media ottenuta dall'esperim
ento.
 Si vede immediatamente che la partizione banale 
\begin_inset Formula $\nu$
\end_inset

, non codificando alcuna informazione ha entropia nulla.
 Se 
\begin_inset Formula $\beta=(B_{1},\dots,B_{n})$
\end_inset

 è un'altra partizione, l'entropia condizionata di 
\begin_inset Formula $\alpha$
\end_inset

 rispetto a 
\begin_inset Formula $\beta$
\end_inset

 è
\begin_inset Formula 
\begin{equation}
H_{S}(\alpha|\beta)=-\sum_{i=1}^{n}\sum_{k=1}^{m}\mu(A_{i}\cap B_{k})\ln\frac{\mu(A_{i}\cap B_{k})}{\mu(B_{k})}=H_{S}(\alpha\vee\beta)-H_{S}(\beta)\label{eq:entropia_condizionata}
\end{equation}

\end_inset

dove si prende per convenzione che 
\begin_inset Formula $x\ln x=0$
\end_inset

 se 
\begin_inset Formula $x=0$
\end_inset

.
 L'entropia condizionata è l'informazione media residua ottenuta da 
\begin_inset Formula $\alpha$
\end_inset

 quando il risultato per 
\begin_inset Formula $\beta$
\end_inset

 è noto.
 Si noti che l'entropia di Shannon dipende solo dalla distribuzione delle
 misure degli atomi, non dalla loro natura o 
\begin_inset Quotes eld
\end_inset

forma
\begin_inset Quotes erd
\end_inset

, che potrebbe non avere significato in spazi astratti.
 Le mutue relazioni tra atomi (e possibilmente le loro forme) al contrario
 influenzano direttamente l'entropia condizionale.
 
\end_layout

\begin_layout Standard
\begin_inset VSpace medskip
\end_inset


\end_layout

\begin_layout Standard
Definiamo una metrica sullo spazio delle partizioni 
\begin_inset Formula $\mathcal{Z}(\mathbf{M})$
\end_inset

 tramite la distanza di Rohlin 
\begin_inset Formula $d_{\mathrm{R}}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
d_{\mathrm{R}}=H(\alpha|\beta)+H(\beta|\alpha)
\]

\end_inset

che misura la complessiva non-similarità tra le partizioni 
\begin_inset Formula $\alpha$
\end_inset

 e 
\begin_inset Formula $\beta$
\end_inset

.
 È possibile dare una definizione alternativa di questa distanza, sfruttando
 la seconda scrittura della probabilità condizionale, riscrivendo 
\begin_inset Formula $d_{\mathrm{R}}$
\end_inset

 come
\begin_inset Formula 
\begin{equation}
d_{\mathrm{R}}=2H(\alpha\vee\beta)-H(\alpha)-H(\beta)\label{eq:distanza_rohlin}
\end{equation}

\end_inset

La simmetria 
\begin_inset Formula $d_{\mathrm{R}}(\alpha,\beta)=d_{\mathrm{R}}(\beta,\alpha)$
\end_inset

, la positività e la condizione 
\begin_inset Formula $d_{\mathrm{R}}(\alpha,\alpha)=0$
\end_inset

 sono manifeste, mentre la disuguaglianza triangolare è soddisfatta se 
\begin_inset Formula $H$
\end_inset

 soddisfa alle condizioni di un funzionale entropia 
\begin_inset CommandInset citation
LatexCommand citep
key "billingsley1965ergodic"

\end_inset

:
\begin_inset Formula 
\begin{align*}
H(\alpha\vee\beta\;|\;\sigma) & =H(\alpha\;|\;\beta)+H(\beta\;|\;\alpha\vee\sigma)\\
H(\alpha\vee\beta\;|\;\sigma) & \leq H(\alpha\;|\;\sigma)+H(\beta\;|\;\sigma)\\
H(\alpha\;|\;\sigma) & \leq H(\beta\;|\;\sigma)\quad\text{se}\quad\alpha\subset\beta\\
H(\alpha\;|\;\sigma) & \leq H(\alpha\;|\;\beta)\quad\text{se}\quad\sigma\supset\beta
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Se 
\begin_inset Formula $\mathbf{M}$
\end_inset

 è finito, una 
\emph on
configurazione
\emph default
 o 
\emph on
stato
\emph default
 
\begin_inset Formula $\mathbf{a}$
\end_inset

 su 
\begin_inset Formula $\mathbf{M}$
\end_inset

 è una funzione che assegna ad ogni punto 
\begin_inset Formula $x_{i}\in\mathbf{M}$
\end_inset

 un valore 
\begin_inset Formula $a_{i}=f(x_{i})$
\end_inset

 nell'alfabeto 
\begin_inset Formula $\mathbb{K}$
\end_inset

.
 Tutte le possibili configurazioni formano uno spazio 
\begin_inset Formula $\mathcal{C}\equiv\mathcal{C}(\mathbf{M})$
\end_inset

.
 Su 
\begin_inset Formula $\mathcal{C}$
\end_inset

 la distanza di Hamming è definita come
\begin_inset Formula 
\[
d_{\mathrm{H}}(\mathbf{a,b})=\mathcal{N}\sum_{i}\rho(a_{i},b_{i})
\]

\end_inset

 dove 
\begin_inset Formula $\rho(a_{i},b_{i})$
\end_inset

 è una distanza su 
\begin_inset Formula $\mathbb{K}$
\end_inset

 e 
\begin_inset Formula $\mathcal{N}$
\end_inset

 una possibile costante di rinormalizzazione, che noi porremo uguale a 1.
 Da notare come questa distanza operi tra elementi diversi dalla distanza
 di Rohlin, pur partendo sempre da 
\begin_inset Formula $\mathbb{\mathbf{M}}$
\end_inset

.
\end_layout

\begin_layout Subsection
Distanza topologica
\end_layout

\begin_layout Standard
Oltre all'entropia di Shannon, definita tramite la misura 
\begin_inset Formula $\mu$
\end_inset

, è possibile una definizione alternativa che non vi fa ricorso.
 Per questo motivo, è chiamata 
\emph on
entropia topologica.

\emph default
 Dato uno spazio compatto, come lo spazio
\begin_inset Formula $\mathbf{M}$
\end_inset


\begin_inset Foot
status open

\begin_layout Plain Layout
Addirittura 
\begin_inset Formula $\mathbf{M}$
\end_inset

 nel nostro caso è discreto, per cui la compattezza è equivalente all'essere
 finito.
 
\end_layout

\end_inset

 da noi considerato, il teorema di Heine-Borel
\begin_inset CommandInset citation
LatexCommand citep
key "munkres2000topology"

\end_inset

 assicura che da ogni ricoprimento tramite insiemi aperti è possibile estrarre
 una sottocopertura finita.
 In particolare, 
\begin_inset Formula $\exists\delta\in\mathbb{N}^{+}$
\end_inset

 numero minimo di aperti con cui generare tale ricoprimento.
 La partizione di uno spazio è ricoprimento 
\emph on
minimale
\emph default

\begin_inset Foot
status open

\begin_layout Plain Layout
Nulla vieta di avere altri ricoprimenti perfettamente ridondanti, ma sempre
 con un numero finito di aperti
\end_layout

\end_inset

, motivo per cui il numero di atomi della partizione satura la disuguaglianza
 del teorema, 
\begin_inset Formula $\delta=n$
\end_inset

.
 Una volta stabilito l'esistenza di 
\begin_inset Formula $\delta$
\end_inset

 e avendone calcolato il risultato, poniamo l'entropia topologica pari al
 logaritmo naturale di 
\begin_inset Formula $\delta$
\end_inset

 
\begin_inset Formula 
\begin{equation}
H_{T}(\alpha)=\ln(\delta)=\ln(n)
\end{equation}

\end_inset

 
\end_layout

\begin_layout Standard
Nei casi in cui non vi sia una naturale misura sullo spazio 
\begin_inset Formula $\mathbf{M}$
\end_inset

, la definizione topologica può essere utile per cercare una distanza che
 meglio renda la differenza intrinseca tra partizioni.
 Tuttavia, non esiste una definizione di entropia condizionale per 
\begin_inset Formula $H_{T}$
\end_inset

 e per definire la distanza di Rohlin utilizziamo la sua definizione in
 termini di prodotto tra partizioni.
\end_layout

\begin_layout Standard
Si vede come 
\begin_inset Formula $H_{T}$
\end_inset

 è un buon funzionale entropia, infatti se 
\begin_inset Formula $\alpha<\beta$
\end_inset

, allora 
\begin_inset Formula $H_{T}(\alpha)<H_{T}(\beta)$
\end_inset

, in quanto una partizione strettamente più fine ha banalmente un numero
 maggiore di atomi.
 Da questa condizione si ha che per il prodotto 
\begin_inset Formula 
\[
\alpha\vee\beta\geq\alpha\implies H_{T}(\alpha\vee\beta)\geq H_{T}(\alpha)
\]

\end_inset

 per 
\begin_inset Formula $\alpha,\beta$
\end_inset

 generici e la distanza di Rohlin topologica, definita usando il funzionale
 
\begin_inset Formula $H_{T}$
\end_inset

 nell'equazione 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:distanza_rohlin"

\end_inset

 risulta definita positiva.
 Notiamo che la distanza è ben definita solo quando si considera partizioni
 poiché la distanza tra ricoprimenti non minimali può non essere 0 anche
 tra ricoprimenti diversi -- ha senso solo considerare la restrizione alla
 classe di equivalenza del ricoprimento minimale corrispondente.
\end_layout

\begin_layout Section
Riduzione
\end_layout

\begin_layout Standard
L'essenziale dissimilarità tra due partizioni potrebbe essere confusa ed
 indebolita dalla presenza di un fattore comune ampio, come ad esempio accade
 se gli atomi della partizione hanno lunghezza media molto breve, nel qual
 caso la maggioranza dei confini risulta essere la stessa.
 Si cerca quindi di eliminare fattori comuni il più possibile, con una 
\emph on
riduzione
\emph default
 che ci si aspetta aumenti la distanza relativa.
 Tuttavia questa operazione, analoga alla riduzione in minimi termini per
 frazioni, non è unicamente definita, in quanto le partizioni, a differenza
 degli interi, non ammettono una univoca fattorizzazione in fattori primi.
 Il ruolo dei fattori primi (ovvero fattori irriducibili) è giocato dalle
 sottopartizioni 
\emph on
dicotomiche,
\emph default
 che sono tuttavia ancora estremamente ridondanti (
\begin_inset Formula $2^{n-1}-1$
\end_inset

 per partizioni con 
\begin_inset Formula $n$
\end_inset

 atomi).
\end_layout

\begin_layout Standard
A partire dalla partizione 
\begin_inset Formula $\alpha\equiv(A_{1},\dots,A_{n})$
\end_inset

, definiamo quindi una famiglia ristretta 
\begin_inset Formula $\mathbf{E}(\alpha)$
\end_inset

 di 
\emph on
fattori dicotomici elementari 
\emph default

\begin_inset Formula $\tilde{\alpha}_{1},\tilde{\alpha}_{2},\dots,\tilde{\alpha}_{n}$
\end_inset

 con le seguenti caratteristiche:
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\mathbf{E}(\alpha)$
\end_inset

 deve essere ben definita per ogni 
\begin_inset Formula $\alpha\in\mathcal{Z}$
\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula $\mathbf{E}(\alpha)$
\end_inset

 non deve contenere più di 
\begin_inset Formula $n$
\end_inset

 (il numero di atomi in 
\begin_inset Formula $\alpha$
\end_inset

) fattori elementari
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\vee_{k=1}^{n}\tilde{a}_{k}=\alpha$
\end_inset


\end_layout

\begin_layout Standard
Una scelta universale consiste nel prendere come fattori dicotomici 
\begin_inset Formula $\tilde{\alpha}_{k}\equiv(A_{k},A_{k}^{c})$
\end_inset

 le partizioni formate dai singoli atomi e dai loro complementi in 
\begin_inset Formula $\mathbf{M}$
\end_inset

.
 Fattori di questo tipo sono chiamati 
\emph on
universali semplici
\emph default
.
\end_layout

\begin_layout Standard
Una volta che per due partizioni 
\begin_inset Formula $\alpha$
\end_inset

 e 
\begin_inset Formula $\beta$
\end_inset

 le famiglie di fattori dicotomici 
\begin_inset Formula $\mathbf{E}(\alpha)$
\end_inset

 e 
\begin_inset Formula $\mathbf{E}(\beta)$
\end_inset

 sono state definite, abbiamo diversi possibili processi di riduzione.
\end_layout

\begin_layout Definition
\begin_inset CommandInset label
LatexCommand label
name "criteri-riduzione"

\end_inset

Riduzione tramite partizione comune
\end_layout

\begin_layout Enumerate
Si definisce il massimo fattore comune 
\begin_inset Formula $\sigma=\alpha\wedge\beta$
\end_inset


\end_layout

\begin_layout Enumerate
Si tralasciano da 
\begin_inset Formula $\mathbf{E}(\alpha)$
\end_inset

 e 
\begin_inset Formula $\mathbf{E}(\beta)$
\end_inset

 i fattori che 
\series bold
non
\series default
 sono relativamente primi con 
\begin_inset Formula $\sigma,$
\end_inset

 e indichiamo i fattori rimanenti come 
\begin_inset Formula $\hat{\alpha}_{k}$
\end_inset

 e 
\begin_inset Formula $\hat{\beta}_{k}$
\end_inset

 rispettivamente.
 Questo vuol dire che 
\begin_inset Formula $\hat{\alpha}_{k}\wedge\sigma=\hat{\beta}_{j}\wedge\sigma=\nu$
\end_inset

.
\end_layout

\begin_layout Definition
Riduzione con eliminazione fattori in comune
\end_layout

\begin_layout Enumerate
Si tralasciano da 
\begin_inset Formula $\mathbf{E}(\alpha)$
\end_inset

 e 
\begin_inset Formula $\mathbf{E}(\beta)$
\end_inset

 i fattori che compaiono in entrambe le partizioni.
 Se indichiamo i fattori rimanenti come 
\begin_inset Formula $\hat{\alpha}_{k}$
\end_inset

 e 
\begin_inset Formula $\hat{\beta}_{k}$
\end_inset

 rispettivamente, questo vuol dire che 
\begin_inset Formula $\forall A_{k},\;\nexists B_{j}\in\beta|A_{k}=B_{j}$
\end_inset

 e viceversa.
\end_layout

\begin_layout Definition
Riduzione con eliminazione fattori simili
\end_layout

\begin_layout Enumerate
Si tralasciano da 
\begin_inset Formula $\mathbf{E}(\alpha)$
\end_inset

 e 
\begin_inset Formula $\mathbf{E}(\beta)$
\end_inset

 i fattori che hanno un corrispondente 
\begin_inset Quotes eld
\end_inset

simile
\begin_inset Quotes erd
\end_inset

 nell'altra partizione.
 Questo vuol dire che scartiamo da 
\begin_inset Formula $\hat{\alpha}$
\end_inset

 il fattore
\begin_inset Formula 
\[
A_{k}\text{ se }\exists\ B_{j}\in\beta,\;\text{tale che }\mu(A_{k}\bigtriangleup B_{j})\leq\epsilon
\]

\end_inset

 e viceversa da 
\begin_inset Formula $\hat{\beta}$
\end_inset

 il fattore 
\begin_inset Formula 
\[
\beta_{k}\text{ se }\exists\ A_{j}\in\alpha,\;\text{tale che }\mu(B_{k}\bigtriangleup A_{j})\leq\epsilon
\]

\end_inset

Il simbolo 
\begin_inset Formula $A_{k}\bigtriangleup B_{j}$
\end_inset

 indica la differenza simmetrica tra i due atomi, ovvero i siti che appartengono
 ad un atomo ma non all'altro.
\end_layout

\begin_layout Standard
Alla fine, per tutti i tipi di riduzione, definiamo le partizioni ridotte
 come 
\begin_inset Formula $\hat{\alpha}=\vee_{k}\hat{\alpha}_{k}$
\end_inset

 e 
\begin_inset Formula $\hat{\beta}=\vee_{k}\hat{\beta}_{k}$
\end_inset

, ovvero il prodotto dei fattori dicotomici 
\begin_inset Quotes eld
\end_inset

sopravvissuti
\begin_inset Quotes erd
\end_inset

.
 Nel capitolo sugli algoritmi presenteremo metodi ottimali per il calcolo
 dei fattori dicotomici per ogni criterio presentato, che presentano una
 notevole complessità se eseguiti nel modo naïve.
\end_layout

\begin_layout Standard
Per il resto della sezione concentreremo la nostra attenzione sulla riduzione
 tramite fattore comune massimo.
 Si motiva la scelta del confronto con il fattore comune poiché vi sono
 casi in cui le partizioni non hanno atomi in comune, ma ciononostante si
 ha che 
\begin_inset Formula $\sigma\neq\nu$
\end_inset

.
 Questo accade, per esempio, quando 
\begin_inset Formula $\alpha<\beta$
\end_inset

 strettamente e non vi sono fattori comuni elementari.
 In questo caso allora 
\begin_inset Formula $\sigma=\alpha$
\end_inset

 e 
\begin_inset Formula $\hat{\alpha}=\nu$
\end_inset

 con questo metodo di riduzione, mentre 
\begin_inset Formula $\hat{\alpha}=\alpha$
\end_inset

 tralasciando i fattori comuni.
 Può capitare inoltre che anche se le partizioni sono già ridotte, non sono
 prime tra di loro.
 In particolare, 
\begin_inset Formula $H(\sigma)$
\end_inset

 indica la similarità tra le partizioni.
 
\end_layout

\begin_layout Paragraph
Osservazione
\end_layout

\begin_layout Standard
La mappa simmetrica definita dalla distanza tra sequenze ridotte 
\begin_inset Formula 
\begin{align*}
\mathcal{Z}\times\mathcal{Z} & \to\mathbb{R}\\
\alpha\otimes\beta & \mapsto d_{R}(\hat{\alpha},\hat{\beta})
\end{align*}

\end_inset

non definisce una distanza su 
\begin_inset Formula $\mathcal{Z}$
\end_inset

.
 Infatti il passaggio 
\begin_inset Formula $\alpha\to\hat{\alpha}$
\end_inset

 dipende strettamente da 
\begin_inset Formula $\beta$
\end_inset

 e viceversa, non è quindi possibile scrivere 
\begin_inset Formula 
\[
d_{R}(\hat{\alpha},\hat{\beta})=\hat{d}_{R}(\alpha,\beta)
\]

\end_inset

 con 
\begin_inset Formula $\hat{d}_{R}$
\end_inset

 una distanza.
\end_layout

\begin_layout Subsection
Amplificazione
\end_layout

\begin_layout Standard
Il processo di riduzione porta alla definizione di partizioni con complessità
 possibilmente inferiore, ovvero 
\begin_inset Formula $H(\hat{\alpha})\leq H(\alpha)$
\end_inset

.
 Questo va nel verso opposto quando si considera l'effetto sulla distanza,
 che invece aumenta.
\end_layout

\begin_layout Standard
Il rapporto di 
\emph on
amplificazione
\emph default
 R misura quanto la riduzione ha messo in risalto la differenza tra partizioni.
 Ne dimostriamo la caratteristica fondamentale: 
\begin_inset Formula 
\[
\mathrm{R=\frac{d_{R}(\hat{\alpha},\hat{\beta})}{d_{\mathrm{R}}(\alpha,\beta)}}\geq1
\]

\end_inset


\end_layout

\begin_layout Proposition*
\begin_inset Formula $d_{\mathrm{R}}(\hat{\alpha},\hat{\beta})\geq d_{\mathrm{R}}(\alpha,\beta)$
\end_inset


\end_layout

\begin_layout Proof
Ricordando che 
\begin_inset Formula $\sigma=\alpha\wedge\beta$
\end_inset

 possiamo scrivere 
\begin_inset Formula $\alpha=\sigma\hat{\alpha}$
\end_inset

 e 
\begin_inset Formula $\beta=\sigma\hat{\beta}$
\end_inset

: infatti 
\begin_inset Formula $\sigma$
\end_inset

 contiene tutti i fattori tralasciati durante la riduzione.
 Utilizzando ora l'idempotenza del prodotto, 
\begin_inset Formula $\sigma=\sigma\sigma$
\end_inset

, possiamo riscrivere la tesi utilizzando l'equazione 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:distanza_rohlin"

\end_inset

 
\begin_inset Formula 
\[
2\, H(\sigma\hat{\alpha}\hat{\beta})-H(\sigma\hat{\alpha})-H(\sigma\hat{\beta})\leq2\, H(\hat{\alpha}\hat{\beta})-H(\hat{\alpha})-H(\hat{\beta})
\]

\end_inset

scambiando l'ordine dei termini si ottiene
\begin_inset Formula 
\[
2\, H(\sigma\hat{\alpha}\hat{\beta})-2\, H(\hat{\alpha}\hat{\beta})\leq H(\sigma\hat{\alpha})-H(\hat{\alpha})+H(\sigma\hat{\beta})-H(\hat{\beta})
\]

\end_inset

e sfruttando la formula 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:entropia_condizionata"

\end_inset

 per l'entropia condizionata, la tesi si riduce a
\begin_inset Formula 
\[
2\, H(\sigma|\hat{\alpha}\hat{\beta})\leq H(\sigma|\hat{\alpha})+H(\sigma|\hat{\beta})
\]

\end_inset

ma questo è chiaramente vero, in quanto
\begin_inset Formula 
\[
H(\sigma|\hat{\alpha}\hat{\beta})\leq H(\sigma|\hat{\alpha})\quad\text{e\quad}H(\sigma|\hat{\alpha}\hat{\beta})\leq H(\sigma|\hat{\beta})
\]

\end_inset

per le proprietà dell'entropia, poiché il termine condizionante è sicuramente
 maggiore, ovvero 
\begin_inset Formula 
\[
\hat{\alpha}\hat{\beta}\geq\hat{\alpha}\quad\text{e}\quad\hat{\alpha}\hat{\beta}\geq\hat{\beta}
\]

\end_inset


\end_layout

\begin_layout Standard
Da notare che la dimostrazione vale per la distanza di Rohlin definita sia
 tramite 
\begin_inset Formula $H_{S}$
\end_inset

 che 
\begin_inset Formula $H_{T}$
\end_inset

.
\end_layout

\begin_layout Standard
Risulta importante la scelta della famiglia di fattori dicotomici 
\begin_inset Formula $\mathbf{E}(\alpha)$
\end_inset

, che è dettata dalla topologia e geometria dello spazio delle configurazioni.
 La scelta della famiglia di fattori dicotomici universali semplici è sempre
 possibile, poiché la determinazione di 
\begin_inset Formula $A_{k}^{c}$
\end_inset

 a partire da 
\begin_inset Formula $A_{k}$
\end_inset

 è un'operazione ben definita in qualunque spazio topologico.
 Prendere come fattori elementari la parte interna di contorni di cluster
 ad esempio, richiede un concetto di orientabilità e la possibilità di definire
 contorni, ovvero insiemi con codimensione 1 su varietà -- mentre vorremmo
 estendere l'analisi anche a grafi generici, privi di strutture geometriche
 predefinite.
 Già nel caso lineare è possibile prendere fattori dicotomici diversi e
 algoritmicamente più performanti, a patto di restringere lo studio alle
 partizioni con atomi formati da cluster connessi.
\end_layout

\begin_layout Section
Possibili tipi di partizionamento
\end_layout

\begin_layout Standard
L'applicabilità dei metodi discussi è assolutamente generica, estendibile
 a qualunque spazio di probabilità finito si voglia considerare, vediamo
 dunque di dare esempi dei possibili spazi 
\begin_inset Formula $\mathbf{M}$
\end_inset

 su cui abbiamo lavorato, con i relativi fattori dicotomici e conseguenze
 computazionali.
\end_layout

\begin_layout Standard
Essendo lo studio svolto su calcolatore, lo spazio 
\begin_inset Formula $\mathbf{M}$
\end_inset

 e la sua 
\begin_inset Formula $\sigma-$
\end_inset

algebra sono finiti e discreti.
 I siti appartenenti ad 
\begin_inset Formula $\mathbf{M}$
\end_inset

 possono essere sempre numerati ordinati in modo opportuno 
\begin_inset Formula $x_{i},\, i\in\{1,\dots,L\}$
\end_inset

, dove 
\begin_inset Formula $L$
\end_inset

 è il numero totale di siti, che si tratti di un reticolo o di un grafo.
 Poiché la partizione induce una relazione di equivalenza sull'insieme 
\begin_inset Formula $\mathbf{M}$
\end_inset

, indichiamo che due siti sono equivalenti se appartengono allo stesso atomo
\begin_inset Formula 
\[
i\sim j\iff\exists A_{k}\;\textrm{tale che}\; i\in A_{k},\; j\in A_{k}
\]

\end_inset


\end_layout

\begin_layout Standard
Per partizionare i siti in atomi disgiunti, richiediamo che la 
\emph on
configurazione
\emph default
 (o 
\emph on
stato
\emph default
) 
\begin_inset Formula $\mathcal{C}$
\end_inset

, associ ad ogni sito una lettera dell'alfabeto 
\begin_inset Formula $\mathbb{K}$
\end_inset

, considerato finito, 
\begin_inset Formula $|\mathbb{K}|<\infty$
\end_inset

.
 Il simbolo associato al sito 
\begin_inset Formula $i$
\end_inset

-esimo, non essendovi ambiguità, sarà d'ora in poi indicato con 
\begin_inset Formula $f(i)$
\end_inset

.
 Se lo stato del sistema è descritto con variabili continue (o vi è un numero
 enorme di possibili lettere nell'alfabeto, si pensi ad una variabile a
 64 bit rappresentante un numero reale), si può sempre ridurre l'alfabeto
 ad un insieme 
\begin_inset Formula $\{k_{j}\}$
\end_inset

 discretizzando i valori della configurazione con il criterio: 
\begin_inset Formula 
\[
f(i):=\bar{k}\quad\text{tale che}\quad|f(i-\bar{k})|=\min_{k_{j}\in\mathbb{K}}|f(i)-k_{j}|
\]

\end_inset

oppure mettendo nello stesso atomo siti vicini che hanno valori distanti
 meno di 
\emph on

\begin_inset Formula $\epsilon$
\end_inset


\emph default
: 
\begin_inset Formula 
\[
i\sim j\iff|f(i)-f(j)|\leq\epsilon
\]

\end_inset


\end_layout

\begin_layout Subsection
Sequenze lineari connesse
\end_layout

\begin_layout Standard
Consideriamo sequenze lunghe 
\begin_inset Formula $L$
\end_inset

, provenienti da due casi:
\end_layout

\begin_layout Itemize
Problemi di meccanica statistica, in cui la configurazione è una variabile
 aleatoria, generata algoritmicamente da una catena di Markov in base al
 modello di Ising monodimensionale, nel qual caso l'alfabeto corrisponde
 a 
\begin_inset Formula $\{-1,+1\}$
\end_inset

.
 
\end_layout

\begin_layout Itemize
Sequenze di origine biologica, in particolare sequenze di amminoacidi (proteine)
, in cui 
\begin_inset Formula $|\mathbb{K}|=25$
\end_inset

 (dettagli a pagina 
\begin_inset CommandInset ref
LatexCommand pageref
reference "tab:tabella_ambiguita"

\end_inset

)
\end_layout

\begin_layout Standard
La distanza di Hamming 
\begin_inset Formula $d_{H}$
\end_inset

 è sensibile solo a variazioni puntuali dei valori in 
\begin_inset Formula $\mathcal{C}$
\end_inset

.
 I siti che compongono la sequenze non si influenzano, una variazione su
 un sito può solo variare di 
\begin_inset Formula $\{0,+1\}$
\end_inset

 la distanza totale.
\end_layout

\begin_layout Standard
Ad ogni configurazione possiamo associare una partizione in 
\begin_inset Formula $\mathcal{Z}$
\end_inset

, in cui gli atomi sono formati dai cluster, cioè sottoinsiemi connessi
 di 
\begin_inset Formula $\mathbf{M}$
\end_inset

 a valori omogenei in 
\begin_inset Formula $\mathbb{K}$
\end_inset

.
 Questo stabilisce una mappa 
\begin_inset Formula $\Phi:\mathcal{C}\rightarrow\mathcal{Z}$
\end_inset

 da ogni configurazione ad una partizione corrispondente, rendendo possibile
 il confronto tra 
\begin_inset Formula $d_{\mathrm{H}}(\mathbf{a,b})$
\end_inset

 in 
\begin_inset Formula $\mathcal{C}$
\end_inset

 e 
\begin_inset Formula $d_{\mathrm{R}}(\alpha,\beta)$
\end_inset

 in 
\begin_inset Formula $\mathcal{Z}$
\end_inset

, dove 
\begin_inset Formula $\alpha=\Phi(\mathbf{a})$
\end_inset

 e 
\begin_inset Formula $\beta=\Phi(\mathbf{b})$
\end_inset

.
 La relazione è chiaramente del tipo molti-a-uno, infatti assegnando ad
 un segmento di lettere omogeneo in 
\begin_inset Formula $\mathcal{C}$
\end_inset

 un diverso simbolo, non cambia la partizione corrispondente.
 In simboli, esprimiamo la relazione come
\begin_inset Formula 
\[
i\sim j\iff j=i+1,\; f(i)=f(j)
\]

\end_inset


\end_layout

\begin_layout Standard
È evidente quindi che variazioni locali, ad esempio il cambiamento di un
 singolo simbolo, possono non modificare affatto la partizione
\begin_inset Formula 
\[
\{\dots,T,T,C,A,A,\dots\}\overset{\Phi}{\equiv}\{\dots,T,T,M,A,A,\dots\}
\]

\end_inset

che presenta sì una perdita di informazione, ma permette quindi anche di
 filtrare molto 
\begin_inset Quotes eld
\end_inset

rumore
\begin_inset Quotes erd
\end_inset

 e si è dimostrata una ottima scelta nel caso biologico e una necessità
 nello studio di sequenze di Ising -- la hamiltoniana del sistema non distingue
 i valori associati ai singoli siti, ma solo differenze tra siti vicini.
 La suddivisione in partizioni si comporta nello stesso modo, estraendo
 quindi solo informazioni fisicamente rilevanti.
 
\end_layout

\begin_layout Example*
Supponiamo di aver partizionato una stringa come {A,A,A,B,B,C,C,D,D,D} o
 
\begin_inset Formula $\{+,+,+,-,-,+,+,-,-,-\}$
\end_inset

,
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
\begin_inset Formula $\{+1,+1,+1,-1,-1,+1,+1,-1,-1,-1\}$
\end_inset


\end_layout

\end_inset

 aventi la stessa partizione 
\begin_inset Formula 
\[
\alpha=\{(1,2,3),(4,5),(6,7),(8,9,10)\}
\]

\end_inset

il calcolo esplicito dell'entropia è il seguente:
\end_layout

\begin_layout Example*
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{align*} 
\end_layout

\begin_layout Plain Layout

A_{1}= & (1,2,3)&
\backslash
mu(A_1)=
\backslash
frac{3}{10}
\backslash

\backslash
 
\end_layout

\begin_layout Plain Layout

A_{2}= & (4,5)&
\backslash
mu(A_2)=
\backslash
frac{2}{10}
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

A_{3}= & (6,7)&
\backslash
mu(A_3)=
\backslash
frac{2}{10}
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

A_{4}= & (8,9,10)&
\backslash
mu(A_4)=
\backslash
frac{3}{10}
\end_layout

\begin_layout Plain Layout


\backslash
end{align*}
\end_layout

\end_inset

Ora, 
\begin_inset Formula $H_{\mathrm{S}}(\alpha)=-2\:(0.3)\ln(0.3)-2\,(0.2)\ln(0.2)\simeq1.36$
\end_inset

, mentre 
\begin_inset Formula $H_{\mathrm{T}}(\alpha)=\ln(4)\simeq1.38$
\end_inset

.
 Come si vede i valori sono abbastanza simili.
\end_layout

\begin_layout Subsubsection*
Fattori dicotomici nel caso lineare connesso
\end_layout

\begin_layout Standard
Per una partizione 
\begin_inset Formula $\alpha\equiv(A_{1},\dots,A_{n})$
\end_inset

, definiamo i fattori dicotomici 
\begin_inset Formula $\tilde{\alpha}_{1},\tilde{\alpha}_{2},\dots,\tilde{\alpha}_{n}\in\mathbf{E}(\alpha)$
\end_inset

 nel modo seguente:
\begin_inset Formula 
\[
\tilde{\alpha}_{k}=\left\{ \bigcup_{j=1}^{k}A_{j},\bigcup_{j=k+1}^{n}A_{j}\right\} 
\]

\end_inset


\end_layout

\begin_layout Standard
dove ricordiamo che 
\begin_inset Formula $n$
\end_inset

 è il numero di atomi.
 In termini di siti quindi, il fattore dicotomico 
\begin_inset Formula $k$
\end_inset

-esimo corrisponde alla partizione con tutti i siti corrispondenti ai primi
 
\begin_inset Formula $k$
\end_inset

 atomi presi insieme, ed il complementare corrispondente ai siti a partire
 dall'atomo 
\begin_inset Formula $(k+1)$
\end_inset

-esimo fino ad 
\begin_inset Formula $L$
\end_inset

, come mostrato in figura 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Fattori-dicotomici-lineari"

\end_inset

.
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/riduzione_lineare3.png
	width 7cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Fattori dicotomici lineari
\begin_inset CommandInset label
LatexCommand label
name "fig:Fattori-dicotomici-lineari"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Con questa particolare scelta, resa possibile dalla topologia connessa e
 ordinata, poiché abbiamo l'ordine ereditato da 
\begin_inset Formula $\mathbb{N}$
\end_inset

, il processo di riduzione è estremamente semplificato ed efficiente.
 Partendo da una partizione 
\begin_inset Formula $\alpha$
\end_inset

, la partizione ridotta 
\begin_inset Formula $\hat{\alpha}$
\end_inset

 è quella in cui sono stati rimossi i bordi in comune tra 
\begin_inset Formula $\alpha$
\end_inset

 e 
\begin_inset Formula $\sigma$
\end_inset

, come si vede in figura 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Riduzione-lineare"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/riduzione_lineare2.png
	width 7cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Riduzione nel caso di sequenze lineari.
 La riga spessa indica la separazione tra atomi.
 Si nota come i bordi della partizione comune siano quelli comuni sia ad
 
\begin_inset Formula $\alpha$
\end_inset

 che a 
\begin_inset Formula $\beta$
\end_inset

, mentre nelle partizioni ridotte non compaiono più i bordi esistenti anche
 in 
\begin_inset Formula $\sigma$
\end_inset

 
\begin_inset CommandInset label
LatexCommand label
name "fig:Riduzione-lineare"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Sequenze non connesse
\end_layout

\begin_layout Standard
Lo studio delle sequenze biologiche, in cui vi è una notevole frammentazione,
 dovuta alla bassa probabilità di avere molti simboli consecutivi uguali,
 ha motivato la ricerca di diversi criteri di partizionamento.
 Il più semplice è considerare come appartenenti allo stesso atomo siti
 con lo stesso simbolo, non adiacenti ma con la possibilità di saltare al
 massimo 
\begin_inset Formula $n_{s}$
\end_inset

 siti in avanti 
\begin_inset Formula 
\[
i\sim j\iff|j-i|\leq n_{s},\; f(i)=f(j)
\]

\end_inset


\end_layout

\begin_layout Standard
In questo caso, la topologia nello spazio 
\begin_inset Formula $\mathcal{Z}$
\end_inset

 non è più connessa, per cui l'utilizzo dei fattori dicomici lineari non
 è possibile.
 Un'alternativa è quella di prendere per l'atomo 
\begin_inset Formula $A_{k}=\{n_{k_{1}},n_{k_{2}},\dots,n_{k_{n}}\}$
\end_inset

 una partizione dicotomica costituita da tutti i siti tra il primo e l'ultimo
 appartenente a 
\begin_inset Formula $A_{k}$
\end_inset

 e dal complementare, sconnesso, 
\begin_inset Formula $A_{k}^{c}$
\end_inset


\begin_inset Formula 
\[
\hat{\alpha}_{k}=\left\{ \bigcup_{i=n_{k_{1}}}^{n_{k_{n}}}n_{i},\left(\bigcup_{i<n_{k_{1}}}n_{i}\right)\bigcup\left(\bigcup_{i>n_{k_{n}}}n_{i}\right)\right\} 
\]

\end_inset

Dati gli scarsi vantaggi di questo approccio, si è scelto tuttavia anche
 in questo caso di utilizzare i 
\emph on
fattori universali semplici.
 
\emph default
Una volta venuta a meno la connessione degli atomi, questo tipo di partizionamen
to presenta le complessità e caratteristiche di un criterio arbitrario su
 grafo generico -- si veda il prossimo paragrafo per le illustrazioni delle
 operazioni tra partizioni di questo tipo.
\end_layout

\begin_layout Subsection
Sequenze su reticoli
\end_layout

\begin_layout Standard
In questo caso, si considera le partizioni in cui fanno parte dello stesso
 atomo siti con lo stesso simbolo, ma con il vincolo che devono essere 
\emph on
primi vicini 
\emph default
sul reticolo
\begin_inset Formula 
\[
i\sim j\iff d(i,j)=1,\; f(i)=f(j)
\]

\end_inset


\end_layout

\begin_layout Standard
dove la distanza indica il numero di passi sul reticolo.
 Possiamo tuttavia generalizzare arbitrariamente la condizione di vicinanza,
 per includere secondi vicini, siti con lo stesso simbolo arbitrariamente
 posti, ecc.
 
\end_layout

\begin_layout Standard
Illustriamo le possibili operazioni con un reticolo bidimensionale, che
 tuttavia generalizza immediatamente al grafo arbitrario.
 In particolare numeriamo anche in questo caso i siti, cosa necessaria per
 mappare nella memoria di un computer la configurazione.
 La mappatura in memoria (figura 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Ordinamento-reticolo"

\end_inset

) comporta necessariamente la disposizione di siti 
\begin_inset Quotes eld
\end_inset

vicini
\begin_inset Quotes erd
\end_inset

 sul reticolo su posizioni in cui non risultano più contigue in memoria
\begin_inset Foot
status open

\begin_layout Plain Layout
Ricordiamo la convenzione 
\begin_inset Quotes eld
\end_inset

per colonne
\begin_inset Quotes erd
\end_inset

 di rappresentazione di una matrice bidimensionale nella maggior parte dei
 linguaggi di programmazione, a partire dal Fortran in poi
\end_layout

\end_inset

.
 Nel caso della figura la partizione corrispondente è 
\begin_inset Formula 
\[
A=\{(1,4,5,6,8,9),(2,4),(7)\}
\]

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/ordinamento_reticolo.png
	width 4cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Mappa in memoria di un reticolo bidimensionale.
 In grigio e bianco sono evidenziati i valori dalla configurazione, mentre
 i numeri nell'angolo rappresentano l'ordine dei siti.
\begin_inset CommandInset label
LatexCommand label
name "fig:Ordinamento-reticolo"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset

evidentemente non-connessa.
 In questo caso i fattori dicotomici anche risultano sconnessi, come nell'esempi
o di un reticolo 3x3 in figura 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Fattori-dicotomici-generici"

\end_inset

, in cui si è preso come atomi i siti con lo stesso valore indipendentemente
 dalla loro posizione.
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/fattori_dicotomici_quadrato.png
	width 80col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Partizione con 4 atomi e i 4 fattori dicotomici universali semplici corrisponden
ti.
 I numeri indicano l'etichetta corrispondente ad ogni atomo, scelto arbitrariame
nte.
 Gli atomi sono del tipo nonconnesso, in cui le etichette indicano l'appartenenz
a; similmente i fattori dicotomici contengono gli atomi sconnessi ed il
 loro complementare indicato dal label tildato.
\begin_inset CommandInset label
LatexCommand label
name "fig:Fattori-dicotomici-generici"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Nel caso in cui gli atomi sconnessi il prodotto tra partizioni rimane banale
 da implementare mentre l'intersezione è estremamente complicata -- un'implement
azione ottimale è data nel capitolo sugli algoritmi.
\end_layout

\begin_layout Subsection
Grafi arbitrari
\end_layout

\begin_layout Standard
L'insieme dei siti in questo caso è sempre ordinabile con 
\begin_inset Formula $i\in\{1,\dots,L\}$
\end_inset

.
 Definiamo la 
\emph on
matrice di adiacenza
\emph default
 
\begin_inset Formula $A_{ij}$
\end_inset

 
\begin_inset Formula 
\[
A_{ij}=\begin{cases}
1 & \text{se i siti sono connessi}\\
0 & \text{altrimenti}
\end{cases}
\]

\end_inset

che ci permette di dare la relazione di equivalenza come 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
i\sim j\iff A(i,j)=1,\; f(i)=f(j)
\]

\end_inset


\end_layout

\begin_layout Standard
In questo modo ci si slega completamente da qualunque nozione di vicinanza
 geometrica.
 In linea di principio, è possibile rimuovere anche la condizione 
\begin_inset Formula $f(i)=f(j)$
\end_inset

, e lasciare alla matrice di adiacenza l'implementazione della relazione
 di equivalenza.
 Non vi sono condizioni da porre su 
\begin_inset Formula $A_{ij}$
\end_inset

, qualunque scelta è accettabile e va a modificare il partizionamento, senza
 che questo risulti mai incoerente.
\end_layout

\begin_layout Standard
\begin_inset Newpage cleardoublepage
\end_inset


\end_layout

\begin_layout Chapter
Algoritmi
\end_layout

\begin_layout Standard
Dopo aver visto i possibili tipi di partizione, mostriamo come calcolare
 qualunque quantità richiesta in modo ottimale.
 Definiamo prima le operazioni limitate a partizioni con atomi connessi,
 sia per la loro minore complessità, sia perché nel caso generico si sfrutta
 la riduzione al caso più semplice già trattato.
\begin_inset Note Note
status open

\begin_layout Plain Layout
Prendiamo come convenzione quella del C/C++/Python, iniziando gli array
 all'elemento 0.
\end_layout

\end_inset


\end_layout

\begin_layout Section
Partizioni connesse
\begin_inset CommandInset label
LatexCommand label
name "sec:Partizioni-connesse"

\end_inset

 
\end_layout

\begin_layout Standard
Nel caso monodimensionale è sufficiente identificare il 
\emph on
bordo sinistro
\emph default
 di ogni atomo, per ricostruire completamente la partizione.
 Partendo da una sequenza in un array (o segmento unidimensionale finito)
\family typewriter
 S[i]
\family default
 lungo 
\begin_inset Formula $L$
\end_inset

, definiamo l'array binario della partizione 
\family typewriter
B[i], 
\family default
lungo 
\begin_inset Formula $L$
\end_inset

, con indici che vanno da 
\family typewriter
0
\family default
 a 
\family typewriter
L-1
\family default

\begin_inset Formula 
\[
\mathtt{B[i]}=\begin{cases}
1 & \text{ il sito \mathtt{i}\text{ identifica un nuovo atomo}}\\
0 & \text{ altrimenti}
\end{cases}
\]

\end_inset

algoritmicamente si procede in due step:
\end_layout

\begin_layout Enumerate
il primo sito sicuramente inizia un atomo, quindi 
\family typewriter
B[0]=1;
\end_layout

\begin_layout Enumerate
iterando su 
\family typewriter
i, 
\family default
poniamo
\family typewriter
 B[i]= (S[i] != S[i-1]); 
\family default
infatti un nuovo atomo corrisponde ad un valore della sequenza 
\emph on
diverso
\emph default
 dal precedente
\end_layout

\begin_layout Standard
Ogni partizione espressa in termini binari ha sempre 1 come primo elemento.
\end_layout

\begin_layout Standard
Facendo un esempio, ad una stringa possiamo semplicemente far corrispondere
 l'array binario corrispondente
\end_layout

\begin_layout Standard
\align center

\family typewriter
S=AAAABBBAAAACCCDDDD
\begin_inset Newline newline
\end_inset

B=100010010001001000
\end_layout

\begin_layout Standard
Avendo un array che indica esattamente dove si trovano i bordi dei vari
 atomi, le operazioni di intersezione e prodotto sono immediate.
 Il prodotto corrisponde alla partizione che contiene i bordi di
\emph on
 
\emph default
entrambe le partizioni (OR binario); l'intersezione ha un bordo quando compare
 contemporaneamente nelle due partizioni (AND binario); il prodotto ridotto
 contiene invece ogni bordo di una e una sola delle partizioni (XOR binario)
 -- se il bordo appartiene ad entrambe, appartiene al fattore comune, che
 è stato ridotto.
\end_layout

\begin_layout Standard
In tabella 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:op-binarie"

\end_inset

 sono mostrate tutte le sequenze generabili a partire da due partizioni
 binarie 
\family typewriter
A
\series bold
 
\family default
\series default
e
\family typewriter
 B, 
\family default
con le rispettive entropie, che adesso mostriamo come calcolare.
\end_layout

\begin_layout Standard
\align center
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="5">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Vettore
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Risultato
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Codice C
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $H_{S}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $H_{T}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\alpha$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
10
\color red
11
\color inherit
000
\color red
11
\color inherit
00
\color red
11
\color inherit
0
\color red
11
\color inherit
0
\color red
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
A[]={1,0,1,1,...};
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.16
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.30
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\beta$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
1000
\color blue
1
\color inherit
00
\color blue
1
\color inherit
00
\color blue
11
\color inherit
00
\color blue
1
\color inherit
000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
B[]={1,0,0,0,...};
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.73
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.79
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\sigma=\alpha\wedge\beta$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
1000000
\color green
1
\color inherit
000
\color green
1
\color inherit
00
\color green
1
\color inherit
000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
C[i]=A[i] & B[i];
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.33
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.39
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\alpha\vee\beta$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
10
\color red
11
\color blue
1
\color inherit
00
\color blue
1
\color red
1
\color inherit
0
\color blue
11
\color red
1
\color inherit
0
\color blue
1
\color red
1
\color inherit
0
\color red
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
P[i]=A[i] | B[i];
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.40
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.49
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\hat{\alpha}\vee\hat{\beta}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
10
\color red
11
\color blue
1
\color inherit
00
\color green
0
\color red
1
\color inherit
0
\color blue
1
\color green
0
\color red
1
\color inherit
0
\color green
0
\color red
1
\color inherit
0
\color red
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
Prid[i]=A[i] ^ B[i];
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.09
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.19
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\hat{\alpha}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
10
\color red
11
\color inherit
000
\color green
0
\color red
1
\color inherit
00
\color green
0
\color red
1
\color inherit
0
\color green
0
\color red
1
\color inherit
0
\color red
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
Arid[i]=A[i] ^ C[i];
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.80
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.94
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\hat{\beta}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
1000
\color blue
1
\color inherit
00
\color green
0
\color inherit
00
\color blue
1
\color green
0
\color inherit
00
\color green
0
\color inherit
000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
Brid[i]=B[i] ^ C[i];
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.06
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.09
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Rappresentazione delle operazioni a partire da partizioni binarie.
 In rosso gli elementi riconducibili a partizioni di 
\begin_inset Formula $\alpha$
\end_inset

, in blu quelli dovuti a 
\begin_inset Formula $\beta$
\end_inset

, in verde gli elementi di 
\begin_inset Formula $\sigma$
\end_inset

.
 Nel prodotto si vede l'effetto sovrapposto di blu e rosso.
 Nelle partizioni ridotte in verde sono stati evidenziati gli zeri dovuti
 alla riduzione, ovvero in corrispondenza agli atomi (1 verdi) di 
\begin_inset Formula $\sigma$
\end_inset

.
\begin_inset CommandInset label
LatexCommand label
name "tab:op-binarie"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Entropia di una partizione binaria
\end_layout

\begin_layout Standard
Il calcolo più semplice è quello dell'entropia topologica, 
\begin_inset Formula $H_{T}$
\end_inset

.
 Avendo un vettore che indica esattamente l'inizio di ogni atomo, basta
 contare il numero di 1 presenti nel vettore e farne il logaritmo
\family typewriter

\begin_inset Foot
status open

\begin_layout Plain Layout
in Matlab è immediato:
\family typewriter
 Htop = log(sum(B));
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
Per l'entropia di Shannon 
\begin_inset Formula $H_{S}$
\end_inset

 la cosa è leggermente più complicata
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
In codice Matlab, si definisce prima 
\family typewriter
H=@(a) -sum(a.*log(a))/sum(a) +log(sum(a));
\begin_inset Newline newline
\end_inset


\family default
Avendo il vettore binario A, l'entropia cercata è: 
\family typewriter
H(diff(find([A,1])));
\end_layout

\end_inset

:
\end_layout

\begin_layout Enumerate
si trovano tutte le posizioni 
\begin_inset Formula $i_{k}$
\end_inset

 degli 1 nel vettore dato
\end_layout

\begin_layout Enumerate
si fa la differenza degli interi cosi trovati, 
\begin_inset Formula $\mu_{k}=i_{k}-i_{k-1}$
\end_inset


\end_layout

\begin_layout Enumerate
l'insieme 
\begin_inset Formula $\{\mu_{k}\}$
\end_inset

 rappresenta le lunghezze degli atomi, ovvero gli intervalli tra 1 e l'ultimo
 0 (se esiste) dello stesso atomo
\end_layout

\begin_layout Standard
Per l'ultimo atomo ci vuole un trattamento speciale, 
\begin_inset Formula $\mu_{end}=\mathrm{L}-i_{end}$
\end_inset

, ovvero si calcola la differenza tra la lunghezza della sequenza e l'ultimo
 1 nel vettore.
 Il calcolo dell'entropia del vettore 
\begin_inset Formula $\{\mu_{m}\}=\{\mu_{k}\}\cup\mu_{end}$
\end_inset

 è molto semplice:
\begin_inset Formula 
\[
L=\sum_{m}\mu_{m}
\]

\end_inset


\begin_inset Formula 
\[
H=-\frac{\sum_{m}\mu_{m}\ln\mu_{m}}{L}+\ln L
\]

\end_inset


\end_layout

\begin_layout Standard
la formula utilizzata permette di non dover dividere ogni 
\begin_inset Formula $\mu_{k}$
\end_inset

 per 
\begin_inset Formula $L$
\end_inset

, e di eseguire un'unica divisione alla fine.
 L'utilizzo delle misure non normalizzate degli atomi consente anche di
 poter precalcolare tutti i logaritmi necessari, in quanto 
\begin_inset Formula $0\leq\mu_{k}\leq L$
\end_inset

, migliorando la velocità di esecuzione della routine del 600%.
\end_layout

\begin_layout Standard
L'algoritmo presenta complessità 
\begin_inset Formula $\mathcal{O}(L)$
\end_inset

 in quanto si scorre l'array completo, anche se una volta sola: chiaramente
 non si può far di meglio.
\end_layout

\begin_layout Subsection
Distanza di Rohlin
\end_layout

\begin_layout Standard
Una volta che si è in grado di fare il prodotto, la riduzione e il calcolo
 dell'entropia, si può immediatamente calcolare la distanza di Rohlin.
 Per questo motivo è necessario calcolare anche le partizioni ridotte, che
 sono superflue per il calcolo del prodotto ridotto, ma nella distanza entrano
 in gioco le entropie dei fattori.
\end_layout

\begin_layout Standard
In tabella 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:distanze-binarie"

\end_inset

 mostriamo le 4 possibili distanze date le due partizioni binarie, sfruttando
 solamente i numeri calcolati nell'esempio precedente.
\end_layout

\begin_layout Standard
\align center
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Distanza
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Formula
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Valore
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
R
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Nonridotta, Shannon
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\lang english
\begin_inset Formula $2H_{S}(\alpha\vee\beta)-H_{S}(\alpha)-H_{S}(\beta)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.93
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ridotta, Shannon
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\lang english
\begin_inset Formula $2\, H_{S}(\hat{\alpha}\hat{\beta})-H_{S}(\hat{\alpha})-H_{S}(\hat{\beta})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.33
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.46
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Nonridotta, topologica
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2H_{T}(\alpha\vee\beta)-H_{T}(\alpha)-H_{T}(\beta)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.87
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ridotta, topologica
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\lang english
\begin_inset Formula $2\, H_{T}(\hat{\alpha}\hat{\beta})-H_{T}(\hat{\alpha})-H_{T}(\hat{\beta})$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.35
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.53
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Tutte le possibili distanze ricavate a partire dalla tabella 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:op-binarie"

\end_inset

, con relativo fattore di amplificazione
\begin_inset CommandInset label
LatexCommand label
name "tab:distanze-binarie"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Partizionamento generico
\begin_inset CommandInset label
LatexCommand label
name "sec:Partizionamento-generico"

\end_inset


\end_layout

\begin_layout Standard
Nel caso generico non basta indicare l'inizio di ogni atomo, poiché questi
 possono avere forma (e buchi) di ogni tipo.
 È necessario etichettare ogni sito con un numero naturale, indicando con
 
\begin_inset Formula $\lambda_{\alpha}(i)$
\end_inset

 l'etichetta corrispondente al sito 
\begin_inset Formula $i$
\end_inset

-esimo nella partizione 
\begin_inset Formula $\alpha$
\end_inset

.
 Ogni etichetta identifica l'atomo di appartenenza:
\begin_inset Formula 
\[
i\sim j\iff\lambda(i)=\lambda(j)
\]

\end_inset


\end_layout

\begin_layout Standard
Non si possono fare ipotesi sulla posizione relativa dei siti né sulle etichette
, che formano un vettore di lunghezza 
\begin_inset Formula $L$
\end_inset

.
 
\end_layout

\begin_layout Subsection
Struttura dei vicini
\end_layout

\begin_layout Standard
Abbiamo definito il criterio di partizionamento come una relazione di equivalenz
a 
\emph on
globale
\emph default
, che non dipende dalla relativa posizione dei singoli siti.
 In pratica, spesso andiamo a ricostruire la relazione a partire da equivalenze
 
\emph on
locali
\emph default
, definite tra siti 
\begin_inset Quotes eld
\end_inset

vicini
\begin_inset Quotes erd
\end_inset


\begin_inset Foot
status open

\begin_layout Plain Layout
Si intende qui nel senso più generale possibile, indipendentemente dalla
 posizione effettiva, ma legati da una qualunque relazione.
 Non vi è quindi alcuna perdita di generalità.
\end_layout

\end_inset

, mettendo nello stesso atomo siti 
\begin_inset Quotes eld
\end_inset

lontani
\begin_inset Quotes erd
\end_inset

 che sono equivalenti tra di loro tramite una sequenza di equivalenze locali.
\end_layout

\begin_layout Standard
Il metodo per partizionare una configurazione generica sullo spazio 
\begin_inset Formula $\mathbb{\mathbf{M}}$
\end_inset

 consiste nel raccogliere tutta l'informazione in una matrice dei vicini
 
\family typewriter
NNB
\family default
, concettualmente la versione ridotta (ad un numero opportuno di vicini)
 e 
\emph on
sparse
\emph default
 della matrice di adiacenza, per poi usare un algoritmo generale di clustering.
\end_layout

\begin_layout Standard
In linea di principio, il numero dei vicini per sito non è costante ---
 associamo un vettore di lunghezza variabile sito per sito, a seconda della
 geometria e configurazione.
 Per reticoli regolari chiaramente possiamo fissare il numero massimo dei
 vicini
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Una volta deciso di considerare solo i primi, i secondi, i terzi vicini
 o tutti i siti fino a distanza arbitraria questo è costante.
\end_layout

\end_inset

, per ottimizzare il codice, indicando eventualmente con un simbolo convenzional
e la fine del vettore (ad es.
 ci si ferma quando si trova -1).
 A seconda dell'input, possiamo distinguere vari casi:
\end_layout

\begin_layout Itemize
abbiamo in partenza la configurazione completa 
\begin_inset Formula $\mathcal{C}$
\end_inset

 su un reticolo regolare, consideriamo come collegati al sito 
\begin_inset Formula $i$
\end_inset

-simo tutti i primi vicini 
\begin_inset Formula $j$
\end_inset

 aventi lo stesso simbolo, cioè
\begin_inset Formula 
\[
d(i,j)=1,\; f(i)=f(j)
\]

\end_inset

e li aggiungiamo al vettore 
\family typewriter
NNB[i][k++]=j, 
\family default
dove 
\begin_inset Formula $i$
\end_inset

 indica la colonna, 
\begin_inset Formula $k$
\end_inset

 cresce con il numero di 
\begin_inset Formula $j$
\end_inset

 trovati.
 A questo caso appartiene ad esempio lo studio delle distanze tra reticoli
 con configurazioni di Ising: si considerano solo i primi vicini aventi
 lo stesso spin
\end_layout

\begin_layout Itemize
nel caso delle partizioni con salto, aggiungiamo a 
\family typewriter
NNB
\family default
 solo il primo sito distante meno di 
\begin_inset Formula $n_{s}$
\end_inset

 avente lo stesso simbolo, non serve collegare i più lontani (saranno già
 vicini del precedente)
\end_layout

\begin_layout Itemize
non guardiamo affatto le configurazioni, e i vicini sono dati interamente
 dalla matrice di adiacenza: 
\family typewriter
NNB[i]=nonzero(A[i])
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/griglia_simboli.png
	width 70text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Reticolo semplice con 
\begin_inset Formula $|\mathbb{K}|=2$
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:Reticolo-semplice-quadrato"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Il caso in cui associamo insieme tutti i simboli dello stesso tipo presenti
 sul grafo, non è più utile partizionare a partire dall'elenco dei vicini
\begin_inset Foot
status open

\begin_layout Plain Layout
I vicini sarebbero definiti dalla partizione una volta individuata.
\end_layout

\end_inset

.
 Si utilizza un diverso algoritmo, una variante del sort descritto a pagina
 
\begin_inset CommandInset ref
LatexCommand pageref
reference "sub:sort_entropy"

\end_inset

, per ottenere una configurazione in cui tutti i simboli uguali sono consecutivi.
\end_layout

\begin_layout Standard
Facciamo l'esempio del reticolo bidimensionale ai primi vicini, come si
 vede in figura 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Reticolo-semplice-quadrato"

\end_inset

.
 Scorrendo il reticolo in modo ordinato, dall'alto verso il basso, da sinistra
 verso destra, ovvero secondo la naturale disposizione dei siti in memoria,
 si vede che per allargare progressivamente (a macchia d'olio) le partizioni,
 è conveniente considerare i siti vicini già visitati.
 Per il sito 
\begin_inset Formula $i$
\end_inset

-esimo si guarda quindi il vicino in alto (
\emph on
nearest neighbour up
\emph default
, nnu) e quello a sinistra (
\emph on
nearest neighbour left
\emph default
, nnl).
 In figura 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Griglia-bond"

\end_inset

 sono disegnate le linee che collegano ciascun sito con il corrispettivo
 
\family typewriter
nnl
\family default
 e 
\family typewriter
nnu
\family default
.
 
\end_layout

\begin_layout Standard
In generale reticoli regolari di dimensione 
\begin_inset Formula $d$
\end_inset

 sono generati da 
\begin_inset Formula $d$
\end_inset

 vettori ad entrate intere: per controllare tutte le relazioni di vicinanza
 di ogni sito del reticolo è quindi sufficiente esaminare 
\begin_inset Formula $d$
\end_inset

 vicini per sito, invece del numero di coordinazione 
\begin_inset Formula $z=2d$
\end_inset

.
 Avere un collegamento tra due siti è una relazione simmetrica, per cui
 non è necessario controllare in entrambi i versi.
 Se invece considerassimo solo un sottoinsieme dello spazio 
\begin_inset Formula $\mathbb{\mathbf{M}}$
\end_inset

 per avere tutti i collegamenti bisogna effettivamente analizzare 
\begin_inset Formula $z$
\end_inset

 primi vicini.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/griglia_bond.png
	width 70text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Collegamento dei siti con stesso simbolo, solo tramite vicino up e vicino
 left, essendo sufficienti a completare tutti i collegamenti (condizioni
 al contorno nonperiodiche).
\begin_inset CommandInset label
LatexCommand label
name "fig:Griglia-bond"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Problem*
Qual è la struttura ottimale (minima) di vicini per riottenere la partizione
 data?
\end_layout

\begin_layout Problem*
Basta unire uno-per-uno i siti all'interno di ogni atomo.
 Ovvero ogni sito ha un solo vicino, il sito che lo precede facente parte
 dello stesso atomo (o se stesso, se è il primo o unico).
 Questo è chiaramente sufficiente per ottenere di nuovo la partizione, si
 può scrivere come un vettore lungo 
\begin_inset Formula $L$
\end_inset

, indipendentemente dalla geometria del sistema e dal numero effettivo di
 vicini: è un modo estremamente comodo ed efficiente di catturare le informazion
i a partire da 
\family typewriter
NNB
\family default
, necessarie per la riduzione, ma che possono occupare molto spazio in memoria.
 Denominiamo l'array contenente il vicino precedente come 
\family typewriter
previous[i]
\family default
.
\end_layout

\begin_layout Subsection
Partizionamento
\begin_inset CommandInset label
LatexCommand label
name "sub:Partizionamento"

\end_inset


\end_layout

\begin_layout Standard
Una volta completato l'elenco essenziale dei vicini, si procede al partizionamen
to.
 L'algoritmo è noto in letteratura come algoritmo di Hoshen-Kopelman
\begin_inset CommandInset citation
LatexCommand citep
key "Hoshen"

\end_inset

, di cui utilizziamo la versione ottimizzata da Mark Newman
\begin_inset CommandInset citation
LatexCommand citep
key "newman2001fast"

\end_inset

.
 Il problema trattato di 
\emph on
clustering
\emph default
 è equivalente a molti altri: bond-percolation, colorazione di grafo generico,
 ecc.
 
\end_layout

\begin_layout Standard
Per il procedimento si crea un array 
\family typewriter
labels[]
\family default
, lungo 
\begin_inset Formula $L$
\end_inset

, che alla fine dell'algoritmo è codificato nel seguente modo:
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000

\family typewriter
labels[i]<0 i
\family default
 è la 
\emph on
root
\emph default
 o 
\emph on
radice 
\emph default
del suo cluster, e 
\family typewriter
-labels[i]
\family default
 rappresenta la dimensione del cluster -- ovvero quanti siti vi appartengono
 in totale
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000

\family typewriter
labels[i]>0 
\family default
il sito punta ad un altro cluster, con 
\emph on
root 
\emph default
alla posizione 
\family typewriter
labels[i]
\end_layout

\begin_layout Standard
L'array è un insieme di radici e di puntatori ad altri siti -- rappresenta
 cioè un albero, con collegamenti da ogni foglia (sito), alla radice corrisponde
nte, che contiene il numero di siti che le appartengono.
 Per sapere a che cluster appartiene un qualunque sito, definiamo la funzione
 
\family typewriter
findroot:
\begin_inset listings
lstparams "basicstyle={\small},language={C++}"
inline false
status open

\begin_layout Plain Layout

int findroot(int i,int labels[]) {   
\end_layout

\begin_layout Plain Layout

	if (labels[i]<0) return i;   
\end_layout

\begin_layout Plain Layout

	return labels[i] = findroot(labels[i],labels); 
\end_layout

\begin_layout Plain Layout

} 
\end_layout

\end_inset


\family default
definita ricorsivamente sull'albero.
 Se il sito ha un label negativo, allora è radice.
 Altrimenti, risaliamo al sito a cui punta e reitero il procedimento.
 Ad ogni passo si esegue la 
\emph on
path compression
\emph default
: ogni sito su cui si passa è aggiornato per puntare direttamente alla radice
 -- in questo modo la volta successiva il percorso non deve essere ricostruito.
\end_layout

\begin_layout Standard
L'algoritmo è il seguente:
\end_layout

\begin_layout Enumerate
ad ogni sito si associa l'atomo banale, formato dal sito stesso, 
\family typewriter
labels[i]=-1
\family default
.
 In questo modo da subito ad ogni sito corrisponde un cluster, che verrà
 eventualmente allargato unendolo con i suoi vicini.
 
\end_layout

\begin_layout Enumerate
per ogni sito 
\family typewriter
i
\family default
, in ordine crescente, controlliamo (fino ad esaurimento) il vettore 
\family typewriter
NNB[i].
\end_layout

\begin_deeper
\begin_layout Enumerate
cerchiamo il cluster di appartenenza, 
\family typewriter
ri=findroot(i,labels)
\end_layout

\begin_layout Enumerate
per ogni vicino 
\family typewriter
j
\family default
, identifichiamo a sua volta il cluster, 
\family typewriter
rj=findroot(j,labels)
\end_layout

\begin_layout Enumerate
se la radice è la stessa, ovvero appartengono già allo stesso cluster, non
 si fa nulla
\end_layout

\begin_layout Enumerate
se le radici sono diverse, si uniscono i cluster.
 C'è sicuramente un cluster più grosso (o uguale) e uno più piccolo, rispettivam
ente di radice 
\family typewriter
rmax 
\family default
e 
\family typewriter
rmin
\family default
.
 Per fare il numero minimo di cambiamenti, si aggiunge alla radice il numero
 di siti accorpati 
\begin_inset listings
lstparams "basicstyle={\small\ttfamily},language=C"
inline false
status open

\begin_layout Plain Layout

labels[rmax] -= labels[rmin]
\end_layout

\end_inset

 e si trasforma 
\family typewriter
rmin
\family default
 in una foglia del cluster più grosso:
\begin_inset listings
lstparams "basicstyle={\small\ttfamily},language=C"
inline false
status open

\begin_layout Plain Layout

labels[rmin] = rmax
\end_layout

\end_inset

 La volta successiva che si cerca la root dei siti che appartenevano al
 cluster più piccolo, si risalirà fino alla nuova radice --- il cluster
 è stato effettivamente assimilato, semplicemente cambiando il valore di
 un puntatore.
\end_layout

\end_deeper
\begin_layout Enumerate
alla fine tutti i siti sono stati controllati, 
\family typewriter
r=findroot(i, labels)
\family default
 punta alla radice di appartenenza, lo spazio è partizionato, l'intero 
\family typewriter
r 
\family default
identifica in maniera univoca le classi di equivalenza.
 
\end_layout

\begin_layout Standard
Riassumendo, l'algoritmo corrisponde sostanzialmente a due passaggi, che
 nel nostro caso avvengono contemporaneamente ma un sito alla volta, illustrati
 in figura 
\begin_inset CommandInset ref
LatexCommand vref
reference "fig:hoshen_kopelman"

\end_inset

:
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename immagini/hoshen_kopelman.png
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Funzionamento dell'algoritmo di Hoshen-Kopelman: dalla configurazione indicata
 dai due colori, si formano i cluster guardando solo ai primi vicini, assegnando
 una nuova etichetta quando non vi è un primo vicino dello stesso tipo;
 successivamente si riconoscono globalmente le etichette equivalenti, anche
 attraverso le condizioni al bordo periodiche.
\begin_inset CommandInset label
LatexCommand label
name "fig:hoshen_kopelman"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Collegamento dei vicini (FIND)
\end_layout

\begin_layout Itemize
Raggruppamento graduale dei cluster così trovati (UNION)
\end_layout

\begin_layout Standard
L'algoritmo è ottimale, con runtime 
\begin_inset Formula $\mathcal{O}(L\ln L)$
\end_inset

 e senza bisogno di memoria aggiuntiva.
 Il fattore logaritmico è dovuto alla fase di unione dei cluster, che in
 generale richiede 
\begin_inset Formula $\mathcal{O}(\ln L)$
\end_inset

 passi per sito per trovare la radice di appartenenza.
\end_layout

\begin_layout Subsection
Relabeling
\end_layout

\begin_layout Standard
Una volta che abbiamo il vettore 
\family typewriter
labels[]
\family default
, si può utilizzare le informazioni ivi contenute.
 Si costruisce un vettore di atomi, definendo per ciascuno una struttura
 che contiene informazioni quali le dimensioni, dove inizia, dove finisce,
 il 
\emph on
hash
\emph default
 corrispondente.
\end_layout

\begin_layout Standard
Per avere il numero degli atomi e inizializzare il vettore corrispondente
 basta contare quanti siti hanno 
\family typewriter
labels[i]<0
\family default
.
 Contemporaneamente possiamo associare ad ogni atomo le sue dimensioni,
 
\family typewriter
-labels[i]
\family default
, il suo sito di inizio 
\family typewriter
i
\family default
, e l'ultimo sito trovato, temporaneamente 
\family typewriter
i
\family default
.
 Ogni elemento del vettore labels punta ad un sito (o indica lo stesso come
 radice) per cui è contenuto nell'intervallo 
\begin_inset Formula $[0,\dots,L]$
\end_inset

 ed è possibile tenere conto di ogni atomo che si incontra scorrendo tutti
 i siti e utilizzare questo contatore come nuova etichetta: non più la radice,
 ma il numero dell'atomo corrispondente in 
\begin_inset Formula $[0,\dots,n]$
\end_inset

.
 
\end_layout

\begin_layout Standard
Avendo un elenco di atomi contente le dimensioni di ciascuno, si calcola
 l'entropia della partizione in modo diretto, sommando le dimensioni dei
 vari atomi moltiplicate per il loro logaritmo e normalizzando.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/organizzazione_siti.png
	width 8cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Per ogni sito è stato indicato l'atomo di appartenenza, sotto l'indice,
 sopra il valore del vettore che punta al sito precedente appartenente allo
 stesso atomo.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Generiamo inoltre il vettore ottimale dei vicini: 
\family typewriter
previous[]
\family default
.
 Per ogni sito 
\family typewriter
i
\family default
, conosciamo infatti l'atomo di appartenenza e il precedente sito trovato
 appartenente allo stesso atomo: 
\family typewriter
previous[i]
\family default
 conterrà proprio questo dato.
 Aggiorniamo poi il puntatore all'ultimo sito trovato con 
\family typewriter
i
\family default
 stesso.
 Andando a leggere il vettore 
\family typewriter
previous[]
\family default
 in modo ordinato, abbiamo una lista ordinata, che ad ogni intero associa
 un numero strettamente minore o uguale (se il sito non ha un precedente).
 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/struttura_memoria.png
	width 80col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Sintetica rappresentazione della struttura in memoria che rappresenta le
 quantità collegate ad ogni sito
\end_layout

\end_inset


\end_layout

\end_inset

 
\end_layout

\begin_layout Subsection
Hashing
\end_layout

\begin_layout Standard
Definiamo un 
\emph on
hash
\emph default

\begin_inset Foot
status open

\begin_layout Plain Layout
Etimologicamente, 
\emph on
to hash
\emph default
 vuol dire maciullare, sparpagliare
\end_layout

\end_inset

 come un modo univoco di associare ad ogni atomo un elemento dello spazio
 delle stringhe a 64bit --- il numero degli atomi è sicuramente molto inferiore
 a 
\begin_inset Formula $2^{64}$
\end_inset

 per cui con un buon algoritmo è improbabile che due atomi diversi ottengano
 lo stesso identificativo
\begin_inset CommandInset citation
LatexCommand cite
key "Hash-Mitzenmacher"

\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "knuth03"

\end_inset

.
 
\end_layout

\begin_layout Standard
La conoscenza di un atomo corrisponde alla lista di siti che lo compongono,
 tuttavia sarebbe oneroso tenere da parte un'altra volta questa lista, ordinata
 stavolta per atomo, oppure andarla a ricostruire ogni volta.
 Per controllare l'uguaglianza tra due atomi di due diverse partizioni,
 bisognerebbe fare un confronto sito per sito.
 Se ogni atomo diverso è distinguibile solo con il confronto di un intero
 (operazione atomica), il confronto tra due atomi è immediato e 
\begin_inset Formula $\mathcal{O}(1)$
\end_inset

 in tempo, indipendentemente dalle dimensioni dell'atomo.
\end_layout

\begin_layout Standard
La chiave sta nel trovare un buon algoritmo di hashing, che sparpagli i
 bit di informazione contenuti dall'atomo in maniera uniforme nello spazio
 delle stringhe binarie a 64bit, in modo che a input diverso corrisponda
 
\emph on
sempre
\emph default
 (a meno di una probabilità idealmente prossima a 
\begin_inset Formula $2^{-64}$
\end_inset

) un identificativo diverso.
 L'algoritmo utilizzato in questo caso è l'estremamente semplice 
\emph on
hash DJB
\begin_inset Foot
status open

\begin_layout Plain Layout
Acronimo
\emph on
 
\emph default
dell'ideatore, D.
 J.
 Bernstein
\end_layout

\end_inset

, 
\emph default
dopo un confronto con alcuni altri algoritmi
\begin_inset CommandInset citation
LatexCommand cite
key "hashlist"

\end_inset

, risultati dare molte collisioni, ovvero capitava che triple di interi
 diverse dessero risultati uguali
\begin_inset CommandInset citation
LatexCommand cite
key "Murmurhash"

\end_inset

.
\end_layout

\begin_layout Standard
Gli atomi sono equivalenti ad array di interi, per cui l'algoritmo prende
 un array di lunghezza arbitraria di interi a 32bit e restituisce un intero
 a 64bit, partendo da un valore costante iniziale, fissato empiricamente
 a 5381.
 L'aggiunta di un intero 
\family typewriter
value
\family default
 alla variabile 
\family typewriter
hash
\family default
 avviene nel modo seguente:
\begin_inset Newline newline
\end_inset

 
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\align left
\begin_inset listings
lstparams "basicstyle={\small\ttfamily},language=C"
inline false
status open

\begin_layout Plain Layout

void DJBHash_step(u_int64_t &hash, u_int32_t value) {
\end_layout

\begin_layout Plain Layout

    hash = (hash << 5) + hash + (0xff000000 & value);
\end_layout

\begin_layout Plain Layout

    hash = (hash << 5) + hash + (0x00ff0000 & value);
\end_layout

\begin_layout Plain Layout

    hash = (hash << 5) + hash + (0x0000ff00 & value);
\end_layout

\begin_layout Plain Layout

    hash = (hash << 5) + hash + (0x000000ff & value);
\end_layout

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Newline newline
\end_inset

ovvero la variabile a 32bit che codifica il valore del sito viene spezzata
 in 4 pezzi da 1 byte ciascuno; ogni byte viene sommato al hash, mentre
 questo viene mischiato tramite uno shift e una somma del valore precedente.
 Senza spezzettare i 4 byte il rimescolamento dei bit risulta insufficiente
 e il hash perde di unicità.
\end_layout

\begin_layout Standard
Il hash viene calcolato intanto che si scorre l'array dei labels e si costruisce
 il vettore 
\family typewriter
previous
\family default
.
 Per ogni sito 
\family typewriter
i
\family default
 recuperiamo l'indice dell'atomo corrispondente 
\family typewriter
labels[i]
\family default
, che contiene una variabile preposta all'immagazzinamento del hash, al
 quale aggiungiamo il valore di 
\family typewriter
i
\family default
 di volta in volta.
\end_layout

\begin_layout Section
Operazioni tra partizioni generiche
\end_layout

\begin_layout Subsection
Prodotto
\end_layout

\begin_layout Standard
Dovendo ragionare sui label assegnati ai siti, cerchiamo un modo di labellare
 in modo univoco i siti nella partizione prodotto, con un'operazione sito
 per sito, ovvero locale.
 Dalla definizione si ottiene che un sito 
\begin_inset Formula $i$
\end_inset

 appartiene all'atomo 
\begin_inset Formula $(\alpha\vee\beta)_{jk}\text{ se appartiene a }A_{j}\cap B_{k}$
\end_inset

, ovvero se ha 
\begin_inset Formula $\lambda_{\alpha}(i)=j$
\end_inset

 e 
\begin_inset Formula $\lambda_{\beta}(i)=k$
\end_inset

.
 
\end_layout

\begin_layout Standard
Il prodotto deve mantenere la topologia, quindi prendendo due siti 
\begin_inset Quotes eld
\end_inset

vicini
\begin_inset Quotes erd
\end_inset

, ovvero appartenenti allo stesso atomo in entrambe le partizioni, devono
 rimanere nello stesso atomo del prodotto
\begin_inset Formula 
\[
m,n\in A_{j}\;\text{e}\; m,n\in B_{k}\text{ \implies}m,n\in(\alpha\vee\beta)_{jk}
\]

\end_inset

ma i siti 
\begin_inset Formula $m,n$
\end_inset

 hanno label 
\begin_inset Formula $\lambda_{\alpha}(m)=\lambda_{\alpha}(n)=j$
\end_inset

 e 
\begin_inset Formula $\lambda_{\beta}(m)=\lambda_{\beta}(n)=k$
\end_inset

 rispettivamente per le due partizioni --- devono avere lo stesso label
 nel prodotto, che può dipendere solo dal label degli atomi di partenza.
 L'unica scelta possibile è assegnare label 
\begin_inset Formula $(j,k)$
\end_inset

 (o equivalente) ad ogni sito del prodotto, ovvero la coppia (ordinata)
 dei label di partenza.
 Una volta eseguito l'assegnamento, gli atomi sono riconosciuti cercando
 label dello stesso valore.
 Tutto il procedimento è illustrato in figura 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:prodotto-generico"

\end_inset

.
\end_layout

\begin_layout Standard
Se i label sono rappresentati da interi a 32bit, la coppia può essere rappresent
ata da un intero a 64bit, avente nei primi 32bit il valore del primo label,
 e negli ultimi quello del secondo: in questo modo tutte le operazioni sono
 atomiche su un moderno processore.
\end_layout

\begin_layout Standard
Ricapitolando: al sito 
\begin_inset Formula $i$
\end_inset

-esimo, partendo da 
\begin_inset Formula $\lambda_{\alpha}(i)=j$
\end_inset

 e 
\begin_inset Formula $\lambda_{\beta}(i)=k$
\end_inset

, si assegna nel prodotto 
\begin_inset Formula $\lambda_{\alpha\vee\beta}(i)=(j,k)$
\end_inset

:
\end_layout

\begin_layout Standard
\align center

\family typewriter
prod[i] = alpha[i] << 32 | beta[i];
\family default

\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/prodotto_partizioni.png
	width 80col%

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
Calcolo di un prodotto tra partizioni.
 a)partizioni di partenza; b)partizione prodotto; c)lunghezze degli atomi
 ordinati del prodotto, al fine di calcolare l'entropia
\begin_inset CommandInset label
LatexCommand label
name "fig:prodotto-generico"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
come si vede dalla formula esplicita, 
\begin_inset Formula $(j,k)\neq(k,j)$
\end_inset

 in quanto gli indici identificano atomi appartenenti a partizioni diverse,
 con siti in genere diversi -- se al posto del OR binario si volesse usare
 un'altra operazione, va cercata una asimmetrica nei due indici, per non
 unire atomi distinti.
 Ad esempio una partizione con labels {1,2} è equivalente a {2,1} (sempre
 due atomi distinti); il prodotto è ancora una partizione con due atomi,
 ma le etichette del prodotto sono: {(1,2),(2,1)} -- devono essere chiaramente
 diverse.
\end_layout

\begin_layout Standard
Anche in questo caso il prodotto comporta un numero di operazioni sito-per-sito,
 con complessità 
\begin_inset Formula $\mathcal{O}(\mathrm{L})$
\end_inset

.
\end_layout

\begin_layout Subsection
Entropia
\begin_inset CommandInset label
LatexCommand label
name "sub:sort_entropy"

\end_inset


\end_layout

\begin_layout Standard
Per calcolare il numero di siti di un atomo, ovvero corrispondente ad ogni
 etichetta univoca, bisogna innanzitutto scorrere l'elenco per cercare tutte
 le etichette e ogni volta che si trova una non precedentemente catalogata,
 scorrere l'intero array in avanti e contare quante volte appare.
 Questa è chiaramente un'operazione con complessità
\begin_inset Formula 
\[
\sum_{i=1}^{L}(L-i)=\mathcal{O}(L^{2})
\]

\end_inset


\end_layout

\begin_layout Standard
Ma si può fare meglio.
 Infatti non è necessario scorrere N volte l'intero elenco dei labels.
 Si può riordinare questo elenco tramite un'operazione di 
\emph on
sort
\emph default

\begin_inset Foot
status open

\begin_layout Plain Layout
Nello specifico ci affidiamo al 
\emph on
quicksort
\emph default
 delle librerie glibc
\end_layout

\end_inset

.
 L'andamento asintotico è noto in letteratura
\begin_inset CommandInset citation
LatexCommand citep
key "knuth03"

\end_inset

 essere 
\begin_inset Formula $\mathcal{O}(L\log_{2}L)$
\end_inset

 nel numero di siti, con una costante di proporzionalità dipendente dall'algorit
mo, ma non particolarmente onerosa.
\end_layout

\begin_layout Standard
Ordinando l'elenco delle etichette (non importa neanche se in ordine crescente
 o decrescente) si ottiene un array in cui sicuramente tutti gli elementi
 uguali sono consecutivi -- si procede a questo punto al calcolo dell'entropia
 come se si trattasse di una sequenza unidimensionale.
\end_layout

\begin_layout Standard
L'altro metodo, computazionalmente più semplice, 
\begin_inset Formula $\mathcal{O}(L)$
\end_inset

 sia in runtime che in memoria, che consiste nel numerare temporaneamente
 tutti i label trovati in ordine crescente e rietichettarli con la successione
 
\begin_inset Formula $\{1,2,\dots\}$
\end_inset

 non è gestibile, in quanto i label possono essere distribuiti in modo 
\begin_inset Quotes eld
\end_inset

sparso
\begin_inset Quotes erd
\end_inset

 nello spazio delle coppie 
\begin_inset Formula $(j,k)$
\end_inset

.
 In generale vi possono essere al massimo 
\begin_inset Formula $L$
\end_inset

 atomi nel prodotto, ma 
\begin_inset Formula $L\times L$
\end_inset

 coppie, quindi sicuramente non tutte sono realizzate.
 La complessità dell'organizzarle in qualche altro modo, ad esempio in un
 albero binario bilanciato o un hash -- tutte superano in fretta la semplicità
 del 
\emph on
sort
\emph default
 e anche nel caso migliore hanno lo stesso andamento asintotico.
 In pratica l'andamento è polinomialmente peggiore, per motivi di mal gestione
 della cache L1 e L2 del processore, in quanto sia gli alberi che i hash
 risultano nonlocali, mentre un sort sposta gli elementi in modo ordinato
 e accede alla memoria in modo più lineare.
\end_layout

\begin_layout Standard
Una volta calcolata l'entropia di ogni partizione, sia di Shannon che topologica
, la distanza di Rohlin segue immediatamente dalla formula 
\begin_inset CommandInset ref
LatexCommand vref
reference "eq:distanza_rohlin"

\end_inset

, senza nessuna modifica.
\end_layout

\begin_layout Subsection
Differenza simmetrica
\end_layout

\begin_layout Standard
Per calcolare la differenza tra due atomi, illustriamo come calcolare in
 modo efficiente la differenza simmetrica tra due insiemi.
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand verbatiminput
filename "snippets/symmetric-set-difference.snippet"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Differenza simmetrica tra insiemi ordinati, rappresentata testualmente
\begin_inset CommandInset label
LatexCommand label
name "fig:Differenza-simmetrica"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Dati due insiemi ordinati di dimensione 
\begin_inset Formula $n$
\end_inset

 e 
\begin_inset Formula $m$
\end_inset

, è possibile calcolare la differenza simmetrica in modo lineare, con al
 massimo 
\begin_inset Formula $2(n+m+1)$
\end_inset

 operazioni, mentre per due insiemi disordinati sono necessarie 
\begin_inset Formula $\mathcal{O}(n\, m)$
\end_inset

 operazioni.
 Il procedimento è illustrato in figura 
\begin_inset CommandInset ref
LatexCommand vref
reference "fig:Differenza-simmetrica"

\end_inset

.
\end_layout

\begin_layout Standard
La prima fase è quella di allineamento, ovvero si scorrono i due array rappresen
tanti gli insiemi, aggiungendo spazi all'uno o all'altro, in maniera tale
 che i valori nonvuoti siano uguali nelle due righe.
 Successivamente si contano le differenze tra le due stringhe di simboli
 allineati.
 
\end_layout

\begin_layout Standard
Chiaramente si possono fare entrambe le operazioni contemporeanemente, contando
 +1 ogni volta che si aggiunge uno spazio.
 Quando si vuol sapere se due atomi hanno al massimo 
\begin_inset Formula $n_{\epsilon}$
\end_inset

 siti diversi, ci si può fermare dopo aver inserito 
\begin_inset Formula $n_{\epsilon}$
\end_inset

 spazi.
 Non è poi neanche necessario rappresentare gli spazi in memoria, basta
 scorrere in avanti il puntatore corrispondente per allineare al volo intanto
 che si leggono gli insiemi stessi.
\end_layout

\begin_layout Standard
L'operazione è estremamente efficiente se si ha l'elenco corrispondente
 ai siti dei due insiemi.
 Nel nostro caso, a partire da un qualunque sito, è sufficiente usare il
 vettore 
\family typewriter
previous[]
\family default
 per ottenere il sito precedente, sicuramente ordinato.
\end_layout

\begin_layout Subsection
Intersezione
\end_layout

\begin_layout Standard
Definiamo ora il modo operativo di calcolare la partizione comune, 
\begin_inset Formula $\sigma=\alpha\wedge\beta$
\end_inset

.
 Descriviamo il processo prima in termini di atomi, poi in termini di siti,
 per arrivare all'algoritmo ottimale.
\end_layout

\begin_layout Standard
La partizione intersezione, 
\begin_inset Formula $\sigma$
\end_inset

 essendo la partizione più fine tale che 
\begin_inset Formula $\sigma\leq\alpha$
\end_inset

 e 
\begin_inset Formula $\sigma\leq\beta$
\end_inset

, ha atomi formati dall'unione minimale di atomi sia di 
\begin_inset Formula $\alpha$
\end_inset

 che di 
\begin_inset Formula $\beta$
\end_inset

.
 Ovvero ogni atomo 
\begin_inset Formula $C_{k}=\cup_{j}A_{j}=\cup_{m}B_{m}$
\end_inset

.
 Chiaramente andare a cercare le combinazioni di 
\begin_inset Formula $A_{j}$
\end_inset

 e 
\begin_inset Formula $B_{m}$
\end_inset

 necessarie è un'impresa disperata.
\end_layout

\begin_layout Standard
In termini di siti, vediamo che ogni atomo 
\begin_inset Formula $C_{k}$
\end_inset

 collega siti appartenenti a diversi atomi di 
\begin_inset Formula $\alpha$
\end_inset

 se questi sono collegati in 
\begin_inset Formula $\beta$
\end_inset

.
 Questo corrisponde già ad un utile criterio: 
\begin_inset Formula 
\begin{equation}
i\sim j\;\text{in\;}\sigma\iff i\sim j\;\text{in\;}\alpha\;\vee\; i\sim j\;\text{in\;}\beta\label{eq:equivalenza-intersezione}
\end{equation}

\end_inset

che diventa ancora più utile se ci si ricorda che la relazione di equivalenza
 tra siti è mantenuta a livello locale dalla struttura 
\family typewriter
NNB
\family default
 precedentemente introdotta.
 Ovvero possiamo esprimere la relazione di equivalenza 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:equivalenza-intersezione"

\end_inset

 a livello locale, sito per sito, ottenendo la corretta partizione globale
 alla fine!
\end_layout

\begin_layout Standard
La partizione 
\begin_inset Formula $\sigma$
\end_inset

 ha anch'essa una struttura di vicini corrispondenti:
\end_layout

\begin_layout Itemize
\begin_inset Formula $i$
\end_inset

 è vicino di 
\begin_inset Formula $j$
\end_inset

 anche se è solo vicino in 
\begin_inset Formula $\alpha$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $i$
\end_inset

 è vicino di 
\begin_inset Formula $j$
\end_inset

 anche se è se è vicino in 
\begin_inset Formula $\beta$
\end_inset


\end_layout

\begin_layout Standard
la partizione 
\begin_inset Formula $\sigma$
\end_inset

 sarà quindi ricostruita tramite un'opportuna struttura 
\family typewriter
NNB
\family default
, che ha in generale il doppio dei vicini 
\begin_inset Formula $\tilde{z}(\sigma)=\tilde{z}(\alpha)+\tilde{z}(\beta)=2\tilde{z}$
\end_inset

, ovvero sito-per-sito l'unione dei vicini di 
\begin_inset Formula $\alpha$
\end_inset

 e 
\begin_inset Formula $\beta$
\end_inset

.
\end_layout

\begin_layout Itemize

\family typewriter
NNB
\begin_inset Formula $_{\sigma}$
\end_inset

[i][2k]=NNB
\begin_inset Formula $_{\alpha}$
\end_inset

[i][k]
\end_layout

\begin_layout Itemize

\family typewriter
NNB
\begin_inset Formula $_{\sigma}$
\end_inset

[i][2k+1]=NNB
\begin_inset Formula $_{\beta}$
\end_inset

[i][k]
\end_layout

\begin_layout Standard
dove per 
\family typewriter
NNB
\begin_inset Formula $_{\alpha}$
\end_inset


\family default
 si intende la struttura corrispondente utilizzata per il partizionamento
 di 
\begin_inset Formula $\alpha$
\end_inset

, 
\begin_inset Formula $0\leq k<\tilde{z}$
\end_inset

.
\end_layout

\begin_layout Standard
Una volta definita la struttura dei vicini, si partiziona l'array contenente
 tutti i siti con l'algoritmo descritto 
\begin_inset CommandInset ref
LatexCommand vpageref
reference "sub:Partizionamento"

\end_inset

.
\end_layout

\begin_layout Paragraph*
Ottimizzazione 
\end_layout

\begin_layout Standard
Non è in realtà necessario aggiungere i vicini di ogni sito, come definiti
 originariamente dalla struttura 
\family typewriter
NNB
\family default
 corrispondente.
 Esiste un vettore di vicini ottimale, che ricostruisce esattamente le partizion
i originarie: 
\family typewriter
previous[]
\family default
.
\end_layout

\begin_layout Standard
Il problema dell'intersezione è quindi ridotto a considerare 2 vicini per
 ogni sito, invece che 
\begin_inset Formula $2d$
\end_inset

 senza quest'ottimizzazione! Per un qualunque sito definiamo quindi
\end_layout

\begin_layout Itemize

\family typewriter
NNB
\begin_inset Formula $_{\sigma}$
\end_inset

[i][0]=previous
\begin_inset Formula $_{\alpha}$
\end_inset

[i]
\end_layout

\begin_layout Itemize

\family typewriter
NNB
\begin_inset Formula $_{\sigma}$
\end_inset

[i][1]=previous
\begin_inset Formula $_{\beta}$
\end_inset

[i]
\end_layout

\begin_layout Section
Riduzione
\end_layout

\begin_layout Standard
Una volta che si è in grado di calcolare l'intersezione, è possibile calcolare
 le partizioni ridotte.
 Vediamo ora come implementare i diversi criteri esposti 
\begin_inset CommandInset ref
LatexCommand vpageref
reference "criteri-riduzione"

\end_inset

.
 Lo scopo principale è quello di evitare la costruzione , il prodotto e
 l'intersezione dei fattori dicotomici, per motivi di tempo e occupazione
 in memoria.
 
\end_layout

\begin_layout Standard
Visto che le partizioni ridotte servono solo al calcolo del loro prodotto,
 costruiremo per ciascuno i giusti labels.
 Non serve costruire i vettori 
\family typewriter
previous[]
\family default
, né le strutture degli atomi, ma solo calcolare l'entropia a partire dai
 labels con il metodo presentato a pagina 
\begin_inset CommandInset ref
LatexCommand vpageref
reference "sub:sort_entropy"

\end_inset

 visto che è necessaria per la distanza di Rohlin.
\end_layout

\begin_layout Subsection
Confronto con l'intersezione
\end_layout

\begin_layout Standard
Per ridurre due partizioni 
\begin_inset Formula $\alpha$
\end_inset

 e 
\begin_inset Formula $\beta$
\end_inset

 definiamo innanzitutto l'intersezione 
\begin_inset Formula $\sigma=\alpha\wedge\beta$
\end_inset

 calcolata con l'algoritmo appena presentato.
 In generale per fare molti confronti, sarà necessario usare una variabile
 temporanea che contenga l'intersezione di volta in volta.
\end_layout

\begin_layout Standard
Costruiamo le partizioni dicotomiche semplici, ovvero a partire da ogni
 atomo 
\begin_inset Formula $A_{k}\in\alpha,$
\end_inset

 definiamo 
\begin_inset Formula $\hat{\alpha}_{k}=\{A_{k},A_{k}^{c}\}$
\end_inset

:
\end_layout

\begin_layout Description
Costruzione in memoria si tiene l'elenco degli atomi, ovvero un array di
 strutture 
\family typewriter
atomi[]
\family default
, su cui possiamo scorrere.
 Per ogni atomo (ad esempio il 
\begin_inset Formula $k$
\end_inset

-esimo) conosco il sito finale, 
\family typewriter
atomi[k].end
\family default
, ricostruisco gli altri siti appartenenti tramite iterazione del vettore
 
\family typewriter
previous[atomi[k].end]
\family default
.
 Ho inoltre il sito di inizio, 
\family typewriter
atomi[k].start
\family default
.
\end_layout

\begin_layout Standard
Confrontiamo ogni partizione dicotomica 
\begin_inset Formula $\hat{\alpha}_{k}$
\end_inset

 con l'intersezione, 
\begin_inset Formula $\rho=\hat{\alpha}_{k}\wedge\sigma$
\end_inset

.
 Se 
\begin_inset Formula $\rho\neq\nu$
\end_inset

, la partizione banale, scarto la partizione dicotomica 
\begin_inset Formula $\hat{\alpha}_{k}$
\end_inset

.
 Si hanno i possibili casi:
\end_layout

\begin_layout Description
Intersezione
\begin_inset space ~
\end_inset

nonbanale 
\begin_inset Formula $\exists C_{m}\in\sigma\;\text{tale che}\; A_{k}=C_{m}$
\end_inset

: in questo caso l'atomo di 
\begin_inset Formula $\alpha$
\end_inset

 corrisponde esattamente ad un atomo di 
\begin_inset Formula $\sigma$
\end_inset

, ovvero hanno tutti i siti in comune.
 La loro intersezione conterrà almeno l'atomo 
\begin_inset Formula $\hat{\alpha}_{k}$
\end_inset

, per cui sarà non banale 
\begin_inset Formula $\Longrightarrow$
\end_inset

 scarto 
\begin_inset Formula $A_{k}$
\end_inset

.
\end_layout

\begin_layout Description
Intersezione
\begin_inset space ~
\end_inset

banale Se 
\begin_inset Formula $A_{k}$
\end_inset

 non corrisponde esattamente a un qualche 
\begin_inset Formula $C_{m}$
\end_inset

, allora 
\begin_inset Formula $\sigma$
\end_inset

 unisce più atomi di 
\begin_inset Formula $\alpha$
\end_inset

.
 In questo caso, la partizione 
\begin_inset Formula $\sigma$
\end_inset

 collega siti di 
\begin_inset Formula $A_{k}$
\end_inset

 con siti del suo complementare, banalizzando l'intersezione con la partizione
 dicotomica 
\begin_inset Formula $\Longrightarrow$
\end_inset

 
\begin_inset Formula $\hat{\alpha}_{k}\wedge\sigma=\nu$
\end_inset

.
\end_layout

\begin_layout Standard
Come si calcola se esiste esattamente un atomo 
\begin_inset Formula $C_{m}$
\end_inset

 corrispondente? Visto che stiamo iterando sull'elenco degli atomi di 
\begin_inset Formula $\alpha$
\end_inset

, conosciamo sicuramente un sito appartenente ad 
\begin_inset Formula $A_{k}$
\end_inset

 che chiamiamo 
\begin_inset Formula $j$
\end_inset

, 
\family typewriter
j=atomi[k].end
\family default
 e l'atomo corrispondente al sito 
\begin_inset Formula $j$
\end_inset

 nella partizione 
\begin_inset Formula $\sigma$
\end_inset

, tramite il vettore delle etichette di 
\begin_inset Formula $\sigma$
\end_inset

.
 Fatto questo, abbiamo le strutture degli atomi corrispondenti al sito 
\begin_inset Formula $j$
\end_inset

 per entrambe le partizioni, per cui conosciamo il 
\emph on
hash
\emph default
 corrispondente a 
\begin_inset Formula $C_{m}$
\end_inset

 e a 
\begin_inset Formula $A_{k}$
\end_inset

.
 Se il 
\emph on
hash
\emph default
 è uguale, allora gli atomi sono uguali! Per il confronto del fattore dicotomico
 generato dall'atomo 
\begin_inset Formula $A_{k}$
\end_inset

 abbiamo quindi in totale fatto 4 operazioni veloci:
\end_layout

\begin_layout Enumerate
Dall'indice 
\begin_inset Formula $k$
\end_inset

 si trova la struttura contente un sito 
\begin_inset Formula $j$
\end_inset

 e il hash, 
\family typewriter
atomi[k]
\family default
 --- 1 lookup
\end_layout

\begin_layout Enumerate
Si cerca l'indice dell'atomo corrispondente in 
\begin_inset Formula $\sigma$
\end_inset

, 
\family typewriter
labels
\begin_inset Formula $_{\sigma}$
\end_inset

[j]
\family default
 --- 1 lookup
\end_layout

\begin_layout Enumerate
Si trova la struttura corrispondente all'atomo in 
\begin_inset Formula $\sigma$
\end_inset

 e si legge il 
\emph on
hash
\emph default
 --- 1 lookup
\end_layout

\begin_layout Enumerate
Si confrontano i due hash --- 1 confronto
\end_layout

\begin_layout Standard
Rimane da moltiplicare insieme tutte le partizioni dicotomiche rimaste,
 per ottenere la partizione ridotta 
\begin_inset Formula $\hat{\alpha}=\vee_{k}\hat{\alpha}_{k}$
\end_inset

.
 Numeriamo i fattori dicotomici rimasti con un indice crescente, a partire
 da 2.
 Vediamo come in ogni partizione dicotomica vi sia un atomo della partizione
 originaria e il suo complementare: gli atomi sono disgiunti, per cui il
 prodotto dei singoli atomi risulta vuoto.
 Rimangono da moltiplicare tutti i complementari per gli atomi rimasti:
 genero nuovamente esattamente gli atomi che non ho scartato nella riduzione
 e un ulteriore atomo (generalmente sconnesso) composto dall'unione di tutti
 gli atomi scartati.
\end_layout

\begin_layout Description
Ricostruzione Creiamo una partizione banale con tutti i label pari a 1,
 a rappresentare l'atomo di 
\begin_inset Quotes eld
\end_inset

background
\begin_inset Quotes erd
\end_inset

.
 Mettiamo un label 
\begin_inset Formula $k\geq2$
\end_inset

 ai siti di ogni atomo 
\begin_inset Formula $A_{k}$
\end_inset

 che non è stato scartato nel confronto.
 Questo è semplice, basta porre uguali a 
\begin_inset Formula $k$
\end_inset

 tutti i siti partendo da 
\family typewriter
j=atomi[k].end
\family default
 e iterando tramite 
\family typewriter
j=previous[j]
\family default
 fino a che non arriviamo all'inizio dell'atomo.
 Alla fine abbiamo una partizione in cui l'atomo disconnesso con gli scarti
 ha label 1, mentre gli altri siti hanno label numerati a partire da 2.
 Il processo è chiaramente proporzionale al numero di siti che abbiamo dovuto
 riscrivere, quindi 
\begin_inset Formula 
\[
\mbox{\mathcal{O}}(L)+\mathcal{O}\left(\sum_{k}\mu\left(A_{k}\right)\right)=\mathcal{O}(L)
\]

\end_inset


\end_layout

\begin_layout Standard
Abbiamo costruito in tempo lineare la partizione ridotta, in quanto per
 ogni atomo c'è un confronto atomico e il relabeling del risultato corrispondent
e.
\end_layout

\begin_layout Subsection
Confronto diretto
\end_layout

\begin_layout Standard
In questo tipo di riduzione, confrontiamo direttamente gli atomi di due
 partizioni, 
\begin_inset Formula $\alpha$
\end_inset

 e 
\begin_inset Formula $\beta$
\end_inset

, scartando le partizioni dicotomiche corrispondenti, nel caso in cui gli
 atomi soddisfino il criterio prescelto.
\end_layout

\begin_layout Standard
Per evitare problemi di definizione, consideriamo la partizione 
\begin_inset Formula $\beta$
\end_inset

 fissata, costruendo 
\begin_inset Formula $\hat{\alpha}$
\end_inset

 a partire dal confronto di 
\begin_inset Formula $\alpha$
\end_inset

 e 
\begin_inset Formula $\beta$
\end_inset

.
\begin_inset Foot
status open

\begin_layout Plain Layout
Poi si fa il contrario, tenendo fisso 
\begin_inset Formula $\alpha$
\end_inset

, generando 
\begin_inset Formula $\hat{\beta}$
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Abbiamo due criteri di confronto: 
\end_layout

\begin_layout Enumerate
Scartiamo l'atomo 
\begin_inset Formula $A_{k}$
\end_inset

 se è uguale a 
\begin_inset Formula $B_{m}\in\beta$
\end_inset

 definito sugli stessi siti (usando il confronto tra hash)
\end_layout

\begin_layout Enumerate
Scartiamo l'atomo 
\begin_inset Formula $A_{k}$
\end_inset

 se differisce da 
\begin_inset Formula $B_{m}\in\beta$
\end_inset

 corrispondente meno di 
\begin_inset Formula $\epsilon$
\end_inset

 in misura:
\begin_inset Formula 
\[
\mu\left(A_{k}\triangle B_{m}\right)\leq\epsilon
\]

\end_inset


\end_layout

\begin_layout Standard
Si procede molto similmente al caso del confronto con 
\begin_inset Formula $\sigma$
\end_inset

, in quanto iteriamo su tutti gli atomi di 
\begin_inset Formula $\alpha$
\end_inset

, troviamo i siti corrispondenti all'atomo cercato, da questi gli atomi
 di 
\begin_inset Formula $\beta$
\end_inset

 sopra quei siti e eseguiamo il confronto.
\end_layout

\begin_layout Standard
La differenza simmetrica è stata definita in termini di numero di siti diversi
 
\begin_inset Formula $n_{\epsilon}$
\end_inset

, mentre sopra in termini della misura normalizzata che deve essere 
\begin_inset Formula $\leq\epsilon$
\end_inset

, definiamo dunque: 
\begin_inset Formula 
\[
\epsilon=\frac{n_{\epsilon}}{L}
\]

\end_inset


\end_layout

\begin_layout Standard
La partizione 
\begin_inset Formula $\hat{\alpha}$
\end_inset

 è ricostruita a partire dagli atomi rimasti come spiegato nella sezione
 precedente.
 L'unica differenza è insomma che il confronto viene fatto con gli atomi
 corrispondenti di 
\begin_inset Formula $\beta$
\end_inset

 e non di 
\begin_inset Formula $\sigma$
\end_inset

 e che il criterio non è l'uguaglianza, ma l'uguaglianza a meno di 
\begin_inset Formula $\epsilon$
\end_inset

 (che può essere 0).
\end_layout

\begin_layout Standard
\begin_inset Newpage cleardoublepage
\end_inset


\end_layout

\begin_layout Chapter
Proteine dei virus dell'influenza
\end_layout

\begin_layout Standard
Esponiamo in questo capitolo i risultati ottenuti dalle distanze tra sequenze
 di proteine, ottenute dai database biologici, dei virus dell'influenza
 A umana, di tipi H1N1 e H3N2.
\end_layout

\begin_layout Standard
Lo studio delle sequenze comprende fasi separate:
\end_layout

\begin_layout Enumerate
Raccolta delle sequenze e preanalisi
\end_layout

\begin_layout Enumerate
Compilazione matrice delle distanze tra le sequenze
\end_layout

\begin_layout Enumerate
Clustering a partire dalle distanze
\end_layout

\begin_layout Enumerate
Estrazione informazioni dai cluster e predizioni
\end_layout

\begin_layout Standard
Introduciamo innanzitutto il virus dell'influenza e alcune sue caratteristiche
 fondamentali, che motivano la scelta di che cosa analizzare con i metodi
 entropici.
 Successivamente esaminiamo nel dettaglio i passi elencati sopra.
\end_layout

\begin_layout Section
Il virus dell'influenza
\end_layout

\begin_layout Standard
I virus dell'influenza sono caratterizzati da genomi segmentati in forma
 di RNA a singolo filamento negativo, dipendenti da una RNA-polimerasi di
 origine virale per la trascrizione prima della replicazione
\begin_inset CommandInset citation
LatexCommand citep
key "Bouvier2008"

\end_inset

.
\end_layout

\begin_layout Standard
I virus sono dei tre tipi A, B e C, rappresentanti tre dei cinque generi
 della famiglia 
\shape italic
Orthomyxoviridae
\shape default
, caratterizzati da genomi segmentati.
 I virus hanno un'origine genetica comune, tuttavia la divergenza evolutiva
 ha reso impossibile il riassortimento di materiale genetico tra i tre diversi
 tipi.
 
\end_layout

\begin_layout Standard
I virus dell'influenza B sono caratterizzati da un minore tasso di mutazione
 (circa 
\begin_inset Formula $\nicefrac{1}{3}$
\end_inset

 rispetto all'influenza A) e attaccano quasi esclusivamente l'uomo, quindi
 non tendono a scatenare pandemie.
 I virus del tipo C hanno un tasso di mutazione ancor più lento e sono asintomat
ici, per cui concentriamo la nostra attenzione sul virus A, il più pericoloso
 e fonte di annuali epidemie -- definite come trasmissioni prolungate, diffuse
 da persona a persona.
\end_layout

\begin_layout Subsection
Influenza A
\end_layout

\begin_layout Standard
La forma del virus A è sferica, dal diametro di circa 100 nm, ricoperta
 di numerose proteine, circa 500 molecole di HA e 100 di NA, che protrudono
 dalla superficie.
 Sono in particolare 
\emph on
antigeni
\emph default
, termine che vuol dire 
\series bold
gen
\series default
eratore di 
\series bold
anti
\series default
corpi, in quanto il sistema immunitario riconosce e reagisce al virus proprio
 tramite gli antigeni.
 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/influenza-virion3.jpg
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Forma del virus dell'influenza A, in cui sono evidenziati gli antigeni all'ester
no e la disposizione del materiale genetico negli 8 segmenti.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
All'interno il virus contiene 8 segmenti di RNA, che codificano le proteine
 per la replicazione.
 Vediamo ora nel dettaglio le funzioni delle proteine di superficie:
\end_layout

\begin_layout Description
HA Emoagglutinina, proteina responsabile per il binding del virus alla cellula
 infettata.
 L'emoagglutinina forma delle 
\begin_inset Quotes eld
\end_inset

punte
\begin_inset Quotes erd
\end_inset

 sulla superficie del virus che servono per agganciarsi alla cellula ospite.
 L'aggancio è necessario per l'efficiente trasferimento del materiale genetico
 all'interno della cellula, un processo che può essere bloccato dagli anticorpi
 che si combinano all'emoagglutinina.
 La forma tridimensionale e il processo con cui la molecola attacca la cellula
 sono mostrate in figura 
\begin_inset CommandInset ref
LatexCommand vref
reference "fig:molecola_HA"

\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "HA_PDB"

\end_inset

.
\end_layout

\begin_layout Description
NA Neuraminidasi, proteina enzimatica che aiuta il rilascio della progenie
 virale dalle cellule infette.
\end_layout

\begin_layout Standard
Le rimanenti proteine M formano il capside (l'involucro del virus), le proteine
 NP e NS rilasciano il materiale nella cellule, le proteine PA e PB gestiscono
 la replicazione del RNA virale.
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/76-Hemagglutinin-HA-action.png
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Illustrazione della molecola HA che protendendo dalla superficie del virus,
 aggancia la cellula e rende possibile l'iniezione del materiale genetico.
\begin_inset CommandInset label
LatexCommand label
name "fig:molecola_HA"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/Virus_Replication.pdf
	width 90text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Processo di riproduzione del virus, in tutte le sue fasi.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
I virus di tipo A sono classificati in base ai possibili tipi di proteine
 di superficie: almeno 16 tipi di HA e 9 tipi di NA sono noti al momento
 della scrittura.
 Tutti le combinazioni sono espresse negli uccelli, che si considera essere
 gli originatori dell'influenza e di aver propagato il virus alle altre
 specie.
 Le combinazioni sono indicate dalle sigle HxNy, dove x e y sono gli indici
 corrispondenti, ad esempio:
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
H1N1 Virus di questo sottotipo hanno causato le pandemie nel 1918 e 2009
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
H3N2 La 
\begin_inset Quotes eld
\end_inset

solita
\begin_inset Quotes erd
\end_inset

 influenza stagionale
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
H5N1 Una recente variante di origine aviaria dalla forte virulenza, poco
 diffusa in occidente
\end_layout

\begin_layout Standard
Ogni sequenza campionata nei database biologici, è caratterizzata dalla
 stringa 
\emph on
strain
\emph default
, ad esempio
\end_layout

\begin_layout Quote
A/Human/Fujian/411/2002 (H3N2)
\end_layout

\begin_layout Standard
indicante che si tratta di un virus del tipo A, sottotipo H3N2, isolato
 a Fujian nel 2002 da un essere umano (l'indicazione di provenienza da umano
 è di solito tralasciata), ed è la 411 sequenza campionata in quell'anno
 in quel laboratorio.
\begin_inset VSpace bigskip
\end_inset


\end_layout

\begin_layout Standard
La pressione evolutiva è concentrata sulle proteine HA e NA, in quanto obiettivi
 del sistema immunitario.
 La particolare struttura del genoma del virus dell'influenza e la funzione
 delle proteine virali consentono due tipi di evoluzione per evadere le
 risposte immunitarie adattative a lungo termine in vari ospiti:
\end_layout

\begin_layout Description
antigenic
\begin_inset space ~
\end_inset

drift che corrisponde al normale processo di mutazione puntuale del materiale
 genetico.
 La replicazione è affidata all'RNA, che non supporta meccanismi di correzione
 dell'errore, con in media un errore di trascrizione per ogni replicazione
 del virus, il che vuol dire che ogni singolo virus è diverso dagli altri.
 L'enorme tasso di mutazione è la causa della rapida obsolescenza dell'immunità
 acquisita, che di solito non si estende da una stagione all'altra.
\end_layout

\begin_layout Description
antigenic
\begin_inset space ~
\end_inset

shift corrispondente alla ricombinazione del materiale genetico provenienti
 da virus diversi o da sottospecie diverse.
 Questo accade quanto una singola cellula è infettata contemporaneamente
 da più virus.
 Il virus dell'influenza ha svariati segmenti indipendenti, che si possono
 rimescolare all'interno della cellula infetta.
 I virus risultanti avranno materiale genetico e proteico fornito dalla
 combinazione casuale di quelle dei virus che hanno attaccato la cellula.
 In questo modo da un virus H5N1 e H3N2 si possono formare combinazioni
 come H3N1 e H5N2 (oltre alle combinazioni di tutte le altre proteine all'intern
o del virus, non rilevate dal sistema immunitario).
\end_layout

\begin_layout Standard
L'
\emph on
antigenic shift 
\emph default
è la mutazione più pericolosa, in quanto cambia radicalmente l'aspetto del
 virus per il sistema immunitario, rendendolo irriconoscibile e quindi non
 più attaccato dagli anticorpi.
 La pericolosità dello shift è che il virus A dell'influenza non attacca
 solo umani, ma anche maiali, uccelli, cavalli, pipistrelli e moltissimi
 altri tipi di animale.
 L'evoluzione di ciascun tipo procede quindi indipendentemente, fino a che
 tipi diversi di influenza non attaccano lo stesso individuo e ricombinano
 i materiali genetici.
\end_layout

\begin_layout Standard
Questo è quanto è accaduto nel caso dell'influenza suina.
 I maiali possono ammalarsi, con sintomi simili all'uomo, di influenze aviarie,
 suine ed umane contemporaneamente.
 In particolare la pandemia del 2009, del sottotipo H1N1, è stata causata
 dalla ricombinazione di sequenze di questi 3 tipi, con antigeni tipici
 degli uccelli e altre proteine di provenienza mammifera, permettendo al
 virus di attaccare anche gli esseri umani, il cui sistema immunitario era
 impreparato al nuovo tipo di virus, anche con trasmissione da uomo a uomo,
 scatenando una pandemia.
\end_layout

\begin_layout Subsection
Vaccini
\end_layout

\begin_layout Standard
I primi vaccini contro l'influenza sono stati introdotti negli anni 40 del
 secolo scorso.
 La vaccinazione ha un effetto statisticamente rilevante nel prevenire un
 grande numero di casi d'infezione, ridurre i costi e le morti causate dalle
 complicazioni dell'influenza, presentando un rapporto costo-benefici positivo
 per tutte le categorie di popolazione definite 
\begin_inset Quotes eld
\end_inset

a rischio
\begin_inset Quotes erd
\end_inset

 per le quali viene raccomandata.
 Il vaccino conferisce però limitata 
\emph on
cross-immunity
\emph default
, ovvero immunità per ceppi diversi da quello preso ad obiettivo dal vaccino
 --- ciò comporta la necessità di una vaccinazione quasi ad ogni stagione
 influenzale
\begin_inset CommandInset citation
LatexCommand citep
key "Carrat2007"

\end_inset

.
\end_layout

\begin_layout Standard
Dato la grande variabilità antigenica dei virus dell'influenza, in media
 la composizione dei vaccini è cambiata ogni 2-5 anni a partire dal 1972.
 La composizione raccomandata dei vaccini per l'emisfero nord è decisa a
 febbraio, per l'emisfero sud a settembre, circa mezzo anno prima dell'epidemia
 stagionale, rispettivamente a settembre e a marzo, in modo da precedere
 l'epidemia e garantire la massima copertura per la popolazione.
\end_layout

\begin_layout Standard
I focolai di epidemie localizzate, della durata media dai 3 ai 6 mesi, generano
 la maggior parte delle nuove sequenze virali tramite antigenic drift
\begin_inset CommandInset citation
LatexCommand cite
key "Boni2008"

\end_inset

, per poi diffonderle nel resto del mondo.
 L'effetto del drift è difficile da individuare, per il rimescolamento dei
 virus nella popolazione, per via degli shift, per bias nel processo di
 campionamento, ecc.
 Non si sa se è la somma graduale di mutazioni nel tempo accumulate durante
 le epidemie annuali, o sia un processo puntuato e stocastico che occorre
 al presentarsi di una mutazione che sfugge al controllo dell'immunità acquisita.
 La popolazione dei virus è sottoposta ad un collo di bottiglia evolutivo
 nel periodo estivo, durante il quale la popolazione di organismi infetti
 è minima e determina il ceppo principale della stagione successiva.
 È di notevole interesse scientifico e medico individuare quindi al più
 presto i ceppi dominanti per la stagione epidemica.
\end_layout

\begin_layout Standard
Le raccomandazioni per il vaccino sono compilate dal WHO
\begin_inset CommandInset citation
LatexCommand citep
key "who_vacc"

\end_inset

, tramite il suo Global Influenza Surveillance Network.
 La rete comprende 4 WHO Collaborating Centres (WHO CCs) e 137 istituti
 in 103 stati, riconosciuti dal WHO come Centri Nazionali per l'Influenza
 (NIC).
 I NIC raccolgono campioni nel loro paese, eseguono l'isolamento del virus
 e una caratterizzazione antigenica preliminare.
 Inviano poi i nuovi ceppi isolati per l'analisi genetica e antigenica di
 alto livello alle sedi del WHO, i cui risultati formano la base delle raccomand
azioni.
\end_layout

\begin_layout Standard
Il vaccino è trivalente, protegge contro 3 diversi ceppi virali.
 Per tutte le stagioni il vaccino comprende gli stessi tipi, ma diversi
 ceppi.
 Per la stagione 2012-2013 le raccomandazioni sono le seguenti
\begin_inset CommandInset citation
LatexCommand citep
key "who_vacc"

\end_inset

:
\end_layout

\begin_layout Enumerate
un sottotipo A/H1N1, A/California/7/2009 
\end_layout

\begin_layout Enumerate
un sottotipo A/H3N2, A/Victoria/361/2011 
\end_layout

\begin_layout Enumerate
un tipo B, B/Wisconsin/1/2010 
\end_layout

\begin_layout Standard
Il ceppo è scelto tra i virus dello stesso sottotipo, da un'analisi antigenica
 
\emph on
in vitro
\emph default
.
 I campioni provenienti dai NIC vengono classificati in base alla potenza
 della reazione con l'antisiero sviluppato in furetti a partire dai ceppi
 candidati al vaccino della stagione successiva.
 Il ceppo che ha un numero maggiore di riscontri viene incluso nel vaccino.
 Il criterio è sempre in ritardo, in quanto non è in grado di predire la
 prevalenza dei virus nella stagione successiva, ma solamente indicare qual
 è la più diffusa nella stagione precedente la raccomandazione.
 Negli ultimi anni questo ha causato 6 errori su 19, dove per errori si
 intende la non inclusione del ceppo dominante la stagione epidemica.
 In particolare la raccomandazione per la stagione 2011-2012 era:
\end_layout

\begin_layout Enumerate
un sottotipo A/H1N1, A/California/7/2009 
\end_layout

\begin_layout Enumerate
un sottotipo A/H3N2, A/Perth/16/2009 
\end_layout

\begin_layout Enumerate
un tipo B, B/Brisbane/60/2008 
\end_layout

\begin_layout Standard
la raccomandazione per A/Perth è risultata inappropriata (pur con l'effetto
 mitigante di una parziale cross-immunity), in quanto un numero maggiore
 di casi è stato riportato durante la stagione epidemica per il ceppo A/Victoria
, come predetto dall'algoritmo in 
\begin_inset CommandInset citation
LatexCommand cite
key "burioni2011rohlin"

\end_inset

.
\end_layout

\begin_layout Section
Clustering
\end_layout

\begin_layout Standard
Il 
\emph on
clustering
\emph default
 è definito come il modo di raggruppare oggetti nello stesso cluster sono
 più simili tra loro che a oggetti appartenenti ad altri cluster.
 Gli utilizzi sono molteplici: riconoscere oggetti come simili nonostante
 le differenze, distinguere il primo piano dallo sfondo, ottenere una efficiente
 compressione utilizzando solo l'indicativo del cluster di appartenenza,
 ecc.
 In particolare ci poniamo lo scopo di associare ogni sequenza virale ad
 un cluster, in maniera da poter parlare di 
\begin_inset Formula $k$
\end_inset

 ceppi invece di 
\begin_inset Formula $N$
\end_inset

 sequenze, con 
\begin_inset Formula $k\ll N$
\end_inset

, che è il modo più naturale di ragionare sul problema.
\end_layout

\begin_layout Standard
Una clusterizzazione è una partizione di un insieme, in cui ad ogni elemento
 
\begin_inset Formula $i$
\end_inset

 viene associato in modo rigido a un cluster 
\begin_inset Formula $C$
\end_inset

 di appartenenza:
\begin_inset Formula 
\[
i\to C_{i}
\]

\end_inset

attraverso una opportuna scelta di un criterio, basandosi sui dati ottenuti,
 sulle informazioni aggiuntive che si possono fornire, sul tipo di elementi
 dell'insieme.
 In generale il problema del clustering, ovvero la disposizione degli elementi
 in 
\begin_inset Formula $k$
\end_inset

 cluster in modo tale da minimizzare una funzione globale di costo, è NP
 completo per la natura combinatoria del problema.
 Vi sono molti metodi euristici per ottenere soluzioni approssimate, di
 cui noi abbiamo verificato l'applicabilità, ma una descrizione completa
 è argomento di ricerca a sé stante 
\begin_inset CommandInset citation
LatexCommand citep
key "Hastie2008"

\end_inset

.
\end_layout

\begin_layout Standard
Introduciamo ora il metodo principale utilizzato e anche il confrontato
 con alcuni algoritmi di clustering spettrale.
 Infine studiamo un criterio per decidere in quanti cluster partizionare
 l'insieme di partenza.
\end_layout

\begin_layout Subsection
Clustering gerarchico
\end_layout

\begin_layout Standard
Una classe di algoritmi che prescinde dall'embedding in spazi vettoriali
 è quella 
\emph on
gerarchica, 
\emph default
in particolare
\emph on
 agglomerativa
\emph default

\begin_inset CommandInset citation
LatexCommand citep
key "Gan2007"

\end_inset

: 
\begin_inset Quotes eld
\end_inset

dal basso verso l'alto
\begin_inset Quotes erd
\end_inset

, in cui ogni sequenza è inizialmente considerata come un cluster banale
 e coppie di cluster vengono aggregate man mano che si sale lungo la gerarchia.
\end_layout

\begin_layout Standard
In generale è sufficiente avere un insieme di elementi da clusterizzare
 e una matrice di dissimilarità che serve per indicare come unire i cluster.
 La matrice di dissimilarità deve essere simmetrica a entrate positive --
 criteri esattamente soddisfatti dalla matrice di distanze derivate dalla
 metrica di Rohlin.
 Il procedimento più semplice (anche sub-ottimale) è il seguente:
\end_layout

\begin_layout Enumerate
definiamo n cluster banali, contenenti un solo elemento; in questo modo
 possiamo parlare sempre di cluster, e non distinguere fasi intermedie con
 cluster e elementi ancora non aggiunti.
 
\end_layout

\begin_layout Enumerate
ad ogni iterazione si cercano i due cluster che hanno distanza 
\emph on
minima
\emph default
 tra loro e vengono aggregati in un nuovo cluster binario.
 
\end_layout

\begin_layout Enumerate
si ricalcola la distanza tra il nuovo cluster e tutti i rimanenti
\end_layout

\begin_layout Enumerate
si ripete fino a quanto non è rimasto un unico cluster comprendente tutti
 gli altri
\end_layout

\begin_layout Standard
Rimane da definire la distanza tra due generici cluster 
\begin_inset Formula $\mathcal{A}\text{ e }\mathcal{B}$
\end_inset

:
\end_layout

\begin_layout Itemize
Single linkage: la distanza tra cluster è definita come la minima distanza
 tra le coppie di elementi appartenenti ai due cluster.
\begin_inset Formula 
\[
d(\mathcal{A},\mathcal{B})=\min\left\{ \, d(x,y)\;:\; x\in\mathcal{A},\, y\in\mathcal{B}\right\} 
\]

\end_inset

Non è un buona scelta in quanto la probabilità di aggregazione cresce con
 le dimensioni dei cluster presenti, i primi cluster formati quindi continuano
 a crescere per aggiunta di nuovi elementi -- si forma un albero molto sbilancia
to in cui tutte le sequenze sono aggiunte gradualmente al primo cluster
 (figura 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Single-linkage-clustering"

\end_inset

)
\end_layout

\begin_layout Itemize
UPGMA, o average linkage: si prende la distanza media tra le coppie
\begin_inset Formula 
\[
d(\mathcal{A},\mathcal{B})=\frac{1}{|\mathcal{A}|\cdot|\mathcal{B}|}\sum_{x\in\mathcal{A}}\sum_{y\in\mathcal{B}}\, d(x,y)
\]

\end_inset

con un comportamento intermedio tra single e complete
\end_layout

\begin_layout Itemize
Complete linkage: la distanza è la massima tra tutte le coppie degli elementi
\begin_inset Formula 
\[
d(\mathcal{A},\mathcal{B})=\max\left\{ \, d(x,y)\;:\; x\in\mathcal{A},\, y\in\mathcal{B}\right\} 
\]

\end_inset

i cluster tendono a formarsi di dimensioni simili e ben distinti tra di
 loro, per questo motivo è il criterio da noi scelto
\end_layout

\begin_layout Standard
Dopo l'ultimo passaggio tutti gli elementi si trovano in un unico cluster,
 che ha una struttura altamente non banale, è infatti un albero di sotto-cluster
 -- rappresentabili con un dendrogramma, in cui l'altezza di ogni ramo è
 pari alla distanza tra le foglie.
 Partendo dall'alto e tagliando all'altezza minima possibile si possono
 ottenere 
\begin_inset Formula $p$
\end_inset

 cluster dall'insieme iniziale (figura 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Dendrogramma"

\end_inset

), con un algoritmo completamente generico e dipendente solo dalla matrice
 delle distanze.
 
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/dendrogramma.png
	width 70col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Dendrogramma costruito dai dati sulle distanze delle sequenze del H3N2 (mostrata
 solo parte superiore e non tutte le foglie).
 Sulle ordinate la distanza massima ammessa dal complete linkage per accorpare
 sottocluster; si nota come salendo, cluster diversi si trovano uniti fino
 a che non si raggiunge la massima distanza e l'accorpamento termina.
 Tagliando ad altezze opportune, abbiamo due esempi: un taglio che forma
 due cluster, un taglio che corrisponde ai 6 cluster colorati.
\begin_inset CommandInset label
LatexCommand label
name "fig:Dendrogramma"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Gli algoritmi gerarchici cercano una soluzione approssimata del problema
 del clustering in maniera 
\emph on
greedy
\emph default
 e hanno lo svantaggio che gli elementi una volta associati in un cluster
 non sono più spostati -- un'associazione sub-ottimale in partenza si propaga
 senza correzioni.
 Da qui la necessità del confronto con un altro metodo per avere la conferma
 che i cluster visti non sono stati introdotti dalla scelta del linkage
 completo.
 Il vantaggio della greediness è computazionale, con un andamento in tempo
 
\begin_inset Formula $\mathcal{O}(N^{2})$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "press2007numerical,sibson1973slink"

\end_inset

 e l'utilizzo in memoria solo della matrice delle distanze.
 È possibile fare in un secondo decine di clusterizzazioni utilizzando i
 pacchetti inclusi in Matlab (vi sono reimplementazioni open altrettanto
 performanti in Python e R).
 In codice Matlab, dalla matrice 
\family typewriter
distanza
\family default
, con 
\family typewriter
p
\family default
 clusters richiesti si ottiene il vettore 
\family typewriter
c
\family default
 di etichette intere comprese tra 1 e p:
\begin_inset listings
lstparams "basicstyle={\small\ttfamily},language=Matlab"
inline false
status open

\begin_layout Plain Layout

Z = linkage(squareform(distanza),'complete');
\end_layout

\begin_layout Plain Layout

c = cluster(Z,'maxclust',p);
\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename grafici/singlelinkage.png
	lyxscale 10
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Single linkage clustering, in con il dendrogramma a sinistra e il corrispondente
 grafico delle popolazioni dei cluster a destra -- il clustering è scarsa
 qualità con estremo sbilanciamento della gerarchia
\begin_inset CommandInset label
LatexCommand label
name "fig:Single-linkage-clustering"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Clustering spettrale
\end_layout

\begin_layout Standard
Sotto questo nome cade un'ampia gamma di possibili metodi, basati tutti
 sugli autovettori di un laplaciano discreto opportunamente definito.
 Per un ottima review si veda 
\begin_inset CommandInset citation
LatexCommand citep
key "von2007tutorial"

\end_inset

.
 Gli algoritmi si dividono grosso modo in due categorie:
\end_layout

\begin_layout Itemize
Riduzione dimensionale a partire dagli autovettori del laplaciano
\end_layout

\begin_layout Itemize
Taglio del grafo in sottopartizioni
\end_layout

\begin_layout Standard
Le sequenze che vogliamo clusterizzano formano i vertici di un grafo completo
 pesato 
\begin_inset Formula $G$
\end_inset

, in cui ogni sequenza è collegata ad altre con un peso determinato dalla
 similarità, che possiamo ottenere dalla matrice delle distanze tramite
 la funzione di similarità gaussiana
\begin_inset Formula 
\[
A(i,j)=\begin{cases}
\exp\left(-\frac{d(i,j)}{2\sigma}\right) & \qquad\text{se }d(i,j)\neq0\\
0 & \qquad\text{se }d(i,j)=0
\end{cases}
\]

\end_inset

definita a diagonale nulla, con parametro 
\begin_inset Formula $\sigma$
\end_inset

 che la distanza tra vicini.
 Per ogni vertice 
\begin_inset Formula $i$
\end_inset

 indichiamo il grado, fornito dalla somma dei pesi con tutti gli altri vertici
\begin_inset Formula 
\[
d_{i}=\sum_{j}A_{ij}
\]

\end_inset

e la matrice diagonale ottenuta dai gradi così definiti con D.
\end_layout

\begin_layout Standard
Poiché il grafo è pesato con pesi simmetrici positivi 
\begin_inset Formula $A(i,j)=A(j,i)\geq0$
\end_inset

, è completo e non diretto, possiamo definire il laplaciano nonnormalizzato
 come
\begin_inset Formula 
\[
L=D-A
\]

\end_inset

Il laplaciano ha molte proprietà:
\end_layout

\begin_layout Itemize
\begin_inset Formula $L$
\end_inset

 è simmetrico e definito positivo
\end_layout

\begin_layout Itemize
su ogni vettore 
\begin_inset Formula $f\in\mathbb{R}^{n}$
\end_inset

 agisce come una forma quadratica
\begin_inset Formula 
\[
\left\langle f,L\, f\right\rangle =\sum_{i,j=1}^{n}A_{ij}\left(f_{i}-f_{j}\right)^{2}
\]

\end_inset


\end_layout

\begin_layout Itemize
l'autovalore più piccolo è 0, con autovettore costante 
\begin_inset Formula $(1,1,\dots,1)$
\end_inset

 
\end_layout

\begin_layout Itemize
la molteplicità dell'autovalore 0 è il numero di componenti connesse, ogni
 autovettore è l'equivalente discreto della funzione caratteristica sulle
 componenti connesse, con entrate 1 corrispondenti ai vertici che comprende
 e 0 altrove
\end_layout

\begin_layout Itemize
\begin_inset Formula $L$
\end_inset

 ha autovalori reali nonnulli, 
\begin_inset Formula $0\leq\lambda_{1}\leq\lambda_{2}\leq\dots\leq\lambda_{n}$
\end_inset


\end_layout

\begin_layout Standard
Possiamo anche definite un laplaciano normalizzato come
\begin_inset Formula 
\[
L_{rw}:=I-D^{-1}A
\]

\end_inset

dove il pedice 
\begin_inset Quotes eld
\end_inset

rw
\begin_inset Quotes erd
\end_inset

 è dovuto alla similarità della definizione in problemi di random walk.
 Tutte le proprietà elencate per 
\begin_inset Formula $L$
\end_inset

 valgono anche per 
\begin_inset Formula $L_{rw}$
\end_inset

 invariate, sono solo riscalati gli autovalori.
 Indichiamo con 
\begin_inset Quotes eld
\end_inset

i primi p autovettori
\begin_inset Quotes erd
\end_inset

 gli autovettori corrispondenti agli autovalori 
\emph on
più piccoli
\emph default
 non nulli, ovvero scartando gli autovettori indicatori delle componenti
 connesse.
\end_layout

\begin_layout Subsubsection
Riduzione dimensionale
\begin_inset CommandInset label
LatexCommand label
name "sub:Riduzione-dimensionale"

\end_inset


\end_layout

\begin_layout Standard
L'algoritmo per il clustering di 
\begin_inset Formula $n$
\end_inset

 elementi in 
\begin_inset Formula $p$
\end_inset

 clusters, si basa sulla costruzione di 
\begin_inset Formula $L$
\end_inset

 o 
\begin_inset Formula $L_{rw}$
\end_inset

 ed è il seguente
\begin_inset CommandInset citation
LatexCommand citep
key "shi2000normalized"

\end_inset

:
\end_layout

\begin_layout Enumerate
In input la Matrice di similarità 
\begin_inset Formula $A(i,j)$
\end_inset

 e il numero 
\begin_inset Formula $p$
\end_inset

 di cluster da costruire
\end_layout

\begin_layout Enumerate
Costruiamo la matrice dei gradi D, e il laplaciano 
\begin_inset Formula $L_{rw}=I-D^{-1}A$
\end_inset


\end_layout

\begin_layout Enumerate
Calcolo dei primi 
\begin_inset Formula $p$
\end_inset

 autovettori generalizzati 
\begin_inset Formula $u_{1},\dots,u_{p}$
\end_inset

 del problema agli autovalori 
\begin_inset Formula $L_{rw}\, u=\lambda\, u$
\end_inset


\end_layout

\begin_layout Enumerate
Sia 
\begin_inset Formula $U\in\mathbb{R}^{n\times p}$
\end_inset

 la matrice contenente i vettori 
\begin_inset Formula $u_{1},\dots,u_{p}$
\end_inset

 come colonne.
\end_layout

\begin_layout Enumerate
Per ogni 
\begin_inset Formula $i=1,\dots,n$
\end_inset

 , sia 
\begin_inset Formula $y_{i}\in\mathbb{R}^{p}$
\end_inset

 il vettore corrispondente alla riga 
\begin_inset Formula $i$
\end_inset

-esima di 
\begin_inset Formula $U$
\end_inset

, ovvero ad ogni punto dell'insieme di partenza è stato fatto corrispondere
 un punto in uno spazio vettoriale
\end_layout

\begin_layout Enumerate
Troviamo ora i cluster 
\begin_inset Formula $C_{1},\dots,C_{p}$
\end_inset

 tramite l'algoritmo 
\emph on
k-means 
\emph default
sui punti 
\begin_inset Formula $y$
\end_inset

 di 
\begin_inset Formula $\mathbb{R}^{p}$
\end_inset


\end_layout

\begin_layout Standard
Al punto 5 avviene la cosa più interessante, ad ogni elemento dell'insieme
 iniziale, caratterizzato solo dalle sue relazioni di distanza e similarità
 con gli altri elementi, è stato associato un punto nello spazio 
\begin_inset Formula $\mathbb{R}^{p}$
\end_inset

 -- la riduzione dimensionale permette di utilizzare, se il numero p è piccolo,
 
\emph on
k-means
\emph default
 con successo.
 Abbiamo trovato una rappresentazione funzionale per il clustering.
 
\end_layout

\begin_layout Standard

\emph on
K-means
\emph default

\begin_inset CommandInset citation
LatexCommand citep
before "capitolo 20.1,"
key "mackay2003information"

\end_inset

, è un metodo di clustering per punti di uno spazio vettoriale piuttosto
 semplice che deve il nome al numero 
\begin_inset Formula $k$
\end_inset

 di cluster da generare come parametro di input.
 L'algoritmo cerca di separare gli elementi in gruppi di uguale varianza,
 minimizzando il 
\begin_inset Quotes eld
\end_inset

momento d'inerzia
\begin_inset Quotes erd
\end_inset

 definito come la somma delle distanze dall'elemento centrale di ogni cluster.
 Per ogni cluster si raggruppano gli elementi attorno a dei centri scelti
 inizialmente a random, per poi spostare i punti da un cluster all'altro
 e ricalcolando i centri, fino il momento d'inerzia totale non si stabilizza
 attorno ad un minimo.
 Tuttavia partendo da una soluzione random si raggiunge ogni volta un minimo
 e una clusterizzazione finale diversa, spesso con pessimi risultati.
 
\end_layout

\begin_layout Standard
In figura 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:laplaciano_autovettore"

\end_inset

 illustriamo il risultato su un solo autovettore -- sono già evidenti alcuni
 cluster.
 Gli autovalori invece danno una indicazione di quanto sono connessi tra
 di loro i cluster: primi autovalori piccoli, prossimi allo zero, indicano
 un cluster quasi sconnesso; un grande 
\emph on
gap spettrale
\emph default
 indica invece una migliore coesione dei cluster (figura 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:laplaciano_autovalore"

\end_inset

).
 La conta degli autovalori sotto un certo valore dà un'idea del numero di
 cluster ottimale.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/laplaciano_autovettori.png
	width 90text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Andamento del secondo autovettore del laplaciano normalizzato.
 Il vettore è stato ordinato per valore, in modo che valori simili si trovassero
 vicini -- ciò rende evidente la struttura a gradini, che grossomodo corrispondo
no ai cluster cercati, evidenziata in alcuni casi più evidenti.
\begin_inset CommandInset label
LatexCommand label
name "fig:laplaciano_autovettore"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement tbh
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/laplaciano_autovalori.png
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Primi autovalori del laplaciano normalizzato.
 Vi è un evidente gap tra l'autovalore zero e il primo nonnullo che significa
 una difficile separazione dei dati in cluster.
 Gli autovalori successivi sono molto vicini tra di loro, anche se si potrebbe
 riconoscere ad occhio che i primi 5 sono separati dai successivi, suggerendo
 un numero di cluster almeno pari a 5.
\begin_inset CommandInset label
LatexCommand label
name "fig:laplaciano_autovalore"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Taglio del grafo
\end_layout

\begin_layout Standard
Si può procedere diversamente per partizionare un grafo in cluster: si può
 eseguire un taglio per dividere in due pezzi separati il grafo; si itera
 il procedimento di taglio su ogni sottografo così creato fino a raggiungere
 il numero desiderato di cluster.
 Bisogna cercare un criterio per ottenere un taglio ottimale -- selezionare
 la componente con meno legami con il resto non è sufficiente, in quanto
 il più delle volte si sconnettono punti isolati, come si vede in figura
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Criteri-taglio"

\end_inset

.
 
\begin_inset Float figure
placement tbh
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/spectral_cut.png
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Criteri per il taglio del grafo.
 i) taglio 
\begin_inset Quotes eld
\end_inset

ottimale
\begin_inset Quotes erd
\end_inset

 ii) taglio che conta solo i legami rimossi
\begin_inset CommandInset label
LatexCommand label
name "fig:Criteri-taglio"

\end_inset

.
 Illustrazione tratta da 
\begin_inset CommandInset citation
LatexCommand citep
key "kannan2004clusterings"

\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Introduciamo un paio di definizioni: dati due sottoinsiemi di vertici A
 e B, introduciamo il peso dei legami relativi
\begin_inset Formula 
\[
W(A,B)=\sum_{i\in A,\, j\in B}A(i,j)
\]

\end_inset

Per ogni sottoinsieme del grafo 
\begin_inset Formula $A_{k}$
\end_inset

, con complemento 
\begin_inset Formula $\bar{A}_{k}$
\end_inset

, possiamo definire la cardinalità ed il volume
\begin_inset Formula 
\begin{align*}
|A| & =\text{numero dei vertici in }A\\
\vol(A) & =\sum_{i\in A}d_{i}
\end{align*}

\end_inset

 che pesano rispettivamente il numero di vertici e l'importanza per il resto
 del grafo, misurata in termini di peso dei link.
\end_layout

\begin_layout Standard
Indicando con 
\begin_inset Formula $A_{1},\dots,A_{p}$
\end_inset

 una possibile partizione del grafo il più semplice criterio di taglio è
 quello che trova direttamente la partizione 
\begin_inset Formula $A_{1},\dots,A_{p}$
\end_inset

 che ottimizza il funzionale
\begin_inset Formula 
\[
\cut\left(A_{1},\dots,A_{p}\right)=\frac{1}{2}\sum_{k}W\left(A_{k},\bar{A}_{k}\right)
\]

\end_inset

minimizzando i legami totali tra le parti tagliate e il complementare.
 Tuttavia come si è visto in figura 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Criteri-taglio"

\end_inset

 porta ad un risultato non soddisfacente -- bisogna normalizzare i tagli
 con il volume dei cluster formati, per evitare la formazione di cluster
 isolati.
 Ottimizziamo quindi il funzionale 
\emph on
normalized-cut
\emph default
, o 
\emph on
ncut
\emph default
:
\begin_inset Formula 
\[
\ncut\left(A_{1},\dots,A_{p}\right)=\frac{1}{2}\sum_{k}\frac{W\left(A_{k},\bar{A}_{k}\right)}{\vol\left(A_{k}\right)}=\sum_{k}\frac{\cut\left(A_{k},\bar{A}_{k}\right)}{\vol\left(A_{k}\right)}
\]

\end_inset

che rappresenta il giusto compromesso, normalizzando ogni cluster formato
 con il peso dell'insieme dei legami del cluster.
 Il criterio più popolare in letteratura è il cosiddetto 
\emph on
Rcut
\emph default
, in cui al posto del volume, si normalizza con la cardinalità dei cluster
 formati
\begin_inset Formula 
\[
\operatorname{Rcut}\left(A_{1},\dots,A_{p}\right)=\frac{1}{2}\sum_{k}\frac{W\left(A_{k},\bar{A}_{k}\right)}{\left|A_{k}\right|}
\]

\end_inset

ma non è adatto ai nostri scopi, in quanto tende a selezionare cluster in
 cui il numero dei vertici (delle sequenze per noi) è quanto più simile
 -- sappiamo invece che abbiamo molti dati recenti e pochi dell'inizio anni
 90, per cui cluster 
\begin_inset Quotes eld
\end_inset

vecchi
\begin_inset Quotes erd
\end_inset

 avranno una cardinalità molte volte inferiore ai nuovi.
\end_layout

\begin_layout Standard
La soluzione esatta è nuovamente NP-completa e si cerca uno schema di approssima
zione -- si scopre
\begin_inset CommandInset citation
LatexCommand citep
key "shi2000normalized"

\end_inset


\begin_inset CommandInset citation
LatexCommand citep
before "pag. 12,"
key "von2007tutorial"

\end_inset

 che il modo migliore di approssimare le p partizioni è dato dall'utilizzo
 dell'algoritmo descritto in 
\begin_inset CommandInset ref
LatexCommand vref
reference "sub:Riduzione-dimensionale"

\end_inset

.
 Tuttavia l'utilizzo di k-means può portare in pratica a dei problemi per
 p grandi, come la mancata convergenza di k-means, scelte povere dei centroidi
 iniziali, ecc.
 
\end_layout

\begin_layout Standard
In 
\begin_inset CommandInset citation
LatexCommand citep
key "kannan2004clusterings"

\end_inset

 si dimostra come l'applicazione ricorsiva, utilizzando il secondo autovalore
 del laplaciano per bipartire il grafo, è ottimale e ha 
\emph on
worst-case
\emph default
 garantito -- la bipartizione del grafo è una clusterizzazione in una dimensione
, caso semplice che non ha patologie.
 Chiaramente ad ogni iterazione bisogna costruire il laplaciano e ricalcolare
 il valore dell'autovettore su ogni sottografo considerato, un processo
 che può sembrare lungo, ma nel caso di grafi molto 
\begin_inset Quotes eld
\end_inset

sparse
\begin_inset Quotes erd
\end_inset

 è altamente ottimizzato
\begin_inset CommandInset citation
LatexCommand citep
key "cheng2006divide"

\end_inset

 e rappresenta lo stato dell'arte per il clustering di preferenze commerciali
 (Amazon, ebay, ecc).
\end_layout

\begin_layout Standard
Per il calcolo utilizziamo il software creato per 
\begin_inset CommandInset citation
LatexCommand citep
key "hein2010inverse"

\end_inset

, che ottimizza un diverso funzionale, che tende nuovamente a equilibrare
 la cardinalità dei cluster, tramite una generalizzazione nonlineare del
 laplaciano
\begin_inset Formula 
\[
\left\langle f,L_{k}\, f\right\rangle =\sum_{i,j=1}^{n}A_{ij}\left|f_{i}-f_{j}\right|^{k}
\]

\end_inset

 Il software è comunque in grado di utilizzare il più semplice criterio
 di 
\emph on
ncut
\emph default
 quando k=2 e partizionare ricorsivamente il nostro insieme in maniera estremame
nte efficiente, generando anche tutti i clusters intermedi da 1 e p.
\end_layout

\begin_layout Subsection
Numero ottimale di clusters
\end_layout

\begin_layout Standard
In tutti gli algoritmi di clustering esposti, è necessario stabilire 
\emph on
a priori
\emph default
 il numero dei cluster cercati.
 Questo presenta naturalmente uno problema per scoprire la vera struttura
 dei cluster e non imporla.
 Cerchiamo quindi un criterio che codifichi l'aspettazione naïve nei confronti
 di un buon algoritmo, ovvero che i cluster 
\begin_inset Quotes eld
\end_inset

non siano né troppo grossi, né troppo spezzettati
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
Un modo per ottenere questo, è studiare a posteriori l'entropia dei cluster
 al variare del numero 
\emph on
p
\emph default
 di cluster imposti
\begin_inset CommandInset citation
LatexCommand citep
key "burioni2011rohlin"

\end_inset

.
 I cluster corrispondono a una partizione, per cui è possibile calcolarne
 l'entropia in funzione di 
\emph on
p
\emph default
 con la formula
\begin_inset Formula 
\begin{equation}
H(p)=-\sum_{i=1}^{n}\frac{\left|A_{i}\right|}{N}\ln\frac{\left|A_{i}\right|}{N}
\end{equation}

\end_inset

Per il clustering gerarchico, ci aspettiamo che per p molto piccolo vengano
 separati i cluster più diversi, corrispondenti ai primi rami del dendrogramma.
 Aumentando p, si arriva ad un punto corrispondente al 
\begin_inset Quotes eld
\end_inset

vero
\begin_inset Quotes erd
\end_inset

 numero di cluster, grossi e distinti.
 Crescendo p, ai cluster più grossi vengono rimossi gli 
\begin_inset Quotes eld
\end_inset

outliers
\begin_inset Quotes erd
\end_inset

, piccoli in numero, ma distanti dal grosso del cluster.
 Aumentando sempre di più p, si arriva ad un punto in cui si spezza un grosso
 cluster, provocando un salto nell'entropia.
 L'entropia è per forza strettamente monotona rispetto a p, ma piccoli cluster
 con 
\begin_inset Formula $\sim\nicefrac{1}{N}$
\end_inset

 elementi hanno contributo tendente a zero per 
\begin_inset Formula $N$
\end_inset

 grande; una partizione con due cluster di 
\begin_inset Formula $\frac{N}{2}$
\end_inset

 siti (
\begin_inset Formula $H=\ln2$
\end_inset

), in cui uno viene spezzato a metà, vede aumentare l'entropia di 
\begin_inset Formula 
\[
\Delta H=\frac{1}{2}\ln\frac{1}{2}-2\times\frac{1}{4}\ln\frac{1}{4}=\frac{\ln2}{2}\simeq50\%
\]

\end_inset

Quindi 
\begin_inset Quotes eld
\end_inset

salti
\begin_inset Quotes erd
\end_inset

 nell'entropia indicano la rottura di un grosso cluster, mentre una crescita
 molto lenta con p indica l'allontanamento di elementi poco vicini agli
 altri.
 Il criterio da noi adottato è quindi la scelta di p come il punto in cui
 inizia una lenta crescita dell'entropia, lontano il più possibile da salti,
 ovvero la ricerca di un 
\emph on
plateau
\emph default
 dell'entropia.
 
\end_layout

\begin_layout Standard
L'applicabilità del criterio al clustering gerarchico è dovuta all'
\emph on
effetto valanga
\emph default
 nel taglio del dendrogramma: vi sono p critici per i quali è necessario
 spezzare cluster grossi e p invece che causano solo minime modifiche.
 Il clustering spettrale non tende formare plateau al variare di p, poiché
 l'algoritmo tende a rompere i cluster in modo simile ad ogni passaggio
 
\begin_inset Formula $p\to p+1$
\end_inset

.
\end_layout

\begin_layout Standard
Per il clustering gerarchico, l'applicazione è semplice e dà ottimi risultati,
 come si vede in figura 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:p-entropia"

\end_inset

 in alto a sinistra.
 La scelta della distanza di Rohlin ridotta per partizioni omogenee mette
 in evidenza un grosso plateau, che non è presente scegliendo altre distanze
 -- testimonia ciò la stabilità dei cluster rispetto a piccole variazioni
 in p.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement p
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename grafici/p-gerarchico-h3n2.pdf
	lyxscale 30
	width 90col%

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename grafici/p-gerarchico-h3n2_hamming.pdf
	lyxscale 30
	width 90col%

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Andamento dell'entropia dei cluster generati con algoritmo gerarchico al
 variare di p.
 Le sequenze sono quelle del H3N2 senza deduplicazione, 1470 in totale.
 (A sinistra) la distanza è quella di Rohlin ridotta con partizioni omogenee.
 (A destra) la distanza di Hamming tra sequenze.
\begin_inset Newline newline
\end_inset

Usando la distanza di Rohlin si nota l'inizio del plateau per p=14, che
 prosegue fino a circa 30, indicando la stabilità dei cluster più grossi;
 con la distanza di Hamming l'andamento è meno regolare e il plateau molto
 meno marcato.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:p-entropia"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
placement p
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename grafici/p-spettrale-r.pdf
	lyxscale 30
	width 90col%

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename grafici/p-spettrale-hamming.pdf
	lyxscale 30
	width 90col%

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Andamento dell'entropia dei cluster generati con algoritmo spettrale al
 variare di p.
 (A sinistra) la distanza è quella di Rohlin ridotta con partizioni omogenee.
 (A destra) la distanza di Hamming tra sequenze.
 Nel caso del clustering spettrale il plateau è praticamente assente, per
 il diverso modo in cui vengono scelti i cluster ad ogni p.
\begin_inset CommandInset label
LatexCommand label
name "fig:p-entropia-1"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Non si trovano in letteratura altri criteri perfettamente applicabili al
 nostro caso: 
\begin_inset CommandInset citation
LatexCommand citep
key "kim2008simple"

\end_inset

 studia il caso di 2-3 cluster, perfettamente visibili dal secondo autovettore
 del laplaciano normalizzato, mentre nel nostro caso (come si vede in figura
 
\begin_inset CommandInset ref
LatexCommand vref
reference "fig:laplaciano_autovettore"

\end_inset

) sono riconoscibili solo alcuni raggruppamenti, ma non tutti.
 Un'alternativa possibile per il clustering divisivo tramite taglio del
 grafo, è fermarsi quando il criterio con cui tagliare i cluster non è più
 in grado di fare una scelta accurata -- un'alternativa da esplorare in
 futuri lavori.
\end_layout

\begin_layout Section
Analisi preliminare delle sequenze
\end_layout

\begin_layout Standard
Vi sono numerosi database di materiale genetico dell'influenza, creati attorno
 al 2004 per organizzare in maniera sistematica i risultati del sequenziamento
 nei diversi paesi del mondo e rendere possibili rapide ricerche, confronti,
 analisi tra sequenze virali dell'influenza di ogni tipo.
 I database raccolgono materiale di svariate specie, dalle sequenze più
 antiche, comprendenti quelle del virus della pandemia del 1918 fino alle
 sequenze raccolte l'11 ottobre 2011 --- non sono state ancora caricate
 sequenze della stagione influenzale corrente.
\end_layout

\begin_layout Standard
Vi sono svariati database, tutti permettenti la scelta del sottotipo di
 influenza, delle proteine da visualizzare, la dettagliata provenienza e
 data, tutti finanziati dal NIAID, con sequenze dal Influenza Genome Sequencing
 Project, GenBank e altri database non specializzati, rendendo semplice
 la ricerca, il confronto e l'analisi di molte sequenze diverse:
\end_layout

\begin_layout Description
Influenza
\begin_inset space ~
\end_inset

Research
\begin_inset space ~
\end_inset

Database o IRD, noto anche come FluDB
\begin_inset Foot
status open

\begin_layout Plain Layout
\begin_inset CommandInset href
LatexCommand href
target "http://www.fludb.org"

\end_inset


\end_layout

\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "FluDB"

\end_inset


\end_layout

\begin_layout Description
Influenza
\begin_inset space ~
\end_inset

Virus
\begin_inset space ~
\end_inset

Resource organizzato dal NCBI 
\begin_inset Foot
status open

\begin_layout Plain Layout
\begin_inset CommandInset href
LatexCommand href
target "http://www.ncbi.nlm.nih.gov/genomes/FLU/FLU.html"

\end_inset


\end_layout

\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "NCBI-fludb"

\end_inset


\end_layout

\begin_layout Standard
Per rapportarsi ai risultati in 
\begin_inset CommandInset citation
LatexCommand cite
key "burioni2011rohlin"

\end_inset

 si è scelto le sequenze dal 1993 al presente, raccolte nel continente nord-amer
icano, in cui la emoagglutinina è sequenziata completamente (al massimo
 in paio di 
\begin_inset Quotes eld
\end_inset

buchi
\begin_inset Quotes erd
\end_inset

).
 Quando si è fatto il confronto con le sequenze della neuroaminidasi, sono
 state scelte le sequenze che hanno entrambe le proteine complete.
 
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="2">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Lunghezza
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Conta
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<560
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
564
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
565
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
566
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1617
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Totale
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1624
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
a) HA
\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="2">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Lunghezza
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Conta
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
<465
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
467-468
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
52
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
468
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
52
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
469
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1510
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Totale
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1624
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
b) NA
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Distribuzione delle lunghezze delle sequenze di HA e NA come ottenute dal
 FluDB
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Rimane il problema di cosa fare per le sequenze con 
\begin_inset Quotes eld
\end_inset

buchi
\begin_inset Quotes erd
\end_inset

: l'entropia e la distanza di Rohlin sono ben definite solo se le sequenze
 hanno la stessa lunghezza.
 Abbiamo quindi allineato le sequenze con un software apposito, Muscle
\begin_inset CommandInset citation
LatexCommand cite
key "Edgar2004"

\end_inset

, che inserisce sequenze di simboli '-' nei 
\emph on
gap
\emph default
 per riallineare le sequenze --- prendiamo quindi un alfabeto esteso, che
 comprende i simboli aggiunti.
 Come si vede dalla tabella, il numero dei gap è piccolo se consideriamo
 la proteina HA, e anche nel caso della NA la maggior parte delle sequenze
 non ha gap e meno dell'1% ne ha più di 3.
\end_layout

\begin_layout Standard
L'alfabeto di base 
\begin_inset Formula $\mathbb{K}$
\end_inset

 ha 20 simboli, ai quali si aggiungono 4 simboli che definiscono ambiguità,
 definiti in tabella 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:tabella_ambiguita"

\end_inset

.
 Il simbolo corrispondente ad amminoacido non identificato lo consideriamo
 distinto dal simbolo di allineamento '-'.
 Alla fine 
\begin_inset Formula $\mathbb{K}$
\end_inset

 ha 25 simboli, il che non è un problema, in quanto il metodo di partizionamento
 distingue solo simboli uguali o diversi.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="2">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Amminoacidi ambigui
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Simbolo
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Asparagina o acido aspartico
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
B
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Glutammina o acido glutammico 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Z
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Leucina o isoleucina
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
J
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Non identificato
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
X oppure '.'
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gap introdotto dall'alignment
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
--
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Tabella dei simboli aggiuntivi per l'alfabeto delle proteine
\begin_inset CommandInset label
LatexCommand label
name "tab:tabella_ambiguita"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
C`è da stabilire cosa fare con le sequenze ridondanti, ovvero le sequenze
 ottenute da campioni diversi, con la stessa sequenza di proteine HA e NA
 (se solo una è uguale, le consideriamo sempre distinte), che pure corrispondono
 a una notevole parte di quelle raccolte.
 Le caratteristiche qualitative del clustering non dipendono chiaramente
 dall'avere dei doppioni, poiché sono sicuramente messi nello stesso cluster;
 è utile avere le sequenze con doppioni anche per pesare i cluster e capire
 quali sono i più rilevanti -- la numerosità indica la diffusione del particolar
e ceppo.
 La rimozione dei doppioni va comunque effettuata una volta scaricate le
 sequenze, i database online sono in grado di farla, ma identificano e rimuovono
 separatamente le sequenze corrispondenti a HA e NA, per cui non vi è una
 identificazione 1-1 tra i campioni delle due proteine e non si riesce a
 fare lo studio contemporaneamente.
\end_layout

\begin_layout Standard
Abbiamo quindi vari campioni di sequenze sia per l'influenza di tipo H3N2
 che di tipo H1N1, a seconda delle scelte che si possono fare, elencati
 in tabella 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Numero-di-sequenze"

\end_inset

.
 Non vi sono particolari differenze nei risultati considerando le sequenze
 con o senza doppioni, ogni volta espliciteremo di quale dataset stiamo
 parlando.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="5">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Totale
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Deduplicate
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Ridondanti
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dataset
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
H3N2 usate in 
\begin_inset CommandInset citation
LatexCommand citep
key "burioni2011rohlin"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1470
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
736
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
734 (50%)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
#1
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
H1N1 usate in 
\begin_inset CommandInset citation
LatexCommand citep*
key "burioni2011rohlin"

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2506
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
954
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1552 (62%)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
#2
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
H3N2 dal IRD
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1624
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
908
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
716 (44%)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
#3
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
H1N1 dal IRD
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2908
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1122
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1784 (62%)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
#4
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Numero di sequenze considerate nei vari casi
\begin_inset CommandInset label
LatexCommand label
name "tab:Numero-di-sequenze"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Le sequenze sono molto simili, su una lunghezza media di 566 vi sono al
 massimo 50 lettere mutate tra le sequenze più distanti tra di loro -- solo
 il 10% dei simboli quindi determina la distanza.
 Si vede dalla figura 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:vista-sequenze"

\end_inset

 come da uno sguardo rapido sia difficile individuare le mutazioni.
 
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/sequenze_ha_h3n2.png
	lyxscale 20
	width 100col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Vista della parte iniziale delle sequenze del H3N2, all'incirca 150 simboli
\begin_inset CommandInset label
LatexCommand label
name "fig:vista-sequenze"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

Possiamo fare una mappa 
\begin_inset Quotes eld
\end_inset

caldo-freddo
\begin_inset Quotes erd
\end_inset

 per individuare i siti che mutano maggiormente, chiamati dai biologi 
\emph on
epitopi
\emph default
.
 
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/hot_and_cold.png
	lyxscale 20
	width 100col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Mappa delle mutazioni per ogni sito.
 L'ordine è da sinistra a destra, dall'alto verso il basso.
 Poiché le sequenze sono lunghe 566, fino a 600 sono stati inseriti degli
 0.
 In bianco i siti che non hanno avuto mutazioni, in scuro quelli con più
 cambiamenti -- la quantità rappresentata è l'entropia dei simboli per sito,
 0 dove sono tutti uguali e massima quando due o più amminoacidi hanno la
 stessa frequenza.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
La scelta del partizionamento omogeneo comporta un numero enorme di atomi,
 in generale i simboli tra un sito all'altro sono quasi sempre diversi.
 Si può studiare come si comporta il partizionamento con salto al variare
 del valore massimo di quest'ultimo (figura 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:atomi-vs-fuzzy"

\end_inset

).
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename grafici/atomi_vs_fuzzy.pdf
	width 80col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Andamento del numero di atomi medio per partizione di tipo generale nonconnesso,
 al variare del salto massimo.
 Il numero parte dai 542 atomi medi per atomi connessi e si arriva a 25
 atomi che raggruppano i tutti diversi simboli ammessi nelle sequenze.
\begin_inset CommandInset label
LatexCommand label
name "fig:atomi-vs-fuzzy"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Da questi dati possiamo trarre le seguenti conclusioni, che influenzano
 i tipi di distanza e di clustering scelti:
\end_layout

\begin_layout Itemize
il numero di atomi è poco diverso da L, per l'atomo medio 
\begin_inset Formula $\left\langle |A_{k}|\right\rangle \simeq1$
\end_inset


\end_layout

\begin_layout Itemize
la maggior parte dei siti (e conseguentemente atomi) non cambia da una sequenza
 all'altra 
\end_layout

\begin_layout Itemize
per qualunque tipo di partizionamento, la maggior parte degli atomi sarà
 identica, con una decina di differenze in media
\end_layout

\begin_layout Itemize
la riduzione avrà un effetto preponderante
\end_layout

\begin_layout Section
Scelta della distanza
\end_layout

\begin_layout Standard
Abbiamo molte possibilità per definire una distanza usando i metodi introdotti
 nel primo capitolo, il numero delle diverse combinazioni cresce esponenzialment
e e riassumiamo quelli calcolati ogni volta, come mostrato in tabella 
\begin_inset CommandInset ref
LatexCommand vref
reference "tab:Tabella-distanze-studiate"

\end_inset

.
\begin_inset Float table
placement tbh
wide false
sideways false
status open

\begin_layout Plain Layout
\paragraph_spacing onehalf
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="10" columns="4">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Riduzione
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Entropia
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
#
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="3" alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Distanza di Rohlin con partizionamento omogeneo
\end_layout

\end_inset
</cell>
<cell multirow="3" alignment="left" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Senza
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Shannon
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multirow="4" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Topologica
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multirow="3" alignment="left" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Con
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Shannon
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multirow="4" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Topologica
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="3" alignment="left" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Distanza di Rohlin con tra partizioni 
\begin_inset Quotes eld
\end_inset

con salto
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset
</cell>
<cell multirow="3" alignment="left" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Senza
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Shannon
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multirow="4" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Topologica
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multirow="3" alignment="left" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Con
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Shannon
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multirow="4" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Topologica
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Distanza Hamming
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
N/D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
N/D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
9
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Tabella distanze studiate
\begin_inset CommandInset label
LatexCommand label
name "tab:Tabella-distanze-studiate"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Esploriamo ora le caratteristiche di alcune distanze, mostrando quali scartare
 e perché, per illustrare nella prossima sezione la distanza più adatta
 al problema.
 
\end_layout

\begin_layout Paragraph*
Osservazione matematica
\end_layout

\begin_layout Standard
Possiamo dire quando la distanza di Rohlin è 
\begin_inset Quotes eld
\end_inset

piccola
\begin_inset Quotes erd
\end_inset

: dalle proprietà generali della distanza sappiamo che 
\begin_inset Formula 
\begin{align*}
0 & \leq d_{R}\\
0 & \leq2H(\alpha\vee\beta)-H(\alpha)-H(\beta) & \text{usando la definizione del prodotto}\\
0 & \leq\frac{d_{R}}{H(\alpha)+H(\beta)}\leq1 & \text{con }\alpha,\beta\text{ non entrambe nulle}
\end{align*}

\end_inset

per cui possiamo stimare che se la distanza è piccola o grossa confrontandola
 con l'entropia delle partizioni.
\end_layout

\begin_layout Standard
Ricordiamo che da due distanze è possibile definirne 
\begin_inset Formula $\infty^{2}$
\end_inset

 tramite combinazione lineare a coefficienti costanti positivi, ovvero se
 
\begin_inset Formula $d_{1}$
\end_inset

 e 
\begin_inset Formula $d_{2}$
\end_inset

 sono distanze, lo è anche
\begin_inset Formula 
\[
d(\alpha,\beta)=a_{1}d_{1}(\alpha,\beta)+a_{2}d_{2}(\alpha,\beta)\qquad a_{1},a_{2}>0
\]

\end_inset

per cui sarebbe possibile formare combinazioni lineari tra le distanze trovate,
 pesate opportunamente, per combinare i vantaggi e evidenziare le caratteristich
e cercate.
 L'enorme complessità aggiuntiva non ci ha indotto a perseguire questa strada.
\end_layout

\begin_layout Subsection
Distanza di Hamming
\end_layout

\begin_layout Standard
La distanza di Hamming fornisce una prima ed utile indicazione con cui confronta
re le misure successive.
 La semplice definizione ed il veloce calcolo, la rendono la distanza più
 utilizzata per la ricostruzione degli alberi filogenetici (eventualmente
 viene applicata una funzione della distanza).
 Tuttavia la sola considerazione delle mutazioni sui singoli siti non dà
 molta informazione sul cambiamento funzionale delle proteine coinvolte;
 la distanza risulta avere una componente proporzionale alla distanza temporale
 tra le sequenze -- sappiamo che nel tempo l'antigenic drift accumula differenze
, che rende difficile il riconoscimento dell'emergenza di un strain virale
 realmente nuovo con un numero ridotto di mutazioni antigeniche.
 
\end_layout

\begin_layout Standard
La distribuzione delle distanze di Hamming in figura 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:hist-hamming"

\end_inset

 evidenzia che le mutazioni in quasi 20 anni di dati sulla struttura della
 molecola HA sono raramente più del 10%.
 Il clustering mette in evidenza l'andamento lineare con il tempo, senza
 la possibilità della distinzione di caratteristiche conservate nel tempo
 dai vari ceppi.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename grafici/hist_hamming.pdf
	lyxscale 20
	width 70text%

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset VSpace 1cm
\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename grafici/clusters_hamming.pdf
	width 100col%

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Dati calcolati tramite la distanza di Hamming sulle sequenze della HA dal
 dataset #1.
 (In alto) Distribuzione delle distanze.
 (In basso) Clustering, dal pronunciato carattere lineare del tempo.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:hist-hamming"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Distanza topologica
\end_layout

\begin_layout Standard
La distanza topologica tra due partizioni è calcolata sulla base del numero
 di atomi nel prodotto.
 Si utilizza la formula di Rohlin, con l'entropia definita dal logaritmo
 naturale del numero di atomi, che indichiamo con il simbolo 
\begin_inset Formula $n_{\alpha}$
\end_inset

:
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\lang english

\begin_inset Formula 
\[
d_{\mathrm{R}}^{t}(\alpha,\beta)=2\ln\left(n_{\alpha\vee\beta}\right)-\ln\left(n_{\alpha}\right)-\ln\left(n_{\beta}\right)
\]

\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
\lang italian
Focalizzando l'attenzione sul caso della distanza #2, ottenuta da partizionament
o omogeneo senza riduzione, le partizioni ricavate dalle sequenze hanno
 tutte un numero molto simile di atomi e gli atomi stessi sono in stragrande
 maggioranza comuni ad entrambe le partizioni.
 Il prodotto quindi presenta la stessa parte comune dominante i pochi atomi
 non presenti in una delle due partizioni -- il contributo dei frammenti,
 che viene misurato dalla distanza di Rohlin, è quasi trascurabile rispetto
 alla parte comune, e la distanza tende a zero.
 In più, come si vede in figura 
\begin_inset CommandInset ref
LatexCommand vref
reference "fig:Distribuzione-atomi"

\end_inset

, la distribuzione degli atomi nei prodotti 
\begin_inset Formula $n_{\alpha\vee\beta}$
\end_inset

 è estremamente simile alla distribuzione di 
\begin_inset Formula $n_{\alpha}$
\end_inset

 --- il risultato è che la distanza topologica presenta una variabilità
 ridotta nello studio della distanza tra partizioni molto frammentate con
 una grandissima parte in comune.
 
\begin_inset Float figure
placement tbh
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename grafici/distribuzione_nr_coperture_per_dist_top.pdf
	width 70text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Distribuzione del numero degli atomi, in alto la distribuzione nelle sequenze,
 in basso nei prodotti.
 La scala degli istogrammi è diversa, in quanto a fronte di N=1470 partizioni
 ci sono 
\begin_inset Formula $N^{2}/2$
\end_inset

 prodotti.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:Distribuzione-atomi"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

 La distanza infatti è la differenza del logaritmo di due numeri molto grandi
 vicini e possiamo fare una stima della distanza media
\begin_inset Formula 
\begin{align*}
\left\langle d_{R}^{t}\right\rangle \sim\left\langle 2\ln n_{\alpha\vee\beta}\right\rangle -2\left\langle \ln n_{\alpha}\right\rangle  & =2\ln(544.4)-2\ln(542.4)\\
 & =2\ln\left(\frac{540}{540}\cdot\frac{1+\frac{4.4}{540}}{1+\frac{2.4}{540}}\right)\simeq2\cdot\frac{4.4-2.4}{540}=0.007
\end{align*}

\end_inset

contro i 0.008 misurati usando la vera distribuzione delle distanze, mostrata
 in figura 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Istogrammi-Topologica"

\end_inset

.
 Per avere un'idea se la distanza è soppressa, calcoliamo 
\begin_inset Formula 
\[
\frac{d_{R}^{t}}{2\left\langle \ln n_{\alpha}\right\rangle }\simeq\frac{7\cdot10^{-3}}{6.3}\simeq10^{-4}\ll1
\]

\end_inset

che è molto vicino allo zero; il numero ridotto di combinazioni di 
\begin_inset Formula $n_{\alpha\vee\beta}$
\end_inset

 implica che anche per le sequenze più distanti rispetto ad altre metriche,
 abbiamo una distanza topologica tendente a zero e senza grande variabilità.
 
\end_layout

\begin_layout Standard
La riduzione nelle partizioni connesse su sequenze lineari rimuove la parte
 comune, per cui la distribuzione del numero di atomi è praticamente invariata
 a meno di uno shift nell'intervallo [0,10].
 Facendo una approssimata stima dell'incremento medio della distanza topologica
 grazie alla riduzione si ha 
\begin_inset Formula 
\[
\left\langle R\right\rangle _{\text{stima}}=\frac{\left\langle d_{\mathrm{R}}^{t}(\hat{\alpha},\hat{\beta})\right\rangle }{\left\langle d_{\mathrm{R}}^{t}(\alpha,\beta)\right\rangle }=\frac{2\ln\left(\frac{4.4}{2.4}\right)}{2\cdot\frac{4.4-2.4}{540}}\simeq\ln(1.8)\frac{540}{2}\simeq163
\]

\end_inset

 il dato sperimentale è 
\begin_inset Formula 
\[
\left\langle R\right\rangle _{\text{misura}}=183
\]

\end_inset

per cui l'ipotesi del grossa parte comune che schiaccia la distanza topologica
 è corretta.
 Possiamo quindi essere tranquilli nel scartare questa distanza come poco
 significativa.
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename grafici/hist_topologica_nonridotta.pdf
	width 50text%
	height 6cm
	keepAspectRatio

\end_inset


\begin_inset Graphics
	filename grafici/hist_topologica_ridotta.pdf
	width 50text%
	height 6cm
	keepAspectRatio

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset VSpace 1cm
\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename grafici/clusters_topo.pdf
	lyxscale 20
	width 100col%

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Dati sulla distanza topologica usando le sequenze del H3N2.
 (In alto) Distribuzione istogrammi delle distanze tra le sequenze, nel
 caso (a sinistra) senza riduzione e (a destra) con riduzione.
 (In basso) Clusterizzazione usando la distanza topologica nonridotta, p=14
 per confrontarlo con i clustering successivi, in quanto l'andamento dell'entrop
ia dei cluster non presentava plateau né altri punti notevoli.
\begin_inset CommandInset label
LatexCommand label
name "fig:Istogrammi-Topologica"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Proteine diverse, NA
\end_layout

\begin_layout Standard
Avevamo notato l'esistenza di altri dati, quelli riguardanti le sequenze
 della proteina antigenica 
\emph on
neuraminidasi
\emph default
, perché tutte le misure sono state fatte invece sulla emoagglutinina?
\end_layout

\begin_layout Standard
Un modo rapido per capire i motivi è verificare a che clustering porta una
 distanza eseguita sul NA, come mostrato in figura 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Clustering-na"

\end_inset

: abbiamo forzato p=14, anche se la clusterizzazione naturale indica 
\begin_inset Formula $p=11$
\end_inset

, per poter fare il confronto con i dati della prossima sezione e per meglio
 evidenziare la struttura interna ai cluster.
 Vi è meno struttura per i cluster di questa proteina e ci aspettiamo che
 più strain contro le quali è stato prodotto il vaccino abbiano una NA simile.
 Tuttavia il clustering ricorda molto quello eseguito sul HA, senza sostanziali
 differenze qualitative.
 La distanza di Hamming si dimostra essere uno strumento rozzo per caratterizzar
e l'evoluzione temporale e la comparsa di nuovi ceppi, essendo eccessivamente
 lineare nel tempo.
\end_layout

\begin_layout Standard
Le altre proteine del virus non sono antigeni, non sono cioè sottoposte
 a pressione evolutiva da parte del sistema immunitario e sono estremamente
 conservate rispetto alle proteine sul capside, rendondole meno utili per
 l'identificazione, ma migliori target per futuri vaccini, con studi clinici
 attualmente in corso.
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename immagini/ha_vs_na.png
	width 70col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Scatterplot delle distanze calcolate rispettivamente sulla proteina HA e
 sulla proteina NA, sui due assi.
 Non vi è praticamente correlazione e l'alto numero di punti riduce la probabili
tà a 0.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename grafici/clusters_NA_r.pdf
	width 100col%

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset VSpace 1cm
\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename grafici/clusters_NA_h.pdf
	lyxscale 50
	width 100col%

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Clustering gerarchico agglomerativo basato sulle sequenze della proteina
 NA per virus del sottotipo H3N2, dataset #3 deduplicato.
 Un'analoga misura per il sottotipo H1N1 non mostra alcuna differenza, per
 cui non replichiamo i risultati.
 (In alto) Distanza di Rohlin ridotta con fattori dicotomici lineari (In
 basso) Distanza di Hamming.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:Clustering-na"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
FloatBarrier
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Distanza tra partizioni sconnesse
\end_layout

\begin_layout Standard
Abbiamo mostrato come il numero degli atomi cali molto, al crescere del
 numero di salti possibili.
 Vi sono però notevoli svantaggi, a partire da quello computazionale: le
 partizioni di tipo generico, non connesse, richiedono il doppio del tempo
 per il calcolo dei prodotti e ancora 4 volte tanto per la riduzione.
\end_layout

\begin_layout Standard
Presentiamo ora molte illustrazioni dei comportamenti delle distanze quando
 le partizioni sono lineari ma sconnesse.
 Non consideriamo la distanza topologica, in quanto ancor meno significativa.
 Tutti i casi trattati sono quelli della proteina HA del sottotipo H3N2,
 per poter fare confronti con gli altri.
 
\end_layout

\begin_layout Standard
La riduzione tramite fattori dicotomici universali non raggruppa gli atomi
 consecutivi comuni fino alla prima differenza tra le sequenze, ma raggruppa
 tutti gli atomi comuni in un unico grande atomo sconnesso, frammentato
 dai piccoli (e di poca rilevanza nell'entropia della partizione ridotta)
 superstiti.
 Questo fa sì che il prodotto avrà una entropia molto maggiore rispetto
 al prodotto di partizioni ridotte nel caso connesso.
 Il risultato è un grande fattore di amplificazione, ma una distanza risultante
 poco utile -- troppo peso è dato alla parte comune nascondendo mutazioni
 che differenziano le sequenze.
 In figura 
\begin_inset CommandInset ref
LatexCommand vref
reference "fig:confronto_riduzioni"

\end_inset

 la spiegazione e dettagliato confronto, nel caso di due sequenze costruite
 ad hoc.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement tbh
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename immagini/confronto_riduzioni.png
	width 100col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Dettagliato analisi dei due tipi di riduzione, con fattori lineari connessi
 e fattori dicotomici.
 Quando gli atomi non sono connessi vi è un solo tipo di riduzione possibile,
 il confronto in questo caso serve per chiarire l'effetto molto diverso
 del fattore comune 
\begin_inset Formula $\sigma$
\end_inset

.
 A destra di ogni partizione è indicata l'entropia di Shannon; alla fine
 di ogni blocco usando le entropie illustrate è possibile calcolare la distanza
 di Rohlin corrispondente.
\begin_inset CommandInset label
LatexCommand label
name "fig:confronto_riduzioni"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename grafici/confronto_hist_fuzzy_12.pdf
	lyxscale 20
	width 80col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Confronto degli istogrammi delle distanze tra partizioni 
\begin_inset Quotes eld
\end_inset

con salto
\begin_inset Quotes erd
\end_inset

 sul dataset #1.
 Anche senza riduzione, la possibilità di avere atomi più estesi aumenta
 notevolmente le distanze tra le partizioni.
 La riduzione successivamente livella questa differenza, R=88 nel primo
 caso e R=16.
 Lo studio dettagliato del significato di queste distanze ridotte non è
 stato fatto, perché la clusterizzazione indotta è simile a quella ottenuta
 con Hamming e non presenta informazioni utili.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename grafici/clusters_fuzzy2.pdf
	lyxscale 20
	width 90col%

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset VSpace 1cm
\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename grafici/clusters_fuzzy10r.pdf
	lyxscale 20
	width 90col%

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Illustrazione del clustering utilizzando due diverse distanze, dataset #1.
 (In alto) Distanza su partizioni che ammettono atomi con salto 2, con un
 andamento spiccatamente lineare nel tempo, simile a quanto accade con Hamming.
 (In basso) Salto 10, ma utilizzando le sequenze ridotte -- non vi è più
 una linearità, ma i cluster sono diventati fin troppo estesi temporalmente,
 un altro comportamento che sembra non catturare la natura biologica del
 sistema.
 Questo tipo di partizionamento raggruppano maggiormente l'informazione
 presente nelle sequenze, fino a riottenere un comportamento simile alla
 distanza di Hamming, nel limite in cui si prenda 
\begin_inset Formula $n_{s}$
\end_inset

 massimo.
\begin_inset Newline newline
\end_inset

La distanza tra partizioni ridotta con salto 2 e quella nonridotta con salto
 10 assomigliano alla figura in alto, e non sono state incluse.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
FloatBarrier
\end_layout

\end_inset


\end_layout

\begin_layout Section
Conclusione 
\end_layout

\begin_layout Standard
Con un'attenta analisi di tutte le variazioni, abbiamo scartato 7 distanze
 delle 9 in tabella 
\begin_inset CommandInset ref
LatexCommand vref
reference "tab:Tabella-distanze-studiate"

\end_inset

.
 Siamo arrivati alla conclusione che la distanza migliore, che mette in
 risalto le caratteristiche delle sequenze, ha le seguenti caratteristiche:
\end_layout

\begin_layout Itemize
distanze calcolate tutte sulla proteina HA solamente
\end_layout

\begin_layout Itemize
distanza di Rohlin definita con l'entropia di Shannon
\end_layout

\begin_layout Itemize
partizioni lineari connesse
\end_layout

\begin_layout Itemize
riduzione con fattori lineari
\end_layout

\begin_layout Standard
Vediamo ora di motivare l'ultimo punto: la scelta dei fattori lineari connessi
 è in linea con quanto illustrato nelle figure precedenti.
 L'utilizzo della riduzione con fattori dicotomici ha avuto risultati indesidera
ti, perché i fattori lineari dovrebbero essere migliori? 
\end_layout

\begin_layout Standard
Senza riduzione, visto che quasi tutti gli atomi sono banali, una mutazione
 ha in media scarso effetto -- da un atomo con un solo elemento, si ha nuovament
e un atomo con un solo elemento, le partizioni sono immutate e la distanza
 è zero.
 La distanza di Rohlin non ridotta ha quindi limitato potere risolutivo
 tra le effettive differenze dei ceppi virali.
 
\end_layout

\begin_layout Standard
La riduzione con fattori lineari rimuove i confini degli atomi in comune,
 che sono la maggioranza.
 Lascia quindi i bordi corrispondenti alle mutazioni, formando atomi pari
 al segmento tra una mutazione e la successiva: poiché l'entropia è metrica,
 il peso dipende dalla lunghezza di questi segmenti.
 Nei tratti in cui le mutazioni sono frequenti il peso è naturalmente più
 piccolo, mentre dove sono rare una mutazione è premiata.
 Questo particolare sistema di pesi, che entra nelle distanze tramite i
 prodotti tra partizioni, evidenza le differenze in tratti in cui vi è minore
 entropia e sembra quindi mettere in mostra al meglio le caratteristiche
 biologiche delle sequenze, senza mai però richiedere una conoscenza dei
 meccanismi in gioco.
\end_layout

\begin_layout Standard
\begin_inset VSpace bigskip
\end_inset


\end_layout

\begin_layout Standard
Mostriamo ora i risultati ottenuti usando questa distanza, in linea con
 quanto esposto in 
\begin_inset CommandInset citation
LatexCommand citep
key "burioni2011rohlin"

\end_inset

: abbiamo confermato la scelta della distanza di Rohlin ridotta più semplice.
 Il numero di cluster ottimale p=14 è stato determinato in figura 
\begin_inset CommandInset ref
LatexCommand vref
reference "fig:p-entropia"

\end_inset

 in alto, lo useremo per tutti i clustering qui mostrati.
 I dati provengono tutti dal dataset #1.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename grafici/clusters_HA_r.pdf
	lyxscale 22
	width 100col%

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset VSpace 1cm
\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename grafici/clusters_HA_spettr.pdf
	lyxscale 22
	width 100col%

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Clusters ottenuti con la distanza di Rohlin ridotta, usando fattori dicotomici
 lineari connessi.
 (In alto) Clustering gerarchico agglomerativo, tagliato a p=14.
 (In basso) Clustering spettrale divisivo, fermato al 13 passaggio.
 Si nota la forte somiglianza qualitativa dei due clustering, ottenuti in
 modo completamente diverso.
 Questo rafforza la convinzione dell'effettiva importanza della distanza
 utilizzata per la classificazione delle sequenze di proteine HA.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename grafici/clustering_HA_h1n1.pdf
	lyxscale 22
	width 100col%

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset VSpace 1cm
\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename grafici/clustering_HA_h1n1_spectr.pdf
	lyxscale 22
	width 100col%

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Utilizziamo stavolta il dataset #4 del virus del sottotipo H1N1, con sequenze
 deduplicate.
 (In alto) Clustering gerarchico agglomerativo, tagliato a p=16.
 (In basso) Clustering spettrale divisivo, fermato al 15 passaggio.
 La clusterizzazione è decisamente compatibile e mostra il sorgere di almeno
 8 ceppi distinti di H1N1 nel 2009, anno in cui un antigenic shift portò
 al diffondersi nell'uomo di ceppi novelli, prima diffusi solo in uccelli,
 in competizione tra loro.
 All'avanzare del tempo sono rimasti solo pochi ceppi dominanti -- lo shift
 ha portato una notevole diversità genetica che ha dovuto competere per
 la sopravvivenza.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Chapter
Sistemi magnetici
\end_layout

\begin_layout Standard
In questo capitolo volgiamo l'attenzione all'applicazione della distanza
 di Rohlin su partizioni formate da spin in sistemi di Ising, in particolare
 in una e due dimensioni.
 
\end_layout

\begin_layout Standard
Per un generico reticolo con 
\begin_inset Formula $L$
\end_inset

 siti, in assenza di interazioni con un campo magnetico esterno, l'hamiltoniana
 del problema è
\begin_inset Formula 
\[
H=-\sum_{i,j}\, J_{ij}\sigma_{i}\sigma_{j}\qquad i,j\in\left\{ 1,\dots,L\right\} 
\]

\end_inset

in cui le variabili di spin 
\begin_inset Formula $\sigma$
\end_inset

 assumono solo due possibili valori
\begin_inset Formula 
\[
\sigma_{i}=\left\{ 1,-1\right\} 
\]

\end_inset

e la funzione di partizione è
\begin_inset Formula 
\[
Z_{\beta}=\sum_{\sigma}\exp\left(-\beta H\right)
\]

\end_inset

definendo convenzionalmente la temperatura inversa 
\begin_inset Formula $\beta=\frac{1}{k_{B}T}$
\end_inset

.
 Abbiamo in tutti i casi considerato solo una interazione ai primi vicini
\begin_inset Formula 
\[
J_{ij}=\begin{cases}
\neq0 & \quad d(i,j)=1\\
=0 & \quad d(i,j)>1
\end{cases}
\]

\end_inset

dove 
\begin_inset Formula $d(i,j)$
\end_inset

 indica la distanza tra il sito 
\begin_inset Formula $i$
\end_inset

 e 
\begin_inset Formula $j$
\end_inset

 in termini di passi sul reticolo.
 
\end_layout

\begin_layout Section
Generazione sequenze monodimensionali
\end_layout

\begin_layout Standard
Nel caso monodimensionale il lato del reticolo coincide con il numero di
 siti 
\begin_inset Formula $L$
\end_inset

 e possiamo fissare per il caso ferromagnetico più semplice:
\begin_inset Formula 
\[
J_{i,j}=\delta_{i+1,j}
\]

\end_inset

È vantaggioso considerare la riscrittura in termini di variabili di link
\begin_inset Formula 
\[
l_{i}=\sigma_{i}\sigma_{i+1}\qquad i\in\left\{ 1,\dots,L-1\right\} 
\]

\end_inset

dell'hamiltoniana come
\begin_inset Formula 
\[
H=-J\sum_{i}l_{i}
\]

\end_inset

in cui i gradi di libertà 
\begin_inset Formula $l_{i}$
\end_inset

 sono disaccoppiati tra loro.
 La funzione di partizione anche si decompone
\begin_inset Formula 
\begin{equation}
Z_{\text{catena}}=Z_{\text{link}}^{L}=\left(2\,\cosh\beta\right)^{L}\label{eq:z-catena}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
È estremamente semplice generare sequenze a determinata temperatura.
 Le probabilità dei singoli link fattorizzano in quanto l'hamiltoniana è
 additiva, in particolare la distribuzione di probabilità per la variabile
 
\begin_inset Formula $l_{i}$
\end_inset

 è discreta 
\begin_inset Formula 
\begin{align*}
P(l_{i}=1) & =\frac{e^{-\beta J}}{2\cosh\left(\beta J\right)}=\frac{e^{-2\beta J}}{1+e^{-2\beta J}}\\
P(l_{i}=-1) & =\frac{e^{+\beta J}}{2\cosh\left(\beta J\right)}=1-P(l_{i}=1)
\end{align*}

\end_inset

per cui è possibile direttamente generare la configurazione dei link indipendent
emente facendo un sampling della variabile con probabilità 
\begin_inset Formula $p=P(l_{i}=1)$
\end_inset

:
\end_layout

\begin_layout Enumerate
Generiamo un numero casuale 
\begin_inset Formula $r$
\end_inset

 distribuito uniformemente nell'intervallo, 
\begin_inset Formula $r=\text{\text{Unif}}[0,1]$
\end_inset


\end_layout

\begin_layout Enumerate
se 
\begin_inset Formula $p<r$
\end_inset

, 
\begin_inset Formula $l_{i}=1$
\end_inset


\end_layout

\begin_layout Enumerate
altrimenti 
\begin_inset Formula $l_{i}=-1$
\end_inset


\end_layout

\begin_layout Standard
Per ottenere una configurazione nelle variabili 
\begin_inset Formula $\sigma_{i}$
\end_inset

 bisogna tradurre le variabili di link, ricorsivamente definendo 
\begin_inset Formula $\sigma_{i+1}$
\end_inset

 in termini di 
\begin_inset Formula $\sigma_{i}$
\end_inset


\begin_inset Formula 
\[
l_{i}=\sigma_{i}\sigma_{i+1}\Longrightarrow\sigma_{i+1}=\frac{l_{i}}{\sigma_{i}}=l_{i}\sigma_{i}
\]

\end_inset

la relazione di ricorrenza tuttavia non definisce 
\begin_inset Formula $\sigma_{1}$
\end_inset

 che è indipendente dai link ed è equiprobabile nei valori 
\begin_inset Formula $\pm1$
\end_inset

, per cui è generata con probabilità
\begin_inset Formula 
\begin{align*}
P(\sigma_{1}=1) & =\frac{1}{2}\\
P(\sigma_{1}=-1) & =\frac{1}{2}
\end{align*}

\end_inset

La conta del numero di gradi di libertà torna, poiché vi sono 
\begin_inset Formula $L$
\end_inset

 spin 
\begin_inset Formula $\sigma_{i}$
\end_inset

, ma solo 
\begin_inset Formula $L-1$
\end_inset

 link indipendenti e l'aggiunta del grado di libertà del primo spin 
\begin_inset Formula $\sigma_{1}$
\end_inset

 ci assicura di non vincolare le possibili configurazioni in alcun modo.
\end_layout

\begin_layout Standard
Sfruttando quindi le variabili di link, per 
\begin_inset Formula $J=1$
\end_inset

, si possono generare configurazioni statisticamente indipendenti per ogni
 temperatura in modo estremamente efficiente, generando 
\begin_inset Formula $L$
\end_inset

 numeri casuali e eseguendo 
\begin_inset Formula $L$
\end_inset

 moltiplicazioni per configurazione.
\end_layout

\begin_layout Subsection
Generalizzazione degli accoppiamenti
\end_layout

\begin_layout Standard
Considerando 
\begin_inset Formula $J_{i,i+1}$
\end_inset

 più generici della scelta precedentemente fatta, si può sempre utilizzare
 l'algoritmo sopra illustrato, con delle piccole modifiche.
 Definiamo innanzitutto 
\begin_inset Formula $J_{i}=J_{i,i+1}$
\end_inset

 per alleggerire la notazione.
\end_layout

\begin_layout Standard
Generalizzando 
\begin_inset Formula $J$
\end_inset

 a valori arbitrari, scomporremo 
\begin_inset Formula $J$
\end_inset

 nel modulo e nel segno.
 Innanzitutto se 
\begin_inset Formula $J$
\end_inset

 è distribuito con densità di probabilità 
\begin_inset Formula $f(x)$
\end_inset

 
\begin_inset Formula 
\begin{align*}
P\left(J_{i}=x\right) & =f(x)
\end{align*}

\end_inset

possiamo generare 
\begin_inset Formula $J$
\end_inset

 estraendo uniformemente un numero casuale 
\begin_inset Formula $r$
\end_inset

 nell'intervallo 
\begin_inset Formula $[0,1]$
\end_inset

 e sfruttando la funzione cumulativa di probabilità 
\begin_inset Formula $F(x)$
\end_inset


\begin_inset Formula 
\[
J_{i}=F^{-1}(r)
\]

\end_inset

che ci garantisce la distribuzione opportuna.
 Ridefiniamo i link come 
\begin_inset Formula 
\[
l_{i}=\operatorname{sign}\left(J_{i}\right)\sigma_{i}\sigma_{i+1}
\]

\end_inset

il motivo della scelta di utilizzare solo il segno di 
\begin_inset Formula $J$
\end_inset

 è che vogliamo mantenere sia le variabili 
\begin_inset Formula $l$
\end_inset

 che 
\begin_inset Formula $\sigma$
\end_inset

 discrete, mentre se 
\begin_inset Formula $J$
\end_inset

 variasse una delle variabili assumerebbe valori continui.
\end_layout

\begin_layout Standard
La probabilità di generare un 
\begin_inset Quotes eld
\end_inset

flip
\begin_inset Quotes erd
\end_inset

 nei link ha una probabilità dipendente dall'accoppiamento 
\begin_inset Formula $J_{i}$
\end_inset

 e varia tra da link a link:
\begin_inset Formula 
\[
p(l_{i})=\frac{e^{-2\left|J_{i}\right|\beta}}{1+e^{-2\left|J_{i}\right|\beta}}
\]

\end_inset

il modulo di 
\begin_inset Formula $J$
\end_inset

 è necessario perché il segno è stato usato nella variabile di link.
 Si vede che se 
\begin_inset Formula $|J_{i}|=0$
\end_inset

 allora la distribuzione dei link 
\begin_inset Formula $i$
\end_inset

-esimo è equiprobabile -- risultato compatibile con quanto uno si aspetta
 nel caso in cui gli spin sono disaccoppiati.
\end_layout

\begin_layout Standard
Generato 
\begin_inset Formula $J_{i}$
\end_inset

 e il link corrispondente tra i siti 
\begin_inset Formula $i$
\end_inset

 e 
\begin_inset Formula $i+1$
\end_inset

, riesprimiamo gli spin come
\begin_inset Formula 
\[
\sigma_{i+1}=\mathit{l}_{i}\operatorname{sign}\left(J_{i}\right)\sigma_{i}
\]

\end_inset

sempre generando 
\begin_inset Formula $\sigma_{1}=\pm1$
\end_inset

 con uguale probabilità per inizializzare la relazione di ricorrenza.
 La generalizzazione costa in più solo una estrazione di numeri casuali
 per 
\begin_inset Formula $J_{i}$
\end_inset

, qualche moltiplicazione in più e il calcolo della probabilità 
\begin_inset Formula $p$
\end_inset

 ad ogni sito.
\end_layout

\begin_layout Section
Lunghezza di correlazione
\end_layout

\begin_layout Standard
Nel modello di Ising in una dimensione in assenza di campo magnetico, è
 relativamente semplice calcolare la correlazione tra due spin
\begin_inset Formula 
\[
\left\langle \sigma_{i}\sigma_{j}\right\rangle =\sum_{\sigma}\sigma_{i}\sigma_{j}\,\frac{e^{-\beta H(\sigma)}}{Z_{\beta}}
\]

\end_inset

Qualunque spin 
\begin_inset Formula $\sigma_{j}$
\end_inset

 possiamo scriverlo senza perdita di generalità come 
\begin_inset Formula $\sigma_{i+r}$
\end_inset

, dove 
\begin_inset Formula $r$
\end_inset

 è la distanza in siti sulla sequenza lineare.
 Ricordiamo che le variabili di spin soddisfano alla condizione 
\begin_inset Formula $\sigma^{2}=1$
\end_inset

, per cui possiamo inserire 
\begin_inset Formula $\sigma_{k}^{2}$
\end_inset

 liberamente nell'espressione precedente (inglobiamo J in 
\begin_inset Formula $\beta$
\end_inset

 per semplificare): 
\begin_inset Formula 
\begin{alignat*}{2}
\left\langle \sigma_{i}\,\sigma_{i+r}\right\rangle  & =\frac{1}{Z}\sum_{\sigma}\sigma_{i}\,\sigma_{i+r}\,\exp\left(\beta\sum_{k}l_{k}(\sigma)\right) & (1)\\
 & =\frac{1}{Z}\sum_{\sigma}\sigma_{i}\;\sigma_{i+1}^{2}\cdots\sigma_{i+r-1}^{2}\;\sigma_{i+r}\,\exp\left(\beta\sum_{k}l_{k}(\sigma)\right) & (2)\displaybreak[0]\\
 & =\frac{1}{Z}\sum_{\sigma}\underset{l_{i}}{\underbrace{\sigma_{i}\,\sigma_{i+1}}}\;\,\underset{l_{i+1}}{\underbrace{\sigma_{i+1}\sigma_{i+2}}}\;\sigma_{i+2}\cdots\sigma_{i+r-1}\;\underset{l_{i+r-1}}{\underbrace{\sigma_{i+r-1}\sigma_{i+r}}}\,\exp\left(\beta\sum_{k}l_{k}(\sigma)\right) & (3)\\
 & =\frac{1}{Z}\sum_{\sigma}l_{i}\, l_{i+1}\cdots\, l_{i+r-1}\,\exp\left(\beta\sum_{k}l_{k}(\sigma)\right) & (4)\displaybreak[0]\\
 & =\frac{1}{Z}\sum_{\sigma}\frac{\partial}{\partial\beta_{i}}\,\frac{\partial}{\partial\beta_{i+1}}\cdots\,\frac{\partial}{\partial\beta_{i+r-1}}\,\exp\left(\sum_{k}\beta_{k}l_{k}(\sigma)\right) & (5)\displaybreak[0]\\
 & =\frac{1}{Z}\frac{\partial}{\partial\beta_{i}}\,\frac{\partial}{\partial\beta_{i+1}}\cdots\,\frac{\partial}{\partial\beta_{i+r-1}}\, Z & (6)\displaybreak[0]\\
 & =\frac{1}{Z_{\text{catena}}}\prod_{k=i}^{i+r-1}\frac{\partial}{\partial\beta_{k}}\; Z_{\text{catena}} & (7)\displaybreak[0]\\
 & =\frac{1}{Z_{\text{link }}^{L}}\prod_{k=i}^{i+r-1}\left(\frac{\partial}{\partial\beta_{k}}\; Z_{\text{link}}\right)Z_{\text{link}}^{L-r} & (8)\\
 & =\frac{1}{Z_{\text{link}}^{r}}\left(\frac{\partial}{\partial\beta}\; Z_{\text{link}}\right)^{r} & (9)\displaybreak[0]\\
 & =\frac{2^{r}\sinh^{r}\beta}{2^{r}\cosh^{r}\beta}=\tanh^{r}\beta & (10)\\
 & =\exp\left(r\,\log\left(\tanh\beta\right)\right) & (11)\\
 & =\exp\left(-\frac{r}{\xi}\right)\qquad\text{con }\xi=-\frac{1}{\log\left(\tanh\beta J\right)} & (12)
\end{alignat*}

\end_inset

(2) inserimento 
\begin_inset Formula $r$
\end_inset

 unità, (3) raggruppamento delle 
\begin_inset Formula $\sigma$
\end_inset

 in 
\begin_inset Formula $l$
\end_inset

, (5) utilizzo delle derivate parziali per riscrivere i link supponendo
 che i 
\begin_inset Formula $\beta_{k}$
\end_inset

 varino da link a link, ponendo fine calcolo 
\begin_inset Formula $\beta_{k}=\beta$
\end_inset

 come in partenza, (6) le derivate parziali commutano con la media e si
 ottengono le derivate di 
\begin_inset Formula $Z$
\end_inset

, (8) 
\begin_inset Formula $Z$
\end_inset

 è fattorizzato nei 
\begin_inset Formula $Z_{\text{link }}$
\end_inset

, (9) semplificazione di un fattore 
\begin_inset Formula $Z^{L}$
\end_inset


\begin_inset Formula $ $
\end_inset

 tra numeratore e denominatore, riconoscimento che i fattori del prodotto
 sono 
\begin_inset Formula $r$
\end_inset

 termini uguali per 
\begin_inset Formula $\beta_{k}=\beta$
\end_inset

, (10) esplicitazione di 
\begin_inset Formula $Z_{link}$
\end_inset

 dall'equazione 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:z-catena"

\end_inset

 e calcolo delle derivate, (11) riscrittura in forma esponenziale, (12)
 ripristino di J da 
\begin_inset Formula $\beta$
\end_inset

 e confronto con l'ansatz delle funzioni di correlazione per identificare
 
\begin_inset Formula $\xi$
\end_inset

.
 Nel caso monodimensionale la lunghezza di correlazione non ha singolarità
 nonbanali (solo 
\begin_inset Formula $\beta\to0,\infty$
\end_inset

) e non presenta transizioni di fase.
 Per 
\begin_inset Formula $\beta\gg1$
\end_inset

, si può semplificare l'espressione,
\begin_inset Formula 
\begin{align*}
\xi(\beta)=\left[\log(\tanh\beta J)\right]^{-1} & =\left[\log\left(\frac{e^{\beta J}-e^{-\beta J}}{e^{\beta J}+e^{-\beta J}}\right)\right]^{-1}\\
 & =\left[\log\left(\frac{1-e^{-2\beta J}}{1+e^{-2\beta J}}\right)\right]^{-1}\\
 & =\frac{e^{2\beta J}}{2}
\end{align*}

\end_inset

in figura 
\begin_inset CommandInset ref
LatexCommand vref
reference "fig:riscalamento-temperatura"

\end_inset

 
\begin_inset Formula $\xi$
\end_inset

 appare infatti approssimativamente rettilineo in scala semilogaritmica.
\end_layout

\begin_layout Standard
La media sopra calcolata, è la media sulle configurazioni a data temperatura.
 Tuttavia se 
\begin_inset Formula $J$
\end_inset

 è variabile, con 
\begin_inset Formula $J>0$
\end_inset

, è necessario ricalcolare l'espressione precedente per 
\begin_inset Formula $J$
\end_inset

 generico fissato:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\left.\left\langle \sigma_{i}\,\sigma_{i+r}\right\rangle \right|_{J} & =\frac{1}{Z}\sum_{\sigma}\sigma_{i}\,\sigma_{i+r}\,\exp\left(\beta\sum_{k}J_{k}\, l_{k}(\sigma)\right)\\
 & =\frac{1}{Z}\prod_{k=1}^{i+r-1}J_{k}\;\frac{\partial}{\partial\beta_{k}}\, Z
\end{align*}

\end_inset

per poi mediare su J
\begin_inset Formula 
\begin{align*}
\left\langle \sigma_{i}\,\sigma_{i+r}\right\rangle  & =\int_{a}^{b}dF(J)\left.\left\langle \sigma_{i}\,\sigma_{i+r}\right\rangle \right|_{J}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\lang english
\begin_inset Box Ovalbox
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout

\series bold
\size larger
\color black
POTENZIALI SCEMENZE:
\end_layout

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\lang english
\begin_inset Formula 
\[
\phantom{\left\langle \sigma_{i}\,\sigma_{i+r}\right\rangle }=\int_{a}^{b}dF(J)\; J^{r}\,\tanh^{r}\left(\beta J\right)
\]

\end_inset


\end_layout

\begin_layout Plain Layout
e poiché la lunghezza di correlazione è definibile dal rapporto (valido
 per ogni 
\begin_inset Formula $r$
\end_inset

 nel calcolo)
\begin_inset Formula 
\[
\frac{1}{\xi}=-\frac{\log\left\langle \sigma_{i}\,\sigma_{i+r}\right\rangle }{r}
\]

\end_inset

si ottiene sempre un decadimento a potenza con 
\begin_inset Formula 
\begin{equation}
\frac{1}{\xi}=-\int_{a}^{b}\log\left(J\,\tanh\left(\beta J\right)\right)dF(J)\label{eq:xi-generico}
\end{equation}

\end_inset

L'andamento di 
\begin_inset Formula $\xi$
\end_inset

 a partire dalla formula è piuttosto complesso (figura , anche nel caso
 di distribuzione uniforme nell'intervallo 
\begin_inset Formula $[a,b]$
\end_inset

 vi è forte dipendenza dal limite inferiore per 
\begin_inset Formula $\beta$
\end_inset

 alti e vi è sempre un plateau, corrispondente a 
\begin_inset Formula $-\left(\int_{a}^{b}\log(x)\, dF(x)\right)^{-1}$
\end_inset

.
\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ising/lunghezza_corr_integrale.eps
	lyxscale 50
	width 70text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Lunghezza di correlazione come calcolata tramite la formula 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:xi-generico"

\end_inset

.
 La distribuzione di J è stata presa uniforme nell'intervallo mostrato in
 figura.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
\lang italian

\begin_inset Formula 
\[
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace medskip
\end_inset


\end_layout

\begin_layout Standard
La lunghezza di correlazione rappresenta una distanza in siti sotto la quale
 segmenti di spin sono 
\begin_inset Quotes eld
\end_inset

simili
\begin_inset Quotes erd
\end_inset

 ed è correlata alla taglia dei cluster di spin omogenei -- ci aspettiamo
 che per cluster (nel caso monodimensionale, segmenti) di diametro medio
 
\begin_inset Formula $r$
\end_inset

, prendendo due spin dentro al cluster questi abbiano lo stesso valore e
 che 
\begin_inset Formula $\left\langle \sigma_{i}\;\sigma_{i+k}\right\rangle $
\end_inset

 con 
\begin_inset Formula $k<r$
\end_inset

 medi a 
\begin_inset Formula $1$
\end_inset

.
\end_layout

\begin_layout Subsection
Clusters
\end_layout

\begin_layout Standard
La definizione di un cluster sulla sequenza di spin è relativamente semplice,
 definiamo che 
\begin_inset Formula 
\[
i\sim j\iff\sigma_{i}=\sigma_{i+1}=\dots=\sigma_{j-1}=\sigma_{j}
\]

\end_inset

ovvero se tutti gli spin nel segmento tra 
\begin_inset Formula $i$
\end_inset

 e 
\begin_inset Formula $j$
\end_inset

 sono allineati.
 Nel caso generico, si generalizza dicendo che due spin appartengono allo
 stesso cluster, se vi è un percorso tra 
\begin_inset Formula $i$
\end_inset

 e 
\begin_inset Formula $j$
\end_inset

 sul grafo solo passando su spin allineati.
\end_layout

\begin_layout Standard
Nel caso monodimensionale, è possibile una diversa definizione, basata sui
 link
\begin_inset Formula 
\[
i\sim j\iff l_{i}=l_{i+1}=\dots=l_{j-1}=1
\]

\end_inset

che è equivalente alla precedente, infatti quando in una catena ferromagnetica
 (J=1) due spin contigui hanno lo stesso valore, il link tra loro è 1.
 Nel caso in cui generalizziamo gli accoppiamenti, ovvero 
\begin_inset Formula $J=\pm1$
\end_inset

, nello stesso cluster si possono trovare spin orientati in verso opposto
\begin_inset Formula 
\[
l_{i}=1,\; J_{i}=-1\Longrightarrow i\sim i+1,\;\sigma_{i}=-\sigma_{i+1}
\]

\end_inset


\end_layout

\begin_layout Standard
L'andamento dei 
\begin_inset Formula $J_{i}$
\end_inset

 è leggibile direttamente dalla configurazione della catena di spin per
 
\begin_inset Formula $\beta\to+\infty$
\end_inset

, nel qual caso tutti i link 
\begin_inset Formula $-1$
\end_inset

 che aumentano l'energia sono soppressi, e 
\begin_inset Formula 
\[
J_{i}=\frac{\sigma_{i+1}}{\sigma_{i}}
\]

\end_inset

per tutti gli spin sono allineati, se 
\begin_inset Formula $J=1$
\end_inset

.
 Nei casi in cui è possibile estrarre gli accoppiamenti arbitrariamente
 vicini a zero con probabilità nonnulla 
\begin_inset Formula 
\[
P\left(J_{i}<\epsilon\right)>0,\forall\epsilon>0
\]

\end_inset

il comportamento è qualitativamente molto diverso: il cluster anche a temperatur
a nulla si può spezzare (il link può risultare -1) in quanto il prezzo in
 energia corrispondente 
\begin_inset Formula $\Delta E=2\, J\to0$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset VSpace medskip
\end_inset


\end_layout

\begin_layout Standard
Definendo la lunghezza di correlazione tramite il decadimento della correlazione
 tra spin, questa è automaticamente 0 nel caso di 
\begin_inset Formula $J=\pm1$
\end_inset

, infatti nel caso a temperatura nulla
\begin_inset Formula 
\[
\left.\left\langle \sigma_{i}\sigma_{i+1}\right\rangle \right|_{\sigma,\, J}=\left.\left\langle J_{i}\right\rangle \right|_{J}=0=\lim_{\xi\to0}e^{-\frac{1}{\xi}}
\]

\end_inset

Abbiamo indicato nell'espressione sopra la media sia sulle configurazioni,
 che sulla distribuzione di 
\begin_inset Formula $J$
\end_inset

.
\end_layout

\begin_layout Standard
Tuttavia è possibile recuperare la definizione di lunghezza di correlazione
 tramite la caratterizzazione dei clusters, che è ricavabile senza fare
 una media.
\end_layout

\begin_layout Section
Correlazione a partire dai cluster
\end_layout

\begin_layout Standard
In questo caso, andremo a considerare tratti di sequenze lunghe 
\begin_inset Formula $L$
\end_inset

 indipendenti, estratti con la rispettiva probabilità dipendente dal parametro
 
\begin_inset Formula $\beta$
\end_inset

, usando il metodo precedentemente descritto.
 Su ogni sequenza di spin, eseguiamo il raggruppamento in cluster, definiamo
 ovvero una mappa tra la sequenza e lo spazio delle partizioni 
\begin_inset Formula $\mathcal{C}\to\mathcal{Z}$
\end_inset

.
 Tra le partizioni conosciamo una metrica, definita dalla distanza di Rohlin
 (equazione 
\begin_inset CommandInset ref
LatexCommand vref
reference "eq:distanza_rohlin"

\end_inset

): possiamo quindi misurare distanze tra sequenze basandoci non sulle variabili
 di spin, ma sfruttando i clusters di queste.
 
\end_layout

\begin_layout Standard
Possiamo fare una caratterizzazione qualitativa al variare della temperatura:
\end_layout

\begin_layout Itemize
a temperatura nulla (
\begin_inset Formula $\beta\to\infty$
\end_inset

), vi è un solo cluster che comprende tutti i siti, per cui la distanza
 è nulla;
\end_layout

\begin_layout Itemize
in una situazione in cui i siti sono fortemente correlati, cioè quando la
 lunghezza della sequenza è inferiore alla taglia media dei cluster, 
\begin_inset Formula $L\ll\xi$
\end_inset

, ci aspettiamo una scomposizione in pochi cluster dovuti a flip termici
 negli spin -- una situazione di piccola distanza; 
\end_layout

\begin_layout Itemize
crescendo in temperatura (diminuendo 
\begin_inset Formula $\xi$
\end_inset

) o allungando le sequenze (aumentando 
\begin_inset Formula $L$
\end_inset

), abbiamo sequenze in cui il numero cluster è in aumento rispetto alla
 lunghezza della sequenza
\begin_inset Formula 
\[
0\ll\frac{n}{L}<1
\]

\end_inset

i clusters sono distribuiti casualmente e la distanza tra partizioni cresce;
\end_layout

\begin_layout Itemize
a temperatura infinita (
\begin_inset Formula $\beta\to0$
\end_inset

), gli spin sono estratti casualmente e i cluster comprenderanno in media
 un sito solo, con distanza massima tra due partizioni;
\end_layout

\begin_layout Standard
La clusterizzazione è definita come nella sezione precedente, basandosi
 su valori contigui di spin.
 Questo riproduce il comportamento predetto e la distanza di correlazione
 calcolata in questo modo per 
\begin_inset Formula $J=1$
\end_inset

 segue quella definibile analiticamente in funzione di 
\begin_inset Formula $\beta$
\end_inset

.
 In figura 
\begin_inset CommandInset ref
LatexCommand pageref
reference "fig:Andamento-della-distanza"

\end_inset

 abbiamo l'andamento per una temperatura 
\begin_inset Quotes eld
\end_inset

media
\begin_inset Quotes erd
\end_inset

 -- ricordiamo che possiamo misurare le distanze solo in modo discreto,
 non continuo, a passi di 
\begin_inset Formula $\Delta L=1$
\end_inset

, per cui se 
\begin_inset Formula $\xi\sim1$
\end_inset

 non abbiamo sufficiente risoluzione e abbiamo preso 
\begin_inset Formula $\beta=1.8$
\end_inset

 in quanto 
\begin_inset Formula $L(\xi)=35$
\end_inset

.
 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ising/andamento_lunghezza.eps
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Andamento della distanza media misurata tra le partizioni su sequenze lunghe
 
\begin_inset Formula $L$
\end_inset

, estratte a temperatura fissata.
 Si nota per 
\begin_inset Formula $L<10$
\end_inset

 una crescita lenta, un periodo intermedio per 
\begin_inset Formula $L\sim\xi$
\end_inset

, un plateau finale ad alta temperatura quando la dissimilarità non può
 crescere e la distanza si stabilizza.
 La linea continua è la funzione di fit di equazione 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:fit-erf"

\end_inset

.
\begin_inset CommandInset label
LatexCommand label
name "fig:Andamento-della-distanza"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Il semplice metodo per il calcolo della distanza media è il seguente:
\end_layout

\begin_layout Enumerate
Estrazione di 
\begin_inset Formula $J$
\end_inset

 con la statistica desiderata, o costanti.
\end_layout

\begin_layout Enumerate
Generazione di N sequenze indipendenti a fissato 
\begin_inset Formula $J$
\end_inset

,
\begin_inset Formula $L$
\end_inset

 e 
\begin_inset Formula $\beta$
\end_inset


\end_layout

\begin_layout Enumerate
Partizionamento delle N sequenze e misura delle 
\begin_inset Formula $\frac{N(N-1)}{2}$
\end_inset

 distanze di Rohlin ridotte (algoritmi nella sezione a pagina 
\begin_inset CommandInset ref
LatexCommand pageref
reference "sec:Partizioni-connesse"

\end_inset

) e media
\end_layout

\begin_layout Enumerate
Eventuale ripetizione dei passi 1 e 2, generando configurazioni con J diversi
 se richiesto, fino ad ottenere una media stabile
\end_layout

\begin_layout Standard
Il risultato è un punto di parametri (
\begin_inset Formula $\left\langle d_{R}\right\rangle ,\,\beta,\, L$
\end_inset

) e possiamo rappresentare le curve al variare di 
\begin_inset Formula $L$
\end_inset

 con 
\begin_inset Formula $\beta$
\end_inset

 parametro, come illustrato in figura 
\begin_inset CommandInset ref
LatexCommand vref
reference "fig:andamento-temp"

\end_inset

.
 Si nota come le curve sembrano spostarsi linearmente (su scala logaritmica
 di 
\begin_inset Formula $L$
\end_inset

, quindi esponenzialmente in realtà) verso destra, ovvero l'andamento è
 riscalato al variare della temperatura.
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ising/confronto_temperature.eps
	lyxscale 80
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Confronto degli andamenti per diverse temperature.
 Le curve che raggiungono il massimo più velocemente sono quelle con 
\begin_inset Formula $\xi$
\end_inset

 minore, ovvero 
\begin_inset Formula $\beta$
\end_inset

 più piccolo, a sinistra in figura.
 Si nota il plateau pronunciato per ogni temperatura, raggiunto a lunghezze
 diverse.
 Le curve sono state campionate in 
\begin_inset Formula $L$
\end_inset

 fino al raggiungimento di un punto in cui la crescita era eccessivamente
 lenta e dispendiosa in risorse, sempre però dopo aver superato il flesso
 per permettere il corretto fit e individuazione dell'altezza media
\begin_inset CommandInset label
LatexCommand label
name "fig:andamento-temp"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset

 
\begin_inset Newline newline
\end_inset

Questo suggerisce che le curve siano tutte sovrapponibili, se opportunamente
 riscalate in ascisse -- il parametro per il riscalamento è la distanza
 
\begin_inset Formula $\tilde{L}$
\end_inset

 corrispondente a mezza distanza massima, mostrato con un punto rosso in
 figura 
\begin_inset CommandInset ref
LatexCommand vref
reference "fig:Andamento-della-distanza"

\end_inset

, corrispondente al punto di flesso, passaggio tra i regimi di cluster sulla
 sequenza.
 Per avere un'idea precisa, abbiamo eseguito un fit su ogni curva, con la
 seguente formula empirica
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
s(x)=\left(a_{1}\operatorname{Erf}\left(\frac{\log(x)-a_{2}}{a_{3}}\right)+a_{4}\right)\left(\log\, x\right){}^{a_{5}}\label{eq:fit-erf}
\end{equation}

\end_inset

con lo scopo di interpolare correttamente l'andamento della funzione, senza
 esigenze predittive, con un insieme di parametri scelto per ottenere un
 risultato soddisfacente.
 La funzione Erf (error function, integrale della gaussiana) riproduce l'andamen
to a sigmoide della curva, opportunamente ricentrata su scala logaritmica,
 mentre il fattore 
\begin_inset Formula $x^{a_{5}}$
\end_inset

 (sempre su scala logaritmica) serve per imporre lo zero per 
\begin_inset Formula $L\to0$
\end_inset

, non ottenibile con la sola error function.
 L'accordo con soli 5 parametri è eccellente su tutte le scale di lunghezza
 e temperatura -- fornisce inoltre una stima del flesso che si ha quando
 l'argomento della error function è 0:
\begin_inset Formula 
\[
\tilde{L}=e^{a_{2}}
\]

\end_inset

La stima è successivamente raffinata sfruttando la funzione interpolante,
 cercando numericamente gli zeri di
\begin_inset Formula 
\[
z(\tilde{L})=s(\tilde{L})-0.7=0\iff\tilde{L}=s^{-1}(0.7)
\]

\end_inset

con la scelta di 0.7 come metà altezza per tutte le curve, un valore funzionante
 indipendentemente dalla temperatura e robusto a piccole variazioni -- usando
 0.6 o 0.8 il valore è chiaramente diverso, ma varia allo stesso modo con
 la temperatura.
 Verifichiamo l'ipotesi del corretto riscalamento delle curve -- ovvero
 che siano sovrapponibili nell'argomento 
\begin_inset Formula $L/\tilde{L}$
\end_inset

, ipotesi perfettamente verificata in figura 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ising/confronti_riscalato.eps
	lyxscale 70
	width 70text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Distanza media graficata rispetto al parametro 
\begin_inset Formula $L/\tilde{L}$
\end_inset

, per molte curve diverse in un ampio range di temperature -- sono le stesse
 di figura 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:andamento-temp"

\end_inset

 riscalate.
 L'ottima sovrapposizione è spiegata dalla concordanza di 
\begin_inset Formula $\tilde{L}$
\end_inset

 con 
\begin_inset Formula $\xi$
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Vediamo ora l'andamento in temperatura di 
\begin_inset Formula $\tilde{L}(\beta)$
\end_inset

, che dovendo rappresentare una lunghezza di autosimilarità del sistema
 di Ising monodimensionale, deve essere proporzionale a 
\begin_inset Formula $\xi$
\end_inset

:
\begin_inset Formula 
\[
\tilde{L}\propto\xi
\]

\end_inset

non si può fare di meglio, in quanto la scelta esatta di 
\begin_inset Formula $\tilde{L}$
\end_inset

 dipende dal criterio scelto, dalla scelta dell'altezza, dal clustering,
 mentre 
\begin_inset Formula $\xi$
\end_inset

 è universale.
 Tuttavia possiamo fissare la proporzionalità per un valore particolare
\begin_inset Formula 
\[
\tilde{L}(\beta=2)=\xi(\beta=2)
\]

\end_inset

e confrontare a tutte le altre temperature per verificare la bontà del rapporto,
 come mostriamo in figura 
\begin_inset CommandInset ref
LatexCommand vref
reference "fig:riscalamento-temperatura"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ising/ordinato_riscalamento.eps
	lyxscale 50
	width 85text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Andamento del parametro di riscalamento in funzione di 
\begin_inset Formula $\beta$
\end_inset

, confrontato con l'attesa 
\begin_inset Formula $\xi$
\end_inset

.
 Si nota come 
\begin_inset Formula $\tilde{L}$
\end_inset

 si differenzia quando 
\begin_inset Formula $\xi<1$
\end_inset

: misurando le sequenze con 
\begin_inset Formula $L$
\end_inset

 intero, non possiamo esplorare questa regione e automaticamente 
\begin_inset Formula $\tilde{L}\to1$
\end_inset

.
 Questo è un effetto della discretizzazione del reticolo studiato, la cui
 dimensione non è trascurabile per la fisica quando è confrontabile con
 
\begin_inset Formula $\xi$
\end_inset

.
\begin_inset CommandInset label
LatexCommand label
name "fig:riscalamento-temperatura"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Riduzione e sequenze disordinate
\end_layout

\begin_layout Standard
Nella precedente sezione abbiamo dimostrato come la definizione di una lunghezza
 di correlazione usando il flesso della distanza di Rohlin tra clusters
 riproduce esattamente il caso risolvibile analiticamente.
 
\end_layout

\begin_layout Standard
Nel caso di sequenze con 
\begin_inset Formula $J=\pm1$
\end_inset

 o più in generale anche con 
\begin_inset Formula $\left|J\right|\neq1$
\end_inset

, la clusterizzazione omogenea dà scarsi risultati -- sappiamo infatti anche
 nel caso di sequenze di amminoacidi come l'estrema frammentazione renda
 difficile il confronto tra partizioni.
 Similmente viene in aiuto la riduzione: 
\end_layout

\begin_layout Itemize
il groundstate è un unico cluster
\end_layout

\begin_layout Itemize
a temperatura finita si possono avere link con 
\begin_inset Formula $l_{i}=-1$
\end_inset


\end_layout

\begin_layout Itemize
i link -1 formano i bordi dei cluster fisici
\end_layout

\begin_layout Itemize
anche tutti i 
\begin_inset Formula $\sigma_{i+1}\neq\sigma_{i}$
\end_inset

 vengono interpretati inizialmente come un bordo e si formano dei cluster
 molto spezzettati, tuttavia la riduzione con le altre partizioni sulla
 stessa sequenza, generati con gli stessi 
\begin_inset Formula $J$
\end_inset

, rimuove i bordi in comune -- a bassa temperatura, rimangono in media solo
 
\begin_inset Formula $pL$
\end_inset

 link sfavorevoli energeticamente per sequenza e la partizione intersezione
 rappresenta una stima del ground state, migliore quanto è minore la temperatura
\end_layout

\begin_layout Standard
La riduzione in questo caso è fatta usando le partizioni dicotomiche per
 sequenze lineari connesse (a pagina 
\begin_inset CommandInset ref
LatexCommand pageref
reference "sec:Partizioni-connesse"

\end_inset

).
 I risultati sono quelli sperati: la differenza tra 
\begin_inset Formula $J=\pm1$
\end_inset

 sparisce, i clusters fisici sono riconosciuti e l'andamento di 
\begin_inset Formula $\tilde{L}$
\end_inset

 è indistinguibile da quello ottenuto per 
\begin_inset Formula $J=1$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center

\family typewriter
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "80col%"
special "none"
height "1in"
height_special "totalheight"
status collapsed

\begin_layout Plain Layout

\family typewriter
Sequenza 1:  - - + - + - + - - + - - - + - 
\end_layout

\begin_layout Plain Layout

\family typewriter
Sequenza 2:  - - + - - + - + + - + + + - +
\end_layout

\begin_layout Plain Layout

\family typewriter
Partizione1:
\color black
|
\color red
- -
\color black
|
\color blue
+
\color black
|
\color red
-
\color black
|
\color blue
+
\color black
|
\color red
-
\color black
|
\color blue
+
\color black
|
\color red
- -
\color black
|
\color blue
+
\color black
|
\color red
- - -
\color black
|
\color blue
+
\color black
|
\color red
-
\color inherit
|, n=11
\end_layout

\begin_layout Plain Layout

\family typewriter
Partizione2:
\color black
|
\color blue
- -
\color black
|
\color red
+
\color black
|
\color blue
- -
\color black
|
\color red
+
\color black
|
\color blue
-
\color black
|
\color red
+ +
\color black
|
\color blue
-
\color black
|
\color red
+ + +
\color black
|
\color blue
-
\color black
|
\color red
+
\color inherit
|, n=10
\end_layout

\begin_layout Plain Layout

\family typewriter
P.
 ridotta1:
\color black
|
\color red
- -
\color inherit
 
\color blue
+
\color inherit
 
\color red
-
\color black
|
\color blue
+
\color inherit
 
\color red
-
\color inherit
 
\color blue
+
\color inherit
 
\color red
- -
\color inherit
 
\color blue
+
\color inherit
 
\color red
- - -
\color inherit
 
\color blue
+
\color inherit
 
\color red
-
\color black
|,
\color red
 
\color black
n=2
\end_layout

\begin_layout Plain Layout

\family typewriter
P.
 ridotta2:
\color black
|
\color blue
- -
\color red
 +
\color blue
 - -
\color red
 +
\color blue
 -
\color red
 + +
\color blue
 -
\color red
 + + +
\color blue
 -
\color red
 +
\color inherit
|, n=1
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Rappresentazione testuale di due sequenze e delle partizioni: la prima è
 nel groundstate, la seconda ha un link posto a -1, il risultato è che la
 seconda metà degli spin è diversa.
 La rappresentazione in termini di partizioni mostra che sono in realtà
 molto simili, la riduzione rende lampante l'effettivo clustering.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Effettivamente la riduzione non è solo un aiuto, ma è necessaria -- altrimenti
 non è riconoscibile il corretto andamento con la temperatura.
 Questo è semplicemente comprensibile: le configurazioni di spin anche a
 temperatura zero con la clusterizzazione omogenea presentano massima frammentaz
ione, l'aumento della temperatura non può ulteriormente aumentare la distanza,
 che già è massima, il plateau viene raggiunto troppo rapidamente e largamente
 indipendentemente dalla temperatura.
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ising/disordinato_riscalamento.eps
	lyxscale 50
	width 70text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Andamento del parametro di riscalamento in funzione di 
\begin_inset Formula $\beta$
\end_inset

, confrontato con l'attesa 
\begin_inset Formula $\xi$
\end_inset

, per il caso disordinato più semplice, con 
\begin_inset Formula $J=\pm1$
\end_inset

.
 L'andamento è identico e quello del caso con 
\begin_inset Formula $J=1$
\end_inset

 e coincidente con la previsione proporzionale a 
\begin_inset Formula $\xi$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
J con modulo arbitrario
\end_layout

\begin_layout Standard
Come precedentemente accennato, il caso in cui 
\begin_inset Formula $J$
\end_inset

 può avvicinarsi a 0 diventa qualitativamente diverso dai precedenti, mentre
 per J mai nullo, si recupera gli andamenti precentemente visti, con 
\begin_inset Formula $\beta$
\end_inset

 riscalato in 
\begin_inset Formula $\beta\left\langle J\right\rangle $
\end_inset

.
 Precisiamo che l'andamento della distanza, per 
\begin_inset Formula $\beta$
\end_inset

 fissato rimane sempre lo stesso, quello che cambia è come la curva riscala
 al variare di 
\begin_inset Formula $\beta$
\end_inset

.
\end_layout

\begin_layout Standard
Vediamo innanzitutto quest'ultimo caso: abbiamo generato J con probabilità
 uniforme in intervalli che escludono lo zero, 
\begin_inset Formula $\tilde{L}(\beta)$
\end_inset

 è compatibile con 
\begin_inset Formula $\tilde{L}|_{J=1}\left(\beta\left\langle J\right\rangle \right)$
\end_inset

, anche se le discrepanze suggeriscono un modello meno semplice, con una
 dipendenza non solo dalla media.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ising/confronto_temperature_j1.25.eps
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Andamento delle distanze per 
\begin_inset Formula $\beta=\{0.2,\,0.4,\dots,\,1.8,\,2.0\}$
\end_inset

.
 In questo caso 
\begin_inset Formula $J\in[1,\,1.5]$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ising/confronto_j_rand_nonnull.eps
	width 85text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Funzione 
\begin_inset Formula $\tilde{L}(\beta)$
\end_inset

 per sequenze generate con 5 tipi diversi di J.
 Al centro J=1, sopra J con media superiore a 1, sotto con media inferiore.
 La retta interpolante sovrapposta a ciascuno mostra che il comportamento
 per 
\begin_inset Formula $\beta$
\end_inset

 non troppo piccoli è come atteso.
\begin_inset CommandInset label
LatexCommand label
name "fig:nonnullo-riscalamento"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left\langle J\right\rangle $
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pendenza retta
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
rapporto con J=1
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[1.5,2.5]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.55
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.8
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[1.0,1.5]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.25
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.23
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[0.5,1.0]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.75
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.65
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[0.25,0.75]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.65
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.3
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Analisi risultati della figura 
\begin_inset CommandInset ref
LatexCommand vref
reference "fig:nonnullo-riscalamento"

\end_inset

, con la pendenza della retta ricavata dal fit e il confronto con la pendenza
 della curva per J costante.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace medskip
\end_inset


\end_layout

\begin_layout Standard
Il caso in cui 
\begin_inset Formula $J$
\end_inset

 è vicino allo zero diventa già complicato, in figura mostriamo l'andamento
 fortemente nonlineare (in scala semilogaritmica) di 
\begin_inset Formula $\tilde{L}(\beta)$
\end_inset

 quando 
\begin_inset Formula $J$
\end_inset

 è estratto uniformemente nell'intervallo [0.05,0.55].
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ising/j_minigap.eps
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Andamento anomalo quando il gap dallo zero è ridotto; per 
\begin_inset Formula $\beta$
\end_inset

 molto alti l'andamento è esponenziale, mentre per 
\begin_inset Formula $\beta\to0$
\end_inset

 esso non è né a potenza, né lineare, ma sembra esponenziale con un diverso
 coefficiente.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace medskip
\end_inset


\end_layout

\begin_layout Standard
Il caso di 
\begin_inset Formula $J$
\end_inset

 random con possibilità di raggiungere lo zero è invece ancora differenze:
 l'andamento in 
\begin_inset Formula $\beta$
\end_inset

 è lineare.
 Il cambio di tipo di legge è dovuto proprio alla possibilità di rompere
 cluster indipendentemente dalla temperatura.
 Abbiamo fatto 3 prove:
\end_layout

\begin_layout Itemize
J gaussiano, prendendo una gaussiana con media 0, deviazione standard 1,
 
\begin_inset Formula $J$
\end_inset

 anche negativo, per cui distanza con riduzione
\end_layout

\begin_layout Itemize
J semigaussiano, prendendo 
\begin_inset Formula $J$
\end_inset

 dal modulo di numeri distribuiti gaussianamente, senza riduzione
\end_layout

\begin_layout Itemize
J uniforme nell'intervallo [0,1], distanza di Rohlin senza riduzione
\end_layout

\begin_layout Standard
Gli andamenti sono praticamente identici, la natura esatta della distribuzione
 non sembra giocare un ruolo quindi (le medie dei moduli sono comparabili
 però), il ruolo fondamentale è giocato dai 
\begin_inset Formula $J$
\end_inset

 piccoli.
 Siamo inoltre sicuri che sia effettivamente un andamento rettilineo --
 punti isolati calcolati per 
\begin_inset Formula $\beta$
\end_inset

 molto alto avrebbero messo in evidenza deviazioni dalla linearità, che
 non sono comparse.
 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ising/andamento_lineare.eps
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ising/andamento_lineare_gaussiana.eps
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Lunghezza di correlazione calcolata tramite distanza di Rohlin nei casi
 in cui 
\begin_inset Formula $J$
\end_inset

 può essere arbitrariamente piccolo (In alto) La scala bilogaritmica è dovuta
 all'enorme range di 
\begin_inset Formula $\beta$
\end_inset

 necessario per misurare il corretto andamento -- l'andamento è perfettamente
 rettilineo nei 3 casi, come evidenziato dalle curve tratteggiate e dalla
 seconda figura (In basso) dettaglio della correlazione variando 
\begin_inset Formula $\beta$
\end_inset

 linearmente in un intervallo più piccolo, con 
\begin_inset Formula $J$
\end_inset

 estratto semigaussianamente (positivo)
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
In conclusione, la distanza di Rohlin ha permesso di definire nel caso monodimen
sionale una distanza efficace di correlazione che generalizza il caso noto
 e permette la definizione anche per catene di spin disordinati.
 Il comportamento al variare delle distribuzioni di 
\begin_inset Formula $J$
\end_inset

 è molto vario ed interessante, con fenomeni che non compaiono nel semplice
 caso ferromagnetico.
\end_layout

\begin_layout Section
Reticoli bidimensionali
\end_layout

\begin_layout Standard
Proviamo a generalizzare la distanza di correlazione definita tramite distanza
 di Rohlin anche per reticoli bidimensionali.
 
\end_layout

\begin_layout Standard
Il partizionamento un reticolo di spin discreti non presenta alcun problema
 con i metodi introdotti a partire da pagina 
\begin_inset CommandInset ref
LatexCommand pageref
reference "sec:Partizionamento-generico"

\end_inset

, la struttura dei vicini è particolarmente semplice, come negli esempi
 mostrati si tratta solo di un confronto di ogni sito con il suo vicino
 up e il vicino left.
\end_layout

\begin_layout Standard
La generazione delle configurazioni è stata fatta con il metodo Metropolis,
 aggiornando alternativamente i siti dispari e pari, accettando sito per
 sito la probabilità di girare uno spin:
\end_layout

\begin_layout Enumerate
individuazione dell'insieme dei siti da aggiornare, 
\begin_inset Formula $A$
\end_inset


\end_layout

\begin_layout Enumerate
per ogni 
\begin_inset Formula $i\in A$
\end_inset

, misura il cambiamento in energia dovuto al flip dello spin
\begin_inset Formula 
\[
\Delta H=2\,\sigma_{i}\left(\sigma_{\text{nnr[i]}}+\sigma_{\text{nnl[i]}}+\sigma_{\text{nnu[i]}}+\sigma_{\text{nnd[i]}}\right)
\]

\end_inset


\end_layout

\begin_layout Enumerate
se 
\begin_inset Formula $\Delta H<0$
\end_inset

, accettiamo il flip
\end_layout

\begin_layout Enumerate
se 
\begin_inset Formula $\Delta H>0$
\end_inset

, la mossa è rifiutata con probabilità 
\begin_inset Formula $e^{-\beta\Delta H}$
\end_inset


\end_layout

\begin_layout Standard
Abbiamo considerato una sequenza come 
\begin_inset Quotes eld
\end_inset

nuova
\begin_inset Quotes erd
\end_inset

 dopo 5 update completi di tutti gli spin dalla configurazione precedente,
 20 in prossimità della transizione di fase (
\begin_inset Formula $0.4<\beta<0.5$
\end_inset

), dopo un controllo che era sufficiente per raggiungere l'equilibrio.
 La prima configurazione è generata 
\begin_inset Quotes eld
\end_inset

a caldo
\begin_inset Quotes erd
\end_inset

, ma con una probabilità di avere spin 
\begin_inset Formula $\pm1$
\end_inset

 quanto più vicina a quella reale della temperatura considerata.
 Sopra la temperatura critica 
\begin_inset Formula $T_{c}$
\end_inset

, gli spin sono scorrelati ed equiprobabili; sotto 
\begin_inset Formula $T_{c}$
\end_inset

 abbiamo fatto dei run preliminari per stabilire la probabilità 
\begin_inset Formula $p(\beta)$
\end_inset

 di avere uno spin discorde dal resto della fase magnetizzata -- la probabilità
 è esponzialmente piccola al crescere di 
\begin_inset Formula $\beta$
\end_inset

.
 Il reticolo è stato riempito con 
\begin_inset Formula $\pm1$
\end_inset

 in base alla probabilità 
\begin_inset Formula $p(\beta)$
\end_inset

 così stimata, poi sono stati fatti 20 update completi per essere sicuri
 di aver termalizzato.
\end_layout

\begin_layout Standard
Le sequenze sono generate all'interno del programma, per minimizzare il
 consumo di memoria; un altro modo è stato quello di generare solo N=10
 reticoli per step e ripetere più volte per ottenere la statistica desiderata.
 Una volta generate le sequenze il partizionamento e il prodotto sono piuttosto
 rapidi -- non abbiamo sfruttato la riduzione, che avrebbe aumentato molto
 i tempi.
 
\end_layout

\begin_layout Standard
La riduzione infatti non avrebbe fornito vantaggi per 
\begin_inset Formula $T>T_{c}$
\end_inset

 all'equilibrio, in quanto vi è un cluster di background, che forma la parte
 dominante magnetizzata, e cluster di pochi siti isolati, distribuiti casualment
e, che non avrebbero avuto sicuramente un atomo corrispondente nella partizione
 di un'altro reticolo.
 Per 
\begin_inset Formula $T<T_{c}$
\end_inset

 gli atomi sul reticolo hanno in media 7 siti, indipendentemente dalla dimension
e del reticolo, sono molto frazionati e la distanza è confrontabile con
 l'entropia delle partizioni in gioco - la riduzione moltiplicherebbe la
 distanza raggiungibile al crescere di L (il lato del reticolo), ma non
 il modo in cui la raggiunge.
 La distanza di correlazione così definita sarebbe invariata dalla riduzione.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ising/reticolo2d-poche.eps
	width 90text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Curve (
\begin_inset Formula $d_{R},\, T,\, L$
\end_inset

) per reticoli con temperatura alta (a sinistra) e a temperatura bassa (a
 destra).
 Sono stati analizzati reticoli con L che variava da 1 a 1000.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
La distanza cresce in modo qualitativamente diverso nelle due fasi, al variare
 della dimensione dei cluster:
\end_layout

\begin_layout Itemize
per 
\begin_inset Formula $T>T_{c},\,\beta<0.44$
\end_inset

, la distanza satura come avviene nel caso monodimensionale: è possibile
 definire una distanza di correlazione tramite il punto di flesso o la distanza
 a metà altezza
\end_layout

\begin_layout Itemize
per 
\begin_inset Formula $T<T_{c},\,\beta>0.44$
\end_inset

, la distanza cresce logaritmicamente senza mai fermarsi (con confidenza
 su un ampio intervallo di dimensioni del reticolo): è impossibile definire
 una distanza di correlazione in modo consistente senza trovare un nuovo,
 più adatto indicatore.
\end_layout

\begin_layout Itemize
vicino alla transizione di fase, 
\begin_inset Formula $0.38<\beta<0.46$
\end_inset

 vi è transizione tra i due regimi, con un allungamento delle curve e una
 concavità non facilmente distinguibile (in scala logaritmica)
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ising/reticolo2d-3andamenti.eps
	width 85text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Confronto dei tre regimi per il reticolo di ising, 
\begin_inset Formula $T>T_{c}$
\end_inset

, 
\begin_inset Formula $T\simeq T_{c}$
\end_inset

, 
\begin_inset Formula $T<T_{c}$
\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Possiamo fornire una stima dell'entropia e delle distanze nei due regimi
 del sistema, con semplici argomenti.
 Per 
\begin_inset Formula $T>T_{c},$
\end_inset

 su una configurazione con 
\begin_inset Formula $M=L^{2}$
\end_inset

 siti, gli atomi della partizione hanno dimensione costante, k siti, indipendent
e dalla dimensione del reticolo; il numero degli atomi è quindi
\begin_inset Formula 
\[
n=\frac{M}{k}
\]

\end_inset

con un'entropia complessiva
\begin_inset Formula 
\begin{align*}
H_{\text{part}} & =\sum_{n}\frac{k}{M}\ln\left(\frac{k}{M}\right)\\
 & =\ln\left(\frac{k}{M}\right)=\ln(n)
\end{align*}

\end_inset

Nel prodotto la dimensione media degli atomi decresce, mentre in numero
 diventano 
\begin_inset Formula $rn$
\end_inset

 con 
\begin_inset Formula $r\geq1,$
\end_inset


\begin_inset Formula 
\[
H_{\text{prod}}=\ln(rn)
\]

\end_inset

e la distanza di Rohlin risulta costante
\begin_inset Formula 
\begin{align*}
d_{R} & =2\, H_{\text{prod}}-2\, H_{\text{part}}\\
 & =2\,\ln(rn)-2\,\ln(n)\\
 & =2\,\ln(r)
\end{align*}

\end_inset

il che spiega perfettamente il plateau delle distanze ridotte a 
\begin_inset Formula $1.4\simeq2\ln(2)$
\end_inset

 nel caso monodimensionale.
\end_layout

\begin_layout Standard
Per 
\begin_inset Formula $T<T_{c}$
\end_inset

, ovvero nella fase magnetizzata, abbiamo un grosso atomo punteggiato di
 singoli spin rovesciati.
 Le 
\begin_inset Quotes eld
\end_inset

isole
\begin_inset Quotes erd
\end_inset

 hanno una densità costante, poiché la loro densità è proporzionale alla
 densità di energia libera del sistema -- abbiamo un numero crescente di
 atomi (di dimensione 1) al crescere del reticolo:
\begin_inset Formula 
\[
n=k\, M\quad k\ll1
\]

\end_inset

con un'entropia corrispondente all'entropia degli n spin isolati e quella
 dell'atomo più grosso 
\begin_inset Formula 
\begin{align*}
H_{\text{part}}(k) & =-n\left(\frac{1}{M}\,\ln\frac{1}{M}\right)-\frac{M(1-k)}{M}\ln\left(\frac{M(1-k)}{M}\right)\\
 & =k\,\ln M-(1-k)\ln(1-k)
\end{align*}

\end_inset

il prodotto ha una densità di difetti maggiore
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
In questa approssimazione la probabilità di avere lo stesso sito appartenente
 ad un cluster isolato in entrambe le partizioni 
\begin_inset Formula $ $
\end_inset

è 
\begin_inset Formula $k^{2}\ll k\ll1$
\end_inset

, per cui il prodotto ha l'unione degli atomi corrispondenti agli spin isolati.
\end_layout

\end_inset

, pari a 
\begin_inset Formula $rk$
\end_inset

 , con 
\begin_inset Formula $r\sim2$
\end_inset


\begin_inset Formula 
\[
H_{\text{prod}}=H_{\text{part}}(rk)
\]

\end_inset

la distanza è
\begin_inset Formula 
\begin{align*}
d_{R} & =2\, H_{\text{prod}}-2\, H_{\text{part}}\\
 & =2H(rk)-2H(k)\\
 & =2\left(k(r-1)\ln(M)+(kr-1)\ln(1-kr)-(k-1)\ln(1-k)\right)\\
 & \simeq2k\left(r-1\right)\left(1+\log(M)\right)+\left(1-r^{2}\right)k^{2}+\mathcal{O}(k^{3})
\end{align*}

\end_inset

che cresce, con un fattore di proporzionalità molto piccolo, come 
\begin_inset Formula $\log(M)$
\end_inset

.
\end_layout

\begin_layout Standard
Avendo spiegato in dettaglio il comportamento della distanza, resta un problema
 aperto la definizione di un funzionale opportuno per estrarre la lunghezza
 di correlazione.
 L'andamento della distanza ricorda l'integrale della funzione di correlazione
 a due punti nel modello di Ising, che ha divergenza logaritmica proporzionale
 al volume (il numero di siti nel nostro caso).
 Si definisce in quel caso la funzione di correlazione connessa, che nella
 fase magnetica ha un contributo nonnullo e elimina il contributo proporzionale
 al volume:
\begin_inset Formula 
\[
g_{c}(i,j)=g(i,j)-\bigl\langle\sigma_{i}\bigr\rangle\bigl\langle\sigma_{j}\bigr\rangle
\]

\end_inset

non è tuttavia chiaro come introdurla utilizzando la distanza di Rohlin.
\end_layout

\begin_layout Standard
\begin_inset Newpage cleardoublepage
\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "bibliografia"
options "elsart-num"

\end_inset


\end_layout

\end_body
\end_document
